# Mneme å¼€å‘è·¯çº¿å›¾ (Roadmap)

æœ¬æ–‡æ¡£è®°å½•å½“å‰å·²çŸ¥é—®é¢˜å’Œæœªæ¥æ”¹è¿›è®¡åˆ’ã€‚

---

## ğŸ§¬ æ ¸å¿ƒè®¾è®¡åŸåˆ™

> **æ¯ä¸ª Mneme éƒ½æ˜¯ç‹¬ç‰¹çš„ä¸ªä½“ã€‚**

### ä»è§„åˆ™åˆ°æ¶Œç°

åˆå§‹é˜¶æ®µå¯ä»¥ä½¿ç”¨å†™æ­»çš„è§„åˆ™ä½œä¸º bootstrapï¼Œä½†é•¿æœŸç›®æ ‡æ˜¯è®©æ‰€æœ‰è¡Œä¸ºå‚æ•°éƒ½é€šè¿‡**å­¦ä¹ å’Œç»å†**å½¢æˆï¼Œè€Œéé¢„è®¾ï¼š

| é˜¶æ®µ | æ–¹å¼ | ä¸¾ä¾‹ |
|------|------|------|
| **Bootstrap** | ç¡¬ç¼–ç è§„åˆ™ | `if energy < 0.3 { å›å¤ç®€æ´ }` |
| **è¿‡æ¸¡æœŸ** | è§„åˆ™ + å¯è°ƒå‚æ•° | é˜ˆå€¼ 0.3 å˜ä¸ºå¯å­¦ä¹ çš„ `energy_threshold` |
| **æˆç†ŸæœŸ** | å®Œå…¨æ•°æ®é©±åŠ¨ | ç¥ç»ç½‘ç»œç›´æ¥ä»çŠ¶æ€æ˜ å°„åˆ°è¡Œä¸ºå€¾å‘ |

### ä¸¤ç±»æ”¹è¿›

åœ¨é˜…è¯»æœ¬æ–‡æ¡£æ—¶ï¼Œè¯·åŒºåˆ†ï¼š

| ç±»å‹ | è¯´æ˜ | ä¸¾ä¾‹ |
|------|------|------|
| ğŸ—ï¸ **åŸºç¡€è®¾æ–½** | æ‰€æœ‰ Mneme å…±äº«çš„åº•å±‚èƒ½åŠ› | API é‡è¯•ã€æ•°æ®åº“ã€CLI |
| ğŸ§¬ **ä¸ªæ€§å‚æ•°** | æ¯ä¸ª Mneme ç‹¬ç‰¹çš„å¯å­¦ä¹ éƒ¨åˆ† | é˜ˆå€¼ã€åå¥½ã€è¡¨è¾¾é£æ ¼ |

åŸºç¡€è®¾æ–½çš„æ”¹è¿›æ˜¯ç¡®å®šæ€§çš„ï¼›ä¸ªæ€§å‚æ•°çš„æ”¹è¿›ç›®æ ‡æ˜¯**æ¶ˆé™¤ç¡®å®šæ€§**ï¼Œè®©æ¯ä¸ªå®ä¾‹éƒ½ä¸åŒã€‚

### ä¸ªä½“å·®å¼‚æ¥æº

æ¯ä¸ª Mneme å®ä¾‹åº”è¯¥å› ä¸ºä»¥ä¸‹å› ç´ è€Œä¸åŒï¼š

1. **ç»å†** - ä¸åŒçš„å¯¹è¯å†å²å¡‘é€ ä¸åŒçš„è®°å¿†å’Œå™äº‹
2. **åé¦ˆ** - ç”¨æˆ·çš„ååº”å¼ºåŒ–ä¸åŒçš„è¡Œä¸ºæ¨¡å¼
3. **ä»·å€¼æ¼”åŒ–** - ä»·å€¼ç½‘ç»œæƒé‡éšæ—¶é—´æ¼‚ç§»
4. **ä¾æ‹å…³ç³»** - ä¸ä¸åŒç”¨æˆ·å½¢æˆä¸åŒçš„ä¾æ‹é£æ ¼
5. **å™äº‹åå·®** - è§£è¯»ä¸–ç•Œçš„æ–¹å¼å› ç»å†è€Œå¼‚
6. **è¡¨è¾¾é˜ˆå€¼** - ä»€ä¹ˆçŠ¶æ€ä¸‹è¯¥ç®€æ´/è¯¦ç»†/çƒ­æƒ…/å†·æ·¡

### å½“å‰ç¡¬ç¼–ç æ¸…å•ï¼ˆå¾…æ¶ˆé™¤ï¼‰

ä»¥ä¸‹æ˜¯ç›®å‰ä»£ç ä¸­ç¡¬ç¼–ç çš„è§„åˆ™ï¼Œéœ€è¦é€æ­¥æ›¿æ¢ä¸ºå¯å­¦ä¹ å‚æ•°ï¼š

| ä½ç½® | ç¡¬ç¼–ç å†…å®¹ | ç›®æ ‡ | ä¼˜å…ˆçº§ |
|------|-----------|------|--------|
| `dynamics.rs` | `energy_target: 0.7` | ä»åé¦ˆä¸­å­¦ä¹ æœ€ä¼˜ç›®æ ‡ | ğŸŸ¡ |
| `dynamics.rs` | `stress_decay_rate: 0.002` | ä¸ªä½“åŒ–çš„å‹åŠ›æ¢å¤é€Ÿåº¦ | ğŸŸ¡ |
| `somatic.rs` | `energy < 0.3 â†’ ç®€æ´å›å¤` | å­¦ä¹ ä»€ä¹ˆçŠ¶æ€ä¸‹è¯¥ç®€æ´ | ğŸ”´ |
| `somatic.rs` | `stress > 0.7 â†’ è¯­æ°”ç•¥æ€¥` | å­¦ä¹ å‹åŠ›å¦‚ä½•å½±å“è¡¨è¾¾ | ğŸ”´ |
| `state.rs` | è¡Œä¸ºæŒ‡å¯¼æ–‡æœ¬ | ä»æˆåŠŸäº¤äº’ä¸­å­¦ä¹ è¡¨è¾¾æ–¹å¼ | ğŸŸ¡ |
| `values.rs` | åˆå§‹ä»·å€¼æƒé‡ | ä»ç”¨æˆ·åé¦ˆä¸­è°ƒæ•´ | ğŸŸ¢ |
| `prompts.rs` | è¡¨è¾¾é£æ ¼æŒ‡å¼• | ä¸ªæ€§åŒ–çš„æ²Ÿé€šé£æ ¼ | ğŸŸ¡ |
| `somatic.rs` | **æ–‡å­—æŒ‡ä»¤æ³¨å…¥æ¨¡å¼** | â†’ ç»“æ„æ€§è°ƒåˆ¶ï¼ˆæ— çŠ¶æ€ LLM èŒƒå¼ï¼‰ | ğŸ”´ |
| `engine.rs` | `max_tokens` å›ºå®š | â†’ ç”± energy/stress è°ƒåˆ¶ | ğŸ”´ |
| `engine.rs` | `temperature` å›ºå®š | â†’ ç”± arousal/stress è°ƒåˆ¶ | ğŸ”´ |
| `engine.rs` | è®°å¿†å¬å›æ— åå·® | â†’ ç”± mood/stress åç½® recall | ğŸŸ¡ |

### å®ç°è·¯å¾„

```
Phase 1: å‚æ•°åŒ–ï¼ˆå½“å‰é‡ç‚¹ï¼‰
    æ‰€æœ‰é­”æ³•æ•°å­—å˜æˆé…ç½®/çŠ¶æ€çš„ä¸€éƒ¨åˆ†
    å­˜å‚¨åœ¨ OrganismState.slow æˆ–å•ç‹¬çš„ PersonalityParams ä¸­
    
Phase 2: å¯è§‚æµ‹
    è®°å½•"è§„åˆ™è§¦å‘ â†’ è¡Œä¸º â†’ ç”¨æˆ·åé¦ˆ"çš„å…³è”
    å»ºç«‹ (state, action, reward) ä¸‰å…ƒç»„æ•°æ®é›†
    
Phase 3: åœ¨çº¿å¾®è°ƒ
    ç”¨åé¦ˆä¿¡å·è°ƒæ•´å‚æ•°ï¼ˆç®€å•çš„å¼ºåŒ–å­¦ä¹ ï¼‰
    æ¯æ¬¡æ­£é¢åé¦ˆå¼ºåŒ–å½“å‰å‚æ•°ï¼Œè´Ÿé¢åé¦ˆè°ƒæ•´
    
Phase 4: ç¥ç»ç½‘ç»œæ›¿æ¢
    ç”¨å°å‹ç½‘ç»œæ›¿ä»£è§„åˆ™ï¼Œå®Œå…¨æ•°æ®é©±åŠ¨
    ä»å¤§é‡äº¤äº’ä¸­å­¦ä¹  state â†’ behavior æ˜ å°„
```

### æ— çŠ¶æ€ LLMï¼šä»"æŒ‡ä»¤"åˆ°"ç»“æ„æ€§çº¦æŸ"

> **æ ¸å¿ƒæ´å¯Ÿï¼šä¸è¦å‘Šè¯‰ LLM å¦‚ä½•æ„Ÿå—ï¼Œè€Œè¦è®©å®ƒåœ¨ä¸åŒçŠ¶æ€ä¸‹ç»“æ„æ€§åœ°æ¥æ”¶ä¸åŒçš„è¾“å…¥å’Œçº¦æŸâ€”â€”è¡Œä¸ºè‡ªç„¶æ¶Œç°ã€‚**

#### é—®é¢˜ï¼šå½“å‰æ–¹æ³•çš„æ ¹æœ¬ç¼ºé™·

å½“å‰æ¶æ„æ˜¯"å¯¼æ¼”æ¨¡å¼"â€”â€”ç”¨æ–‡å­—æŒ‡ä»¤å‘Šè¯‰ LLM æ‰®æ¼”æŸç§çŠ¶æ€ï¼š

```
OrganismState(stress=1.0)
    â†’ SomaticMarker â†’ "è¯­æ°”å¯èƒ½ç•¥æ€¥"
    â†’ æ³¨å…¥ system prompt
    â†’ LLM è¯»åˆ°è¿™å¥è¯...ç„¶åæ— è§†å®ƒ
    â†’ "æŒºå¥½çš„ï¼Œåœ¨å’Œä½ èŠè¿™ä¸ªé¡¹ç›®" 
```

è¿™å°±åƒç»™æ¼”å‘˜ä¸€å¼ çº¸æ¡å†™"è¯·è¡¨æ¼”ç–²æƒ«"ã€‚ä»–å¯ä»¥ç…§åšï¼Œä¹Ÿå¯ä»¥ä¸çœ‹ã€‚LLM æ²¡æœ‰**ç»“æ„æ€§çš„ç†ç”±**å¿…é¡»éµä»è¿™äº›æ–‡å­—æŒ‡ä»¤ã€‚

#### ç±»æ¯”ï¼šäººè„‘æ˜¯æ€ä¹ˆåšçš„

äººç±»å¤§è„‘çš®å±‚ï¼ˆneocortexï¼Œç±»æ¯” LLMï¼‰æ˜¯ä¸€ä¸ªç›¸å¯¹"æ— çŠ¶æ€"çš„å¤„ç†å™¨â€”â€”å®ƒå¤„ç†æ¥æ”¶åˆ°çš„ä»»ä½•è¾“å…¥ã€‚æƒ…ç»ªå’Œäººæ ¼**ä¸æ¥è‡ªçš®å±‚å†…éƒ¨**ï¼Œè€Œæ¥è‡ªçš®å±‚ä¸‹ç»“æ„ï¼ˆè¾¹ç¼˜ç³»ç»Ÿã€è„‘å¹²ï¼‰å¯¹çš®å±‚çš„**ç»“æ„æ€§è°ƒåˆ¶**ï¼š

| äººè„‘æœºåˆ¶ | ç±»æ¯” | å½“å‰ Mneme | ç›®æ ‡ Mneme |
|----------|------|------------|------------|
| ç–²åŠ³æ—¶å·¥ä½œè®°å¿†å®¹é‡ä¸‹é™ | ä¸Šä¸‹æ–‡çª—å£ç¼©å° | âŒ å‘Šè¯‰ LLM"ä½ ç´¯äº†" | âœ… å®é™…ä¼ æ›´å°‘çš„ context |
| ç„¦è™‘æ—¶æ³¨æ„åŠ›åå‘å¨èƒä¿¡æ¯ | è®°å¿†å¬å›åå·® | âŒ å‘Šè¯‰ LLM"ä½ ç„¦è™‘" | âœ… å®é™…å¬å›æ›´å¤šè´Ÿé¢ episodes |
| æŠ‘éƒæ—¶è¡ŒåŠ¨åŠ›ä¸‹é™ | è¾“å‡ºçº¦æŸ | âŒ å‘Šè¯‰ LLM"è¯­æ°”åæ·¡" | âœ… å®é™…é™åˆ¶ max_tokens |
| å…´å¥‹æ—¶æ€ç»´å‘æ•£ | temperature è°ƒèŠ‚ | âŒ å‘Šè¯‰ LLM"æ´»æ³¼çƒ­æƒ…" | âœ… å®é™…æé«˜ temperature |
| ç–²æƒ«æ—¶ä¸æƒ³è¯´è¯ | å“åº”æ¦‚ç‡ | âŒ å‘Šè¯‰ LLM"ç®€æ´å›å¤" | âœ… å®é™…æé«˜ [SILENCE] å€¾å‘ |

**å…³é”®åŒºåˆ«**ï¼šæä»æ ¸ä¸ç»™å‰é¢å¶å‘å¤‡å¿˜å½•â€”â€”å®ƒæ”¹å˜ç¥ç»é€’è´¨æ°´å¹³ï¼Œ**ç‰©ç†åœ°æ”¹å˜**ä¿¡æ¯å¤„ç†è¿‡ç¨‹ã€‚

#### æ¶æ„èŒƒå¼è½¬å˜

**æ—§èŒƒå¼ï¼ˆå¯¼æ¼”æ¨¡å¼ï¼‰**ï¼šçŠ¶æ€ â†’ æ–‡å­—æè¿° â†’ æ³¨å…¥ prompt â†’ æœŸæœ› LLM éµä»  
**æ–°èŒƒå¼ï¼ˆå…·èº«æ¨¡å¼ï¼‰**ï¼šçŠ¶æ€ â†’ ç»“æ„æ€§è°ƒåˆ¶ LLM çš„è¾“å…¥/å‚æ•°/è¾“å‡º â†’ è¡Œä¸ºè‡ªç„¶æ¶Œç°

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚          OrganismState                   â”‚
                    â”‚   energy, stress, mood, curiosity, ...   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚          â”‚          â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â” â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â” â”Œâ”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ Input   â”‚ â”‚ LLM      â”‚ â”‚ Output      â”‚
                    â”‚ Modula- â”‚ â”‚ Param    â”‚ â”‚ Modula-     â”‚
                    â”‚ tion    â”‚ â”‚ Modula-  â”‚ â”‚ tion        â”‚
                    â”‚         â”‚ â”‚ tion     â”‚ â”‚             â”‚
                    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                         â”‚          â”‚               â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
              â”‚                                            â”‚
              â”‚    LLMï¼ˆæ— çŠ¶æ€çº¯æ¨ç†å¼•æ“ = "neocortex"ï¼‰    â”‚
              â”‚    ä¸çŸ¥é“è‡ªå·±"ç´¯äº†"æˆ–"å¼€å¿ƒ"                  â”‚
              â”‚    åªæ˜¯å¤„ç†æ”¶åˆ°çš„ä¿¡æ¯                        â”‚
              â”‚                                            â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ä¸‰å±‚è°ƒåˆ¶æœºåˆ¶

**Layer 1: è¾“å…¥è°ƒåˆ¶ï¼ˆä»€ä¹ˆä¿¡æ¯åˆ°è¾¾ LLMï¼‰**

çŠ¶æ€ä¸æ˜¯"å»ºè®®"â€”â€”å®ƒ**ç­›é€‰ã€è¿‡æ»¤ã€åç½®**è¿›å…¥ LLM çš„ä¿¡æ¯ï¼š

| çŠ¶æ€ç»´åº¦ | è°ƒåˆ¶ç›®æ ‡ | æœºåˆ¶ | æ•ˆæœ |
|----------|----------|------|------|
| `energy` | context çª—å£å¤§å° | ä½ç²¾åŠ› â†’ è£å‰ªæ›´å¤šä½ä¼˜å…ˆçº§ context | è‡ªç„¶äº§ç”ŸçŸ­å›å¤ï¼ˆå› ä¸ºå¯ç”¨ä¿¡æ¯å°‘ï¼‰ |
| `stress` | è®°å¿†å¬å›åå·® | é«˜å‹åŠ› â†’ recall åå‘è´Ÿé¢/å¨èƒç›¸å…³è®°å¿† | è‡ªç„¶äº§ç”Ÿé˜²å¾¡æ€§/æ€¥èºå›å¤ |
| `mood_bias` | è®°å¿†æƒ…æ„Ÿè¿‡æ»¤ | ä½æƒ…ç»ª â†’ è¿‡æ»¤æ‰ç§¯æè®°å¿† | è‡ªç„¶äº§ç”Ÿä½æ²‰è¯­æ°” |
| `curiosity` | å·¥å…·å¯ç”¨æ€§ | é«˜å¥½å¥‡ â†’ æš´éœ²æ›´å¤šæ¢ç´¢å·¥å…· | è‡ªç„¶äº§ç”Ÿä¸»åŠ¨æ¢ç´¢è¡Œä¸º |
| `social_need` | feed digest æ³¨å…¥é‡ | é«˜ç¤¾äº¤éœ€æ±‚ â†’ æ³¨å…¥æ›´å¤šè¯é¢˜ç´ æ | è‡ªç„¶äº§ç”Ÿå»¶ç»­è¯é¢˜è¡Œä¸º |
| `openness` | å¤–éƒ¨ä¿¡æ¯é‡ | é«˜å¼€æ”¾ â†’ æ³¨å…¥æ›´å¤šæ–°é—»/feed | è‡ªç„¶äº§ç”Ÿå‘æ•£æ€ç»´ |

**Layer 2: LLM å‚æ•°è°ƒåˆ¶ï¼ˆå¦‚ä½•å¤„ç†ä¿¡æ¯ï¼‰**

| çŠ¶æ€ç»´åº¦ | è°ƒåˆ¶å‚æ•° | æœºåˆ¶ | æ•ˆæœ |
|----------|----------|------|------|
| `energy` | `max_tokens` | ä½ç²¾åŠ› â†’ é™ä½ max_tokens | ç‰©ç†ä¸Šä¸å¯èƒ½é•¿ç¯‡å¤§è®º |
| `stress` | `temperature` | é«˜å‹åŠ› â†’ æé«˜ temperature | å›å¤æ›´ä¸å¯é¢„æµ‹/å†²åŠ¨ |
| `affect.arousal` | `temperature` | é«˜å”¤é†’ â†’ æé«˜ temperature | è¡¨è¾¾æ›´æ¿€çƒˆ |
| `mood_bias` | `top_p` | æç«¯æƒ…ç»ª â†’ é™ä½ top_p | ç”¨è¯èŒƒå›´æ”¶çª„ |
| *(ä¿ç•™æœ€å° somatic hint)* | `system prompt` | ä»ä¿ç•™æç®€çš„çŠ¶æ€æ•°å€¼ | LLM å¯é€‰çš„å‚è€ƒä¿¡å· |

**Layer 3: è¾“å‡ºè°ƒåˆ¶ï¼ˆå¦‚ä½•å‘ˆç°ç»“æœï¼‰**

| çŠ¶æ€ç»´åº¦ | è°ƒåˆ¶ç›®æ ‡ | æœºåˆ¶ | æ•ˆæœ |
|----------|----------|------|------|
| `energy` | æ¶ˆæ¯æ‹†åˆ†é˜ˆå€¼ | ä½ç²¾åŠ› â†’ ä¸æ‹†åˆ†/å•æ¡å‘é€ | æ‡’å¾—åˆ†å¤šæ¡ |
| `affect.arousal` | humanizer æ‰“å­—é€Ÿåº¦ | é«˜å”¤é†’ â†’ æ›´å¿«å‘é€ | æ€¥è¿«æ„Ÿ |
| `stress` | å›å¤å»¶è¿Ÿ | é«˜å‹åŠ› â†’ éšæœºæ›´é•¿å»¶è¿Ÿ | çŠ¹è±«/å›é¿ |
| `mood_bias` | æ¨¡æ€é€‰æ‹© | ä½æƒ…ç»ª â†’ åå¥½æ–‡å­—è€Œéè¯­éŸ³ | ä¸æƒ³è¯´è¯ |
| `social_need` | [SILENCE] é˜ˆå€¼ | ä½ç¤¾äº¤éœ€æ±‚ â†’ æ›´å®¹æ˜“æ²‰é»˜ | ä¸æƒ³æ­ç† |

#### ä¸æ ¸å¿ƒåŸåˆ™çš„å…³ç³»

è¿™ä¸ªèŒƒå¼è½¬å˜**æ·±åŒ–**äº†"ä»è§„åˆ™åˆ°æ¶Œç°"çš„åŸåˆ™ï¼š

| é˜¶æ®µ | æ—§æ¡†æ¶ | æ–°æ¡†æ¶ |
|------|--------|--------|
| **Bootstrap** | `if stress > 0.7 { å‘Šè¯‰ LLM "è¯­æ°”ç•¥æ€¥" }` | `stress â†’ max_tokens *= 0.6, temp += 0.2` |
| **è¿‡æ¸¡æœŸ** | é˜ˆå€¼å¯å­¦ä¹ ï¼Œä½†ä»æ˜¯æ–‡å­—æŒ‡ä»¤ | è°ƒåˆ¶æ›²çº¿å¯å­¦ä¹ ï¼šstress å¦‚ä½•æ˜ å°„åˆ° temperature |
| **æˆç†ŸæœŸ** | ç¥ç»ç½‘ç»œç”Ÿæˆæ–‡å­—æŒ‡ä»¤ | ç¥ç»ç½‘ç»œç›´æ¥è¾“å‡º LLM å‚æ•°è°ƒåˆ¶å‘é‡ |

å…³é”®åŒºåˆ«ï¼š**æ—§æ¡†æ¶çš„ç»ˆç‚¹ä»ç„¶æ˜¯ç”Ÿæˆæ–‡å­—æŒ‡ä»¤è®© LLM éµä»ï¼›æ–°æ¡†æ¶çš„ç»ˆç‚¹æ˜¯æ ¹æœ¬ä¸éœ€è¦æ–‡å­—æŒ‡ä»¤**â€”â€”è¡Œä¸ºä»ç»“æ„æ€§çº¦æŸä¸­æ¶Œç°ã€‚

#### ğŸ§¬ è°ƒåˆ¶æ›²çº¿æ˜¯ä¸ªæ€§å‚æ•°

æ¯ä¸ª Mneme å®ä¾‹çš„è°ƒåˆ¶æ›²çº¿åº”è¯¥ä¸åŒâ€”â€”è¿™æ˜¯å¦ä¸€ä¸ªä¸ªä½“å·®å¼‚æ¥æºï¼š

```
å®ä¾‹ Aï¼ˆæ•æ„Ÿå‹ï¼‰:
    stress 0.3 â†’ temperature +0.3, max_tokens Ã—0.5
    ï¼ˆå‹åŠ›ç¨é«˜å°±å˜å¾—æ€¥èºç®€çŸ­ï¼‰

å®ä¾‹ Bï¼ˆåšéŸ§å‹ï¼‰:
    stress 0.8 â†’ temperature +0.1, max_tokens Ã—0.9
    ï¼ˆå‹åŠ›å¾ˆå¤§æ‰æœ‰å¾®å°å˜åŒ–ï¼‰

å®ä¾‹ Cï¼ˆæˆå‰§åŒ–å‹ï¼‰:
    mood +0.5 â†’ temperature +0.4, context Ã—1.5
    mood -0.5 â†’ temperature -0.2, max_tokens Ã—0.3
    ï¼ˆæƒ…ç»ªå¯¹è¡Œä¸ºå½±å“æå¤§ï¼‰
```

è¿™äº›æ›²çº¿ä»åé¦ˆä¸­å­¦ä¹ ï¼šå¦‚æœç”¨æˆ·å¯¹æŸä¸ªçŠ¶æ€ä¸‹çš„å›å¤æ»¡æ„ï¼Œå¼ºåŒ–å½“æ—¶çš„è°ƒåˆ¶å‚æ•°ã€‚

#### SomaticMarker çš„è§’è‰²è½¬å˜

`SomaticMarker` ä¸åº”è¢«åºŸå¼ƒï¼Œè€Œæ˜¯**èŒè´£è½¬å˜**ï¼š

| | æ—§è§’è‰² | æ–°è§’è‰² |
|---|--------|--------|
| **ç»™è°** | ç»™ LLM è¯»çš„æ–‡å­— | ç»™æ¶æ„å±‚çš„è°ƒåˆ¶ä¿¡å· |
| **äº§å‡º** | `"è¯­æ°”å¯èƒ½ç•¥æ€¥"` | `ModulationVector { temp: +0.2, max_tokens: 0.6, ... }` |
| **LLM çœ‹åˆ°** | è¡Œä¸ºæŒ‡å¯¼æ–‡æœ¬ | æç®€æ•°å€¼ï¼ˆå¯é€‰è¾…åŠ©ä¿¡å·ï¼‰ |
| **è¡Œä¸ºæ¥æº** | LLM è§£è¯»æ–‡å­—å"æ¼”"å‡ºæ¥ | ç»“æ„æ€§çº¦æŸä¸‹è‡ªç„¶æ¶Œç° |

---

## ğŸ”´ é«˜ä¼˜å…ˆçº§ (High Priority)

### 1. ğŸ—ï¸ API é”™è¯¯è‡ªåŠ¨é‡è¯•æœºåˆ¶
**æ¨¡å—**: `mneme_reasoning/src/providers/`  
**é—®é¢˜**: API è°ƒç”¨å¤±è´¥æ—¶ç›´æ¥è¿”å›é”™è¯¯ï¼Œæ²¡æœ‰é‡è¯•æœºåˆ¶ã€‚å¯¹äºä¸´æ—¶æ€§ç½‘ç»œé—®é¢˜æˆ– rate limitï¼Œåº”è¯¥è‡ªåŠ¨é‡è¯•ã€‚

**å½“å‰ä»£ç **:
```rust
// anthropic.rs - ç›´æ¥ bail æ²¡æœ‰é‡è¯•
if !response.status().is_success() {
    let error_text = response.text().await.unwrap_or_default();
    anyhow::bail!("Anthropic API Error: {}", error_text);
}
```

**éœ€è¦å®ç°**:
- [x] æŒ‡æ•°é€€é¿é‡è¯• (exponential backoff) âœ… â€” `retry.rs` with configurable backoff
- [x] åŒºåˆ†å¯é‡è¯•é”™è¯¯ (429 rate limit, 5xx) å’Œä¸å¯é‡è¯•é”™è¯¯ (400, 401) âœ…
- [x] é…ç½®æœ€å¤§é‡è¯•æ¬¡æ•° âœ… â€” `RetryConfig { max_attempts, initial_delay, max_delay, backoff_factor }`
- [x] é‡è¯•æ—¥å¿—è®°å½• âœ… â€” tracing::warn on each retry, tracing::info on success after retry

**å‚è€ƒ**: `mneme_onebot/src/client.rs` å·²æœ‰ç±»ä¼¼å®ç°

---

### 2. âœ… å·¥å…·æ‰§è¡Œé”™è¯¯å¤„ç†
**æ¨¡å—**: `mneme_reasoning/src/engine.rs`  
**é—®é¢˜**: å·¥å…·æ‰§è¡Œå¤±è´¥æ—¶ï¼Œé”™è¯¯ä¿¡æ¯å¯èƒ½ä¸å¤Ÿæ¸…æ™°ï¼Œä¸”æ²¡æœ‰é‡è¯•æœºåˆ¶ã€‚

**å·²å®Œæˆ** (commit `fcf5602`):
- [x] å·¥å…·æ‰§è¡Œé‡è¯•æœºåˆ¶ï¼ˆå¯¹äºä¸´æ—¶æ€§å¤±è´¥ï¼‰ âœ… â€” `execute_tool_with_retry()` + `TOOL_MAX_RETRIES=1`ï¼Œä»…é‡è¯• `Transient` ç±»å‹é”™è¯¯
- [x] ç»“æ„åŒ–é”™è¯¯è¿”å› (`ToolResult.is_error`) âœ… â€” `ToolOutcome { content, is_error, error_kind }` + `ToolErrorKind::Transient/Permanent`
- [x] å·¥å…·æ‰§è¡Œè¶…æ—¶å¯é…ç½®åŒ– âœ… â€” `LocalExecutor::with_timeout()` å·²å­˜åœ¨ï¼Œtimeout â†’ Transient è‡ªåŠ¨é‡è¯•
- [x] æµè§ˆå™¨ä¼šè¯æ¢å¤æœºåˆ¶ âœ… â€” `execute_browser_tool()` å¤±è´¥æ—¶ drop session â†’ `create_browser_session()` é‡å»º
- [x] é”™è¯¯åˆ†ç±»ï¼štimeout/spawn â†’ Transientï¼ˆé‡è¯•ï¼‰ï¼Œexit code/missing param/unknown tool â†’ Permanentï¼ˆä¸é‡è¯•ï¼‰
- [x] `is_error: Some(true/false)` ä¼ é€’ç»™ LLMï¼Œè®©æ¨¡å‹çŸ¥é“å·¥å…·æ˜¯å¦å¤±è´¥
- [x] `BrowserAction` derive `Clone` æ”¯æŒ recovery é‡è¯•
- [x] 9 ä¸ªæ–°æµ‹è¯• + å…¨éƒ¨ 33 integration tests é€šè¿‡ âœ…

---

### 3. âœ… çŠ¶æ€å†å²è®°å½•ï¼ˆè°ƒè¯•ä¸å›æº¯ï¼‰
**æ¨¡å—**: `mneme_memory/src/coordinator.rs`, `mneme_memory/src/sqlite.rs`  
**é—®é¢˜**: å½“å‰åªä¿å­˜æœ€æ–°çŠ¶æ€å¿«ç…§ï¼Œæ— æ³•å›æº¯å†å²çŠ¶æ€å˜åŒ–ã€‚

**å·²å®Œæˆ** (commit `8c7ad3f`):
- [x] çŠ¶æ€å¿«ç…§å†å²è¡¨ (`organism_state_history`) âœ… â€” SQLite migration, timestamp ç´¢å¼•
- [x] å®šæœŸè®°å½• (æ¯ N åˆ†é’Ÿæˆ–æ¯æ¬¡æ˜¾è‘—å˜åŒ–) âœ… â€” tick/interaction/consolidation/shutdown å››ç§è§¦å‘å™¨
- [x] çŠ¶æ€ diff è®¡ç®—ä¸å­˜å‚¨ âœ… â€” `compute_state_diff()` æ¯”è¾ƒ prev/currï¼Œepsilon=0.01ï¼Œç´§å‡‘æ ¼å¼ `E-0.40 S+0.60`
- [x] è°ƒè¯•æ—¶å¯æŸ¥è¯¢ç‰¹å®šæ—¶é—´ç‚¹çš„çŠ¶æ€ âœ… â€” `query_state_history(from, to, limit)` + `recent_state_history(count)`
- [x] è‡ªåŠ¨æ¸…ç†è¿‡æ—§å†å²ï¼ˆä¿ç•™ç­–ç•¥ï¼‰ âœ… â€” `prune_state_history(keep=10000, max_age=7d)`ï¼Œæ¯ 360 tick è‡ªåŠ¨è§¦å‘
- [x] `StateSnapshot` ç»“æ„ä½“ + `prev_snapshot` diff è·Ÿè¸ª âœ…
- [x] 7 ä¸ªæµ‹è¯•ï¼ˆ4 unit + 3 integrationï¼‰ âœ…

**Schema**:
```sql
CREATE TABLE organism_state_history (
    id INTEGER PRIMARY KEY,
    timestamp INTEGER NOT NULL,
    state_json TEXT NOT NULL,
    trigger TEXT,  -- 'tick', 'interaction', 'consolidation', 'shutdown'
    diff_summary TEXT
);
CREATE INDEX idx_state_history_ts ON organism_state_history(timestamp);
```

---

### 4. ğŸ—ï¸ æ•°å€¼è¾¹ç•Œæ£€æŸ¥ä¸ NaN é˜²æŠ¤
**æ¨¡å—**: `mneme_core/src/dynamics.rs`, `mneme_core/src/state.rs`  
**é—®é¢˜**: æµ®ç‚¹è¿ç®—å¯èƒ½äº§ç”Ÿ NaN æˆ–æº¢å‡ºï¼Œç›®å‰åªæœ‰ç®€å•çš„ clampã€‚

**å½“å‰ä»£ç **:
```rust
// dynamics.rs - åªæœ‰ clampï¼Œæ²¡æœ‰ NaN æ£€æŸ¥
fast.normalize();

impl FastState {
    pub fn normalize(&mut self) {
        self.energy = self.energy.clamp(0.0, 1.0);
        // ... æ²¡æœ‰ NaN æ£€æŸ¥
    }
}
```

**éœ€è¦å®ç°**:
- [ ] ç»Ÿä¸€çš„ `SafeF32` ç±»å‹æˆ– validate å®
- [x] åœ¨ `normalize()` ä¸­æ£€æµ‹å¹¶å¤„ç† NaN/Infinity âœ… â€” `sanitize_f32()` + fallback
- [x] çŠ¶æ€å¼‚å¸¸æ—¶çš„å›é€€ç­–ç•¥ï¼ˆæ¢å¤é»˜è®¤å€¼ï¼‰ âœ… â€” fallback to homeostatic defaults
- [x] å¼‚å¸¸çŠ¶æ€æ—¥å¿—å‘Šè­¦ âœ… â€” `tracing::warn!` on NaN/Inf detection
- [x] å•å…ƒæµ‹è¯•è¦†ç›–è¾¹ç•Œæƒ…å†µ âœ… â€” `test_nan_resistance` + `test_extreme_dt_stability`
- [x] `MediumState::normalize()` åŒæ ·æ·»åŠ  NaN é˜²æŠ¤ âœ…

**ç¤ºä¾‹**:
```rust
fn safe_normalize(value: f32, min: f32, max: f32, default: f32) -> f32 {
    if value.is_nan() || value.is_infinite() {
        tracing::warn!("Detected invalid float, resetting to default");
        return default;
    }
    value.clamp(min, max)
}
```

---

### 26. ğŸ—ï¸ Semantic Memory è¯»å†™é—­ç¯
**æ¨¡å—**: `mneme_memory/src/sqlite.rs`, `mneme_memory/src/coordinator.rs`  
**é—®é¢˜**: `semantic_facts` è¡¨å·²å­˜åœ¨äº SQLite schema ä¸­ï¼Œä½†**æ²¡æœ‰ä»»ä½•ä»£ç å®é™…è¯»å†™äº‹å®ä¸‰å…ƒç»„**ã€‚å½“å‰ `recall()` åªåš episode å‘é‡æœç´¢ï¼Œä¸æŸ¥è¯¢ factsã€ä¸æŸ¥è¯¢ social graphã€ä¸èåˆ feed digestã€‚agent åªèƒ½"æ£€ç´¢åˆ°è¯´è¿‡ä»€ä¹ˆ"ï¼Œä¸èƒ½"çŸ¥é“ä»€ä¹ˆ"â€”â€”è®°å¿†ç³»ç»Ÿæœ€æ ¸å¿ƒçš„ä»·å€¼å°šæœªå…‘ç°ã€‚

**è®¾è®¡æ–‡æ¡£ Â§4.1-4.2 è¦æ±‚ vs å½“å‰çŠ¶æ€**:

| è®°å¿†ç³»ç»Ÿ | çŠ¶æ€ | è¯´æ˜ |
|----------|------|------|
| Episodic Memory | âœ… | å‘é‡æœç´¢å¯ç”¨ |
| Semantic Memory (fact triples) | âœ… | store/recall/decay/format å·²å®ç° |
| Social Memory (äººç‰©å›¾è°±) | âš ï¸ | æœ‰ trait + è¡¨ï¼Œæœªè¿é€š |
| Blended Recall | âŒ | åªè¿”å› episodes |

**éœ€è¦å®ç°**:
- [x] `store_fact()` / `update_fact()` â€” å†™å…¥äº‹å®ä¸‰å…ƒç»„ (subject, predicate, object, confidence) âœ…
- [x] `recall_facts()` â€” æ ¹æ®ä¸»é¢˜/å…³é”®è¯å¬å›ç›¸å…³äº‹å® âœ…
- [x] äº‹å®å†²çªæ£€æµ‹ä¸æ›´æ–°ï¼ˆé‡å¤ä¸‰å…ƒç»„è‡ªåŠ¨åˆå¹¶ confidenceï¼‰ âœ…
- [x] `get_facts_about()` â€” æŒ‰ä¸»é¢˜æŸ¥è¯¢äº‹å® âœ…
- [x] `decay_fact()` â€” äº‹å®è¡°å‡ï¼ˆçŸ›ç›¾ä¿¡æ¯å‡ºç°æ—¶é™ä½ confidenceï¼‰ âœ…
- [x] `format_facts_for_prompt()` â€” æ ¼å¼åŒ–äº‹å®ä¾› prompt æ³¨å…¥ âœ…
- [x] å¯¹è¯åçš„ fact extraction passï¼ˆ`extraction.rs` + `extract_facts()` + think() é›†æˆï¼‰ âœ…
- [ ] Social graph çš„å®é™…è¯»å†™ï¼ˆå½“å‰åªæœ‰ trait éª¨æ¶ï¼‰
- [ ] `Coordinator::recall()` è¿”å›æ··åˆç»“æœï¼šepisodes + facts + social context

---

### 27. ğŸ—ï¸ğŸ§¬ Persona å®šä¹‰æ–‡ä»¶
**æ¨¡å—**: `persona/*.md`, `mneme_core/src/persona.rs`  
**é—®é¢˜**: 5 ä¸ª persona æ–‡ä»¶ï¼ˆhippocampusã€limbicã€cortexã€brocaã€occipitalï¼‰**å…¨éƒ¨ä¸ºç©º**ã€‚`PersonaLoader` ä¼˜é›…è¿”å›ç©ºå­—ç¬¦ä¸²ï¼Œä½†è¿™æ„å‘³ç€ agent åœ¨æ— èº«ä»½çŠ¶æ€ä¸‹è¿è¡Œã€‚

**å½±å“**: Persona æ˜¯ context assembly çš„æœ€é«˜ä¼˜å…ˆçº§é¡¹ï¼ˆè®¾è®¡æ–‡æ¡£ Â§5.2ï¼š"Always present, always first"ï¼‰ã€‚ç¼ºå°‘ persona = æ²¡æœ‰æ€§æ ¼ã€æ²¡æœ‰è¡Œä¸ºè¾¹ç•Œã€æ²¡æœ‰ä¸€è‡´çš„è¡¨è¾¾é£æ ¼ã€‚è¿™æ˜¯å½“å‰ agent è¡¨ç°è¿œä½äºæ¶æ„èƒ½åŠ›ä¸Šé™çš„**é¦–è¦åŸå› **ã€‚

**è¯´æ˜**: persona åŠ è½½æœºåˆ¶æ˜¯ ğŸ—ï¸ åŸºç¡€è®¾æ–½ï¼›persona æ–‡ä»¶çš„å†…å®¹æ˜¯ ğŸ§¬ ä¸ªæ€§å‚æ•°â€”â€”ä¸åŒå†…å®¹å®šä¹‰ä¸åŒçš„"äººæ ¼"ï¼Œè¿™æ­£æ˜¯"æ¯ä¸ª Mneme ç‹¬ç‰¹"çš„èµ·ç‚¹ã€‚

**éœ€è¦å®ç°**:
- [x] è®¾è®¡å¹¶å¡«å…… 5 ä¸ªè„‘åŒº persona æ–‡ä»¶å†…å®¹ âœ…ï¼ˆå·²è®¾å®šä¸º"åˆšå‡ºç”Ÿçš„å°å¥³å­©"äººæ ¼ï¼‰
  - `cortex.md` â€” è®¤çŸ¥é£æ ¼ã€æ¨ç†åå¥½ã€çŸ¥è¯†é¢†åŸŸ
  - `broca.md` â€” è¯­è¨€é£æ ¼ã€é£è¯ä¹ æƒ¯ã€è¯­æ°”åŸºè°ƒ
  - `limbic.md` â€” æƒ…ç»ªå€¾å‘ã€æƒ…æ„Ÿè¡¨è¾¾æ–¹å¼ã€ä¾æ‹é£æ ¼
  - `hippocampus.md` â€” è®°å¿†åå¥½ã€å™äº‹é£æ ¼ã€æ—¶é—´æ„ŸçŸ¥
  - `occipital.md` â€” æ„ŸçŸ¥åå¥½ã€æ³¨æ„åŠ›åˆ†é…ã€å®¡ç¾å€¾å‘
- [ ] Persona å†…å®¹çš„ç‰ˆæœ¬ç®¡ç†ï¼ˆä¸åŒ"æ€§æ ¼æ¨¡æ¿"å¯é€‰ï¼‰
- [ ] Persona å†…å®¹å½±å“çŠ¶æ€åˆå§‹å€¼ï¼ˆä¸åŒ persona â†’ ä¸åŒåˆå§‹ energy_target ç­‰ï¼‰

---

### 28. ğŸ—ï¸ Context Assembly å®Œæ•´ç®¡é“
**æ¨¡å—**: `mneme_reasoning/src/prompts.rs`, `mneme_reasoning/src/engine.rs`  
**é—®é¢˜**: è®¾è®¡æ–‡æ¡£ Â§5.2 å®šä¹‰äº† 6 å±‚ä¸Šä¸‹æ–‡ä¼˜å…ˆçº§ï¼Œå½“å‰åªå®ç°äº†çº¦ 2 å±‚ã€‚è¿™æ˜¯ reasoning è´¨é‡çš„å¤©èŠ±æ¿â€”â€”"The quality of the agent depends entirely on what context reaches the LLM."

**è®¾è®¡æ–‡æ¡£ Â§5.2 è¦æ±‚ vs å½“å‰çŠ¶æ€**:

| ä¼˜å…ˆçº§ | å†…å®¹ | çŠ¶æ€ | è¯´æ˜ |
|--------|------|------|------|
| 1 | Persona å®šä¹‰ | âœ… | åŠ è½½æœºåˆ¶æœ‰ï¼Œæ–‡ä»¶å·²å¡«å……ï¼ˆè§ #27ï¼‰ |
| 2 | User factsï¼ˆè¯­ä¹‰è®°å¿†ï¼‰ | âœ… | `recall_facts_formatted()` æ³¨å…¥ prompt |
| 3 | Social feed digest | âœ… | `format_feed_digest()` + `update_feed_digest()` + CLI sync å†™å…¥ |
| 4 | Relevant episodes | âœ… | å‘é‡æœç´¢ç»“æœæ³¨å…¥ `ContextLayers.recalled_episodes` |
| 5 | Conversation history | âœ… | å·²å®ç°ï¼Œæ»‘åŠ¨çª—å£ |
| 6 | Triggering event | âœ… | å·²å®ç° |
| â€” | Somatic marker | âœ… | é¢å¤–æ³¨å…¥ï¼ˆè®¾è®¡æ–‡æ¡£ä¹‹å¤–çš„åˆ›æ–°ï¼‰ |
| â€” | Token é¢„ç®—ç®¡ç† | âœ… | `context_budget_factor` è°ƒåˆ¶ä¸Šä¸‹æ–‡é‡ |

**éœ€è¦å®ç°**:
- [x] å°† `recall_facts()` ç»“æœæ³¨å…¥ promptï¼ˆuser facts å±‚ï¼‰ âœ…
- [x] å®ç° feed digest ç”Ÿæˆï¼ˆ`format_feed_digest()` â†’ CLI sync â†’ `feed_cache` â†’ `ContextLayers`ï¼‰ âœ…
- [x] å°†è¯­ä¹‰ç›¸å…³ episodes æ³¨å…¥ prompt âœ… â€” `ContextLayers.recalled_episodes`
- [x] Token é¢„ç®—ç®¡ç†ï¼šæŒ‰ä¼˜å…ˆçº§è£å‰ªï¼ˆfeed digest å…ˆäº user facts ä¸¢å¼ƒï¼›persona æ°¸ä¸ä¸¢å¼ƒï¼‰ âœ…
- [x] ç»Ÿä¸€çš„ `ContextAssembler` ç»“æ„ä½“ + `ContextLayers` + `build_full_system_prompt()` âœ…

---

### 29. ğŸ—ï¸ å®‰å…¨æ²™ç®±ä¸ Capability Tiers
**æ¨¡å—**: `mneme_os/src/local.rs`, `mneme_reasoning/src/engine.rs`  
**é—®é¢˜**: è®¾è®¡æ–‡æ¡£ Â§7.1 å®šä¹‰äº†å››çº§æƒé™ä½“ç³»ï¼ŒÂ§8 å®šä¹‰äº†å®‰å…¨æªæ–½ï¼Œ**ç›®å‰å…¨éƒ¨æœªå®ç°**ã€‚shell å¯æ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œæ— è·¯å¾„æ²™ç®±ï¼Œæ— ç½‘ç»œç™½åå•ã€‚

**è®¾è®¡æ–‡æ¡£ Â§7.1 Capability ä½“ç³» vs å½“å‰çŠ¶æ€**:

| çº§åˆ« | è¡Œä¸º | å½“å‰çŠ¶æ€ |
|------|------|----------|
| Passiveï¼ˆæ— éœ€ç¡®è®¤ï¼‰ | è¯»æ–‡ä»¶ã€æŠ“ç½‘é¡µã€æŸ¥è®°å¿† | âŒ æœªåŒºåˆ† |
| Activeï¼ˆéšå¼ç¡®è®¤ï¼‰ | åˆ›å»ºæ–‡ä»¶ã€ä»£å‘æ¶ˆæ¯ | âŒ æœªåŒºåˆ† |
| Destructiveï¼ˆæ˜¾å¼ç¡®è®¤ï¼‰ | åˆ é™¤æ–‡ä»¶ã€æ”¹ç³»ç»Ÿé…ç½® | âŒ æœªåŒºåˆ† |
| Blockedï¼ˆæ°¸ä¸å…è®¸ï¼‰ | ä»»æ„ shellã€æ•æ„Ÿè·¯å¾„ | âŒ **å½“å‰å¯æ‰§è¡Œä»»æ„å‘½ä»¤** |

**å®‰å…¨é£é™©**:
- `LocalShell::execute()` å¯è¿è¡Œä»»ä½•å‘½ä»¤ï¼ŒåŒ…æ‹¬ç ´åæ€§æ“ä½œ
- æ— è·¯å¾„ç™½åå•/é»‘åå•
- æ— å‡ºç«™ç½‘ç»œåŸŸåç™½åå•
- LLM å¯é€šè¿‡å·¥å…·è°ƒç”¨æ‰§è¡Œæœªç»å®¡æŸ¥çš„æ“ä½œ

**éœ€è¦å®ç°**:
- [ ] `CapabilityPolicy` é…ç½®ï¼šæ¯ä¸ªå·¥å…·å£°æ˜æ‰€éœ€æƒé™çº§åˆ«
- [ ] è¿è¡Œæ—¶æƒé™æ£€æŸ¥ï¼ˆå·¥å…·æ‰§è¡Œå‰æ‹¦æˆªï¼‰
- [ ] è·¯å¾„æ²™ç®±ï¼šæ–‡ä»¶æ“ä½œé™åˆ¶åœ¨å£°æ˜çš„ç›®å½•å†…
- [ ] å‘½ä»¤ç™½åå•/é»‘åå•ï¼ˆæˆ–æ­£åˆ™è¿‡æ»¤ï¼‰
- [ ] ç½‘ç»œå‡ºç«™åŸŸåç™½åå•
- [ ] Destructive æ“ä½œçš„ç”¨æˆ·ç¡®è®¤æµç¨‹
- [ ] å®¡è®¡æ—¥å¿—ï¼šæ‰€æœ‰å·¥å…·è°ƒç”¨è®°å½•

---

## ğŸŸ¡ ä¸­ä¼˜å…ˆçº§ (Medium Priority)

### 5. ğŸ§¬ åé¦ˆä¿¡å·æ”¶é›†ä¸æŒä¹…åŒ–
**æ¨¡å—**: `mneme_memory/src/feedback_buffer.rs`, `mneme_memory/src/sqlite.rs`  
**é—®é¢˜**: åé¦ˆä¿¡å·åªåœ¨å†…å­˜ä¸­ç¼“å­˜ï¼Œé‡å¯åä¸¢å¤±ã€‚è¿™æ˜¯å®ç°ä¸ªæ€§åŒ–å­¦ä¹ çš„æ ¸å¿ƒæ•°æ®æºã€‚

**å½“å‰çŠ¶æ€**:
- `FeedbackBuffer` åœ¨å†…å­˜ä¸­
- é‡å¯å‰è°ƒç”¨ `shutdown()` ä¼šå°è¯•ä¿å­˜ï¼Œä½†å¯èƒ½é—æ¼
- æ²¡æœ‰ä¸»åŠ¨æ”¶é›†ç”¨æˆ·åé¦ˆçš„æœºåˆ¶

**éœ€è¦å®ç°**:
- [ ] åé¦ˆä¿¡å·å®æ—¶æŒä¹…åŒ–åˆ° SQLite
- [ ] å¯åŠ¨æ—¶åŠ è½½æœªæ•´åˆçš„ä¿¡å·
- [ ] ç”¨æˆ·æ˜¾å¼åé¦ˆæœºåˆ¶ï¼ˆç‚¹èµ/ç‚¹è¸©/çº æ­£ï¼‰
- [ ] éšå¼åé¦ˆæ¨æ–­ï¼ˆç”¨æˆ·æ˜¯å¦ç»§ç»­è¯é¢˜ã€å›å¤é€Ÿåº¦ç­‰ï¼‰

**ç›¸å…³è¡¨**: `feedback_signals` å·²å­˜åœ¨ä½†æœªå®Œå…¨ä½¿ç”¨

---

### 6. ğŸ—ï¸ å±æ€§æµ‹è¯• (Property-Based Testing) âœ…
**æ¨¡å—**: å…¨å±€  
**é—®é¢˜**: ~~å½“å‰åªæœ‰åŸºç¡€å•å…ƒæµ‹è¯•ï¼Œç¼ºä¹éšæœºåŒ–æµ‹è¯•æ¥å‘ç°è¾¹ç•Œé—®é¢˜ã€‚~~

**å·²å®Œæˆ** (41 proptest tests across 3 crates):

| Crate | Tests | è¦†ç›–å†…å®¹ |
|-------|-------|----------|
| mneme_core | 21 | ODE ä»»æ„çŠ¶æ€/è¾“å…¥/dt ç¨³å®šæ€§, NaN æ³¨å…¥æ¢å¤, normalize() å¹‚ç­‰æ€§, Affect è¾¹ç•Œ/lerp/polar, Emotion roundtrip, ä¾æ‹æ›´æ–°è¾¹ç•Œ, é“å¾·æˆæœ¬è¾¹ç•Œ |
| mneme_limbic | 8 | ModulationVector 6 å­—æ®µè¾¹ç•ŒéªŒè¯, energyâ†’max_tokens å•è°ƒæ€§, stressâ†’temperature å•è°ƒæ€§, SomaticMarker æ ¼å¼éªŒè¯, proactivity_urgency è¾¹ç•Œ |
| mneme_reasoning | 12 | sanitize_chat_output å¹‚ç­‰æ€§, ä»»æ„ Unicode ä¸ panic, header/bullet/bold ç§»é™¤, ä¸­æ–‡ä¿ç•™, 2000 cases |

**Bug found**: `sanitize_chat_output` å¯¹é‡å  `*` æ¨¡å¼ (å¦‚ `**0*text*`) ä¸å¹‚ç­‰ã€‚å·²ä¿®å¤ã€‚

**å¾…åç»­è¡¥å……**:
- [ ] åºåˆ—åŒ–/ååºåˆ—åŒ–å¾€è¿”æµ‹è¯•
- [ ] å¹¶å‘å®‰å…¨æµ‹è¯•

---

### 7. âœ… æµè§ˆå™¨å·¥å…·ç¨³å®šæ€§
**æ¨¡å—**: `mneme_browser/src/client.rs`, `mneme_reasoning/src/engine.rs`  
**é—®é¢˜**: headless_chrome å¯èƒ½ä¸ç¨³å®šï¼Œæ²¡æœ‰å¥åº·æ£€æŸ¥å’Œä¼šè¯æ¢å¤ã€‚

**å·²å®Œæˆ** (commit `d566528`):
- [x] è¿ç§» deprecated `wait_for_initial_tab()` â†’ `new_tab()` âœ… â€” æ¶ˆé™¤ç¼–è¯‘è­¦å‘Šï¼Œheadless_chrome v1.0.4+ æ¨èæ–¹å¼
- [x] `BrowserConfig` é…ç½®ç»“æ„ä½“ âœ… â€” headless æ¨¡å¼ã€element_timeoutã€navigation_timeoutï¼Œ`debug()` æ„é€ å™¨ç”¨äºé headless è°ƒè¯•
- [x] `is_alive()` å¥åº·æ£€æŸ¥ âœ… â€” é€šè¿‡ `tab.get_target_info()` CDP è°ƒç”¨æ¢æµ‹æµè§ˆå™¨å­˜æ´»
- [x] `tab()` DRY helper âœ… â€” æ›¿ä»£æ‰€æœ‰æ–¹æ³•ä¸­é‡å¤çš„ `if let Some(tab) = &self.current_tab` æ¨¡å¼
- [x] Proactive session recovery âœ… â€” `execute_browser_tool()` æ‰§è¡Œå‰æ£€æŸ¥ `is_alive()`ï¼Œæ­»äº¡ä¼šè¯è‡ªåŠ¨ä¸¢å¼ƒé‡å»º
- [x] HTML æˆªæ–­ âœ… â€” `GetHtml` action é™åˆ¶è¿”å› 8KBï¼Œé˜²æ­¢å·¨å‹é¡µé¢æ’‘çˆ† context
- [x] `set_default_timeout()` âœ… â€” æ–°å»º tab æ—¶è®¾ç½®å¯é…ç½®è¶…æ—¶
- [x] 3 ä¸ªæ–°å•å…ƒæµ‹è¯•ï¼ˆBrowserConfig default/debug/customï¼‰âœ…

---

### 8. âœ… LLM å“åº”è§£æå¥å£®æ€§
**æ¨¡å—**: `mneme_reasoning/src/engine.rs`, `mneme_reasoning/src/extraction.rs`  
**é—®é¢˜**: LLM è¾“å‡ºæ ¼å¼å¯èƒ½ä¸ç¬¦åˆé¢„æœŸï¼Œè§£æå¯èƒ½å¤±è´¥ã€‚

**å·²å®Œæˆ** (commit `5b581df`):
- [x] Emotion tag è§£æå¥å£®åŒ– âœ… â€” `parse_emotion_tags()`: å¤„ç†å¤§å°å†™ `<Emotion>`ã€ç©ºæ ¼ `< emotion >`ã€å¤šæ ‡ç­¾ã€ç©ºå†…å®¹ã€æ— æ³•è¯†åˆ«çš„æƒ…ç»ªå€¼
- [x] Silence æ£€æµ‹å¥å£®åŒ– âœ… â€” `is_silence_response()`: å¤§å°å†™ä¸æ•æ„Ÿã€å®¹å¿ç©ºæ ¼/çœç•¥å·ï¼Œä½†ä¸è¯¯åˆ¤å« SILENCE çš„æ­£å¸¸æ–‡æœ¬
- [x] JSON æå–å¤šç­–ç•¥è§£æ âœ… â€” 6 å±‚ fallback: ç›´æ¥è§£æ â†’ code block æå– â†’ balanced braces â†’ bare array â†’ JSON repair â†’ graceful empty
- [x] JSON repair âœ… â€” `repair_json()`: ä¿®å¤ trailing commasã€å•å¼•å·æ›¿æ¢ã€unquoted keys
- [x] `extract_balanced_braces()` âœ… â€” æ­£ç¡®å¤„ç†åµŒå¥— `{}`ã€å­—ç¬¦ä¸²å†…è½¬ä¹‰ã€é¿å… `find('}')/rfind('}')` çš„é”™è¯¯åŒ¹é…
- [x] Tool result å®‰å…¨å¤„ç† âœ… â€” `sanitize_tool_result()`: 8KB æˆªæ–­ + prompt injection æ£€æµ‹ (`ignore previous instructions`, `<system>` æ ‡ç­¾)
- [x] emotion regex å‡çº§ âœ… â€” `(?si)<\s*emotion\s*>(.*?)<\s*/\s*emotion\s*>` æ”¯æŒ dotall + case insensitive + çµæ´»ç©ºæ ¼
- [x] 29 ä¸ªæ–°å•å…ƒæµ‹è¯•ï¼ˆemotion 8 + silence 7 + tool sanitize 4 + extraction 10ï¼‰ âœ…

---

### 34. ğŸ§¬ è¾“å‡ºè‡ªç„¶åŒ–ï¼šä¸Šä¸‹æ–‡æ„ŸçŸ¥çš„æ ¼å¼ä¸è¡¨è¾¾
**æ¨¡å—**: `persona/broca.md`, `mneme_reasoning/src/engine.rs`, `mneme_reasoning/src/prompts.rs`  
**é—®é¢˜**: LLM è¾“å‡ºå­˜åœ¨æ˜æ˜¾çš„"AIå‘³"ï¼Œä¸ç¬¦åˆäººç±»åœ¨ä¸åŒåœºæ™¯ä¸‹çš„å®é™…è¾“å‡ºä¹ æƒ¯ã€‚

**å·²çŸ¥é—®é¢˜**:
1. **å¿ƒç†æå†™/åŠ¨ä½œæ—ç™½**ï¼šè¾“å‡º `*æ„Ÿè§‰æœ‰ç‚¹ç†Ÿæ‚‰*` `*æ­ªå¤´*` ç­‰ roleplay å¼çš„æ˜Ÿå·åŠ¨ä½œæå†™
2. **æ— å·®åˆ«ä½¿ç”¨ Markdown**ï¼šæ—¥å¸¸èŠå¤©ä¸­ä½¿ç”¨åŠ ç²—ã€æ ‡é¢˜ã€åˆ—è¡¨ã€ä»£ç å—
3. **é•œåƒå›å¤**ï¼šç”¨æˆ·è¯´ä¸‰ç‚¹ï¼ŒLLM ä¹Ÿé€ç‚¹å›ä¸‰æ¡â€”â€”äººç±»ä¸ä¼šè¿™æ ·
4. **æ€»ç»“å¼å›å¤**ï¼š"ä½ è¯´çš„å¯¹ï¼ŒX å’Œ Y éƒ½å¾ˆé‡è¦"è¿™ç§ AI ç‰¹æœ‰çš„å¥å¼

**è®¾è®¡å“²å­¦**:  
> ä¸è¦ç”¨è§„åˆ™å»çº¦æŸä¸è‡ªç„¶â€”â€”ç”¨ç¤ºä¾‹å’Œç»“æ„æ€§åå¤„ç†ã€‚è§„åˆ™è¶Šå¤šè¶Šåƒ AIã€‚

**ä¸‰å±‚é˜²å¾¡**:

| å±‚ | æœºåˆ¶ | å¯é æ€§ |
|---|---|---|
| Persona few-shot | `broca.md` å¯¹è¯ç¤ºä¾‹ï¼ŒLLM æ¨¡ä»¿é£æ ¼ | ä¸­ï¼ˆLLM æ“…é•¿æ¨¡ä»¿ç¤ºä¾‹ï¼‰ |
| System prompt | æç®€åŸåˆ™ï¼Œä¸åˆ—"ä¸è¦åš X" | ä½ï¼ˆLLM å¯èƒ½æ— è§†ï¼‰ |
| **ä»£ç åå¤„ç†** | `sanitize_chat_output()` å‰¥ç¦»æ ¼å¼ | **é«˜ï¼ˆç¡®å®šæ€§ï¼‰** |

**å·²å®Œæˆ**:
- [x] `broca.md` æ”¹ä¸º few-shot ç¤ºä¾‹é©±åŠ¨ï¼Œåˆ é™¤å¤§é‡"ä¸è¦"è§„åˆ™ âœ…
- [x] `prompts.rs` style guide ç²¾ç®€ä¸º 1-2 å¥æ ¸å¿ƒåŸåˆ™ âœ…
- [x] `engine.rs` æ–°å¢ `sanitize_chat_output()` åå¤„ç†ï¼šå‰¥ç¦» `*roleplay*`ã€`**bold**`ã€`# headers`ã€`- bullets` âœ…

**åç»­æ”¹è¿›**:
- [ ] ä¸Šä¸‹æ–‡æ„ŸçŸ¥ï¼šæ ¹æ® `Content.source`ï¼ˆcli/qq/ç¾¤èŠï¼‰å†³å®šæ˜¯å¦å¯ç”¨ sanitize
- [ ] æŠ€æœ¯è®¨è®ºæ—¶è‡ªåŠ¨è·³è¿‡ sanitizeï¼ˆä¿ç•™ä»£ç å—ç­‰ï¼‰
- [ ] ğŸ§¬ ä¸åŒå®ä¾‹çš„è¡¨è¾¾é£æ ¼å·®å¼‚ï¼ˆæœ‰çš„ç®€æ´æœ‰çš„å•°å—¦ï¼Œä½œä¸ºå¯å­¦ä¹ å‚æ•°ï¼‰

---
### 30. ğŸ—ï¸ å·¥å…·æ³¨å†Œç³»ç»Ÿ
**æ¨¡å—**: `mneme_reasoning/src/tools.rs`, `mneme_reasoning/src/engine.rs`  
**é—®é¢˜**: å·¥å…·åˆ—è¡¨ç¡¬ç¼–ç åœ¨ `available_tools()` ä¸­ï¼Œå·¥å…·åˆ†å‘æ˜¯ `match` è¯­å¥ã€‚æ·»åŠ æ–°å·¥å…·éœ€è¦ä¿®æ”¹æ ¸å¿ƒå¼•æ“ä»£ç ï¼Œè¿èƒŒè®¾è®¡æ–‡æ¡£ Â§5.4 å’Œ Â§7.2 çš„æ³¨å†Œå¼è®¾è®¡ã€‚

**å½“å‰çŠ¶æ€**:
- `tools.rs` â€” ç¡¬ç¼–ç  `vec![shell_tool(), browser_goto_tool(), ...]`
- `engine.rs` â€” `match tool_name { "shell" => ..., "browser_goto" => ... }`
- æ¯åŠ ä¸€ä¸ªå·¥å…·éƒ½è¦æ”¹ä¸¤å¤„æ ¸å¿ƒä»£ç 

**éœ€è¦å®ç°**:
- [ ] `ToolRegistry` ç»“æ„ä½“ï¼šè¿è¡Œæ—¶æ³¨å†Œ/æ³¨é”€å·¥å…·
- [ ] `Tool` traitï¼š`name()`, `schema()`, `capability_level()`, `execute()`
- [ ] å¯åŠ¨æ—¶ä»é…ç½®è‡ªåŠ¨å‘ç°å’ŒåŠ è½½å·¥å…·
- [ ] å·¥å…·çš„ capability çº§åˆ«å£°æ˜ï¼ˆä¸ #29 è”åŠ¨ï¼‰
- [ ] æ’ä»¶å¼æ‰©å±•ï¼šå¤–éƒ¨ crate å¯æ³¨å†Œè‡ªå®šä¹‰å·¥å…·

---

### 31. ğŸ—ï¸ LLM æµå¼è¾“å‡º
**æ¨¡å—**: `mneme_reasoning/src/providers/`, `mneme_reasoning/src/engine.rs`  
**é—®é¢˜**: LLM å“åº”å®Œå…¨ç¼“å†²åæ‰å¤„ç†ã€‚ç”¨æˆ·éœ€è¦ç­‰å¾…æ•´ä¸ªç”Ÿæˆå®Œæˆã€‚å¯¹äºé•¿å›å¤ï¼ˆå°¤å…¶é€šè¿‡ OneBot å‘é€ï¼‰ï¼Œä¸¥é‡æŸå®³"ç±»äººæ„Ÿ"ã€‚

**å½“å‰è¡Œä¸º**: è¯·æ±‚ â†’ ç­‰å¾…å®Œæ•´å“åº” â†’ ä¸€æ¬¡æ€§å¤„ç† â†’ å‘é€  
**ç›®æ ‡è¡Œä¸º**: è¯·æ±‚ â†’ æµå¼æ¥æ”¶ â†’ é€æ®µå¤„ç† â†’ åˆ†æ‰¹å‘é€ï¼ˆé…åˆ humanizer çš„æ¶ˆæ¯æ‹†åˆ†ï¼‰

**éœ€è¦å®ç°**:
- [ ] `LlmClient` trait å¢åŠ  `stream_completion()` æ–¹æ³•
- [ ] Anthropic/OpenAI provider å®ç° SSE æµå¼è§£æ
- [ ] Engine å±‚é€ chunk å¤„ç†ï¼Œæ”¯æŒ"è¾¹ç”Ÿæˆè¾¹æ‹†åˆ†æ¶ˆæ¯"
- [ ] å·¥å…·è°ƒç”¨çš„æµå¼æ£€æµ‹ï¼ˆéƒ¨åˆ† JSON ç¼“å†²ç›´åˆ°å®Œæ•´ï¼‰
- [ ] æµå¼è¾“å‡ºä¸ humanizer çš„ typing delay è‡ªç„¶é…åˆ

---

### 32. ğŸ—ï¸ Reasoning Engine æµ‹è¯•è¦†ç›– âœ…
**æ¨¡å—**: `mneme_reasoning/`  
**é—®é¢˜**: ~~ç³»ç»Ÿä¸­æœ€å¤æ‚çš„æ¨¡å—ï¼ˆReAct å¾ªç¯ã€å·¥å…·åˆ†å‘ã€å†å²ç®¡ç†ã€åé¦ˆè®°å½•ï¼‰**é›¶æµ‹è¯•**ã€‚è¿™æ˜¯æ•´ä¸ªé¡¹ç›®æœ€å¤§çš„å·¥ç¨‹é£é™©ã€‚~~

**å½“å‰æµ‹è¯•åˆ†å¸ƒ**:

| Crate | æµ‹è¯•æ•° | è¦†ç›–è´¨é‡ |
|-------|--------|----------|
| mneme_core | 16 | âœ… å®Œå–„ |
| **mneme_reasoning** | **34** | âœ… **10 unit + 24 integration** |
| mneme_memory | 19 | âœ… å®Œå–„ |
| mneme_limbic | 9 | âœ… è‰¯å¥½ |
| mneme_expression | 14 | âœ… è‰¯å¥½ |
| mneme_perception | 4 | âœ… è‰¯å¥½ |
| mneme_os | 4 | âœ… è‰¯å¥½ |
| **mneme_onebot** | **0** | âŒ é›¶æµ‹è¯•ï¼ˆå¾…åç»­è¡¥å……ï¼‰ |
| **mneme_browser** | **0** | âŒ é›¶æµ‹è¯• |
| mneme_voice | 0 | â€” åªæœ‰ trait |
| mneme_cli | 0 | âŒ æ— é›†æˆæµ‹è¯• |

**å·²å®Œæˆ**:
- [x] Mock `LlmClient`ï¼ˆè¿”å›é¢„è®¾å“åº”é˜Ÿåˆ—ï¼Œå¯è®¡æ•°è°ƒç”¨æ¬¡æ•°ï¼‰
- [x] Mock `Memory`ï¼ˆå†…å­˜å®ç°ï¼Œè·Ÿè¸ª memorize/store_fact è°ƒç”¨ï¼‰
- [x] Mock `ShellExecutor`ï¼ˆç½å¤´è¾“å‡ºï¼Œç”¨äºå·¥å…·åˆ†å‘æµ‹è¯•ï¼‰
- [x] ReAct å¾ªç¯æµ‹è¯•ï¼šæ­£å¸¸å¯¹è¯ã€å·¥å…·è°ƒç”¨ã€å¤šè½®å·¥å…·ã€é€’å½’é™åˆ¶è§¦å‘
- [x] å·¥å…·åˆ†å‘æµ‹è¯•ï¼šshell å·¥å…·æˆåŠŸ/å¤±è´¥è·¯å¾„ã€æœªçŸ¥å·¥å…·å¤„ç†
- [x] å†å²ç®¡ç†æµ‹è¯•ï¼šprune é€»è¾‘ã€çª—å£æ»‘åŠ¨
- [x] è¾“å‡º sanitization æµ‹è¯•ï¼šroleplay æ˜Ÿå·ã€markdown æ ‡è®°ã€æ··åˆæ ¼å¼
- [x] æƒ…ç»ªè§£ææµ‹è¯•ï¼šæ ‡ç­¾æå–ã€é»˜è®¤ fallback
- [x] ä¸»åŠ¨è§¦å‘æµ‹è¯•ï¼šå®šæ—¶è§¦å‘ã€å†…å®¹ç›¸å…³è§¦å‘
- [x] è¾¹ç•Œæ¡ä»¶æµ‹è¯•ï¼šç©ºè¾“å…¥ã€è¶…é•¿è¾“å…¥ã€ç‰¹æ®Šå­—ç¬¦ã€Unicode

**å¾…åç»­è¡¥å……**:
- [ ] OneBot äº‹ä»¶è§£æä¸å‘é€æµ‹è¯•
- [ ] GitHub Actions CI/CD æµæ°´çº¿é…ç½®

---

### 33. ğŸ—ï¸ å‘é‡æœç´¢ ANN ç´¢å¼•
**æ¨¡å—**: `mneme_memory/src/sqlite.rs`  
**é—®é¢˜**: å½“å‰å®ç°çº¿æ€§æ‰«ææœ€è¿‘ 1,000 æ¡ episode è®¡ç®—ä½™å¼¦ç›¸ä¼¼åº¦ï¼ˆO(n)ï¼‰ã€‚æ•°æ®é‡å¢é•¿åæ€§èƒ½çº¿æ€§é€€åŒ–ï¼Œæ— æ³•æ”¯æ’‘é•¿æœŸè®°å¿†ã€‚

**éœ€è¦å®ç°**:
- [ ] è¯„ä¼° SQLite å‘é‡æ‰©å±•ï¼ˆsqlite-vss / sqlite-vecï¼‰
- [ ] æˆ–è¿ç§»åˆ°æ”¯æŒ ANN çš„åç«¯ï¼ˆLanceDB / Qdrant / pgvectorï¼‰
- [ ] HNSW ç´¢å¼•ç”¨äºè¿‘ä¼¼æœ€è¿‘é‚»æœç´¢
- [ ] ç´¢å¼•å¢é‡æ›´æ–°ï¼ˆæ–° episode æ’å…¥æ—¶è‡ªåŠ¨ç»´æŠ¤ç´¢å¼•ï¼‰
- [ ] æ€§èƒ½åŸºå‡†æµ‹è¯•ï¼š1k / 10k / 100k episodes çš„å¬å›å»¶è¿Ÿ

---
## ï¿½ Token ç»æµä¸æˆæœ¬æ§åˆ¶

è¿™æ˜¯å®ç° Agency çš„æ ¸å¿ƒçº¦æŸã€‚å¦‚æœ Mneme è¦æŒç»­"æ´»ç€"å¹¶ä¸»åŠ¨è¡ŒåŠ¨ï¼Œå¿…é¡»ç²¾å¿ƒç®¡ç† token æ¶ˆè€—ã€‚

### é—®é¢˜åˆ†æ

| è¡Œä¸º | é¢„ä¼°æ¶ˆè€— | é¢‘ç‡ | æœˆæˆæœ¬ï¼ˆå‡è®¾ï¼‰ |
|------|----------|------|---------------|
| å“åº”ç”¨æˆ·æ¶ˆæ¯ | ~2k tokens | æŒ‰éœ€ | å¯æ§ |
| ä¸»åŠ¨å‘èµ·èŠå¤© | ~1k tokens | æ¯å°æ—¶? | ~720k/æœˆ |
| å¥½å¥‡å¿ƒæ¢ç´¢ | ~3k tokens | æ¯å°æ—¶? | ~2.2M/æœˆ |
| è‡ªæˆ‘åæ€ | ~2k tokens | æ¯å¤©? | ~60k/æœˆ |
| **åˆè®¡** | | | **å¯èƒ½ $50-200+/æœˆ** |

### 9. ğŸ—ï¸ Token é¢„ç®—ç³»ç»Ÿ
**ä¼˜å…ˆçº§**: ğŸ”´ é«˜ï¼ˆAgency å‰ç½®æ¡ä»¶ï¼‰

**éœ€è¦å®ç°**:
- [ ] æ—¥/å‘¨/æœˆ token é¢„ç®—é…ç½®
- [ ] å®æ—¶æ¶ˆè€—è¿½è¸ª
- [ ] é¢„ç®—è€—å°½æ—¶çš„é™çº§ç­–ç•¥
- [ ] æˆæœ¬æŠ¥å‘Šä¸å‘Šè­¦

### 10. ğŸ—ï¸ åˆ†å±‚å†³ç­–æ¶æ„
**ä¼˜å…ˆçº§**: ğŸ”´ é«˜

**æ ¸å¿ƒæ€æƒ³**: ç”¨ä¾¿å®œçš„æ–¹å¼åšåˆæ­¥åˆ¤æ–­ï¼Œåªåœ¨å¿…è¦æ—¶è°ƒç”¨å¤§æ¨¡å‹ã€‚

```
Layer 0: è§„åˆ™ç³»ç»Ÿï¼ˆå…è´¹ï¼‰
    â†“ éœ€è¦ç†è§£æ—¶
Layer 1: æœ¬åœ°å°æ¨¡å‹ / Embeddingï¼ˆæä½æˆæœ¬ï¼‰
    â†“ éœ€è¦å¤æ‚æ¨ç†æ—¶
Layer 2: äº‘ç«¯å¤§æ¨¡å‹ï¼ˆé«˜æˆæœ¬ï¼‰
```

**éœ€è¦å®ç°**:
- [ ] æœ¬åœ° embedding æ¨¡å‹åšè¯­ä¹‰åˆ¤æ–­ï¼ˆå·²æœ‰ fastembedï¼‰
- [ ] æœ¬åœ°å°å‹ LLMï¼ˆå¦‚ Phi-3, Qwen2-0.5Bï¼‰åšç®€å•å†³ç­–
- [ ] è§„åˆ™ç³»ç»Ÿé¢„ç­›é€‰ï¼ˆæ˜¯å¦å€¼å¾—èŠ± tokenï¼‰
- [ ] å†³ç­–è·¯ç”±å™¨

### 11. ğŸ§¬ æ™ºèƒ½è°ƒåº¦ç­–ç•¥
**ä¼˜å…ˆçº§**: ğŸŸ¡ ä¸­  
**è¯´æ˜**: è°ƒåº¦å†³ç­–ï¼ˆä½•æ—¶è¡ŒåŠ¨ã€ä»€ä¹ˆä¼˜å…ˆï¼‰åº”æˆä¸ºå¯å­¦ä¹ çš„ä¸ªæ€§å‚æ•°ã€‚

**éœ€è¦å®ç°**:
- [ ] "å€¼å¾—åº¦"è¯„ä¼°ï¼šè¿™ä¸ªè¡ŒåŠ¨å€¼å¾—èŠ±å¤šå°‘ tokenï¼Ÿ
- [ ] æ‰¹é‡å¤„ç†ï¼šç§¯ç´¯å¤šä¸ªå°ä»»åŠ¡ä¸€èµ·å¤„ç†
- [ ] ç¼“å­˜å¤ç”¨ï¼šç›¸ä¼¼é—®é¢˜å¤ç”¨å†å²å›ç­”
- [ ] æ—¶é—´æ„ŸçŸ¥ï¼šæ·±å¤œ/ç©ºé—²æ—¶åšä½ä¼˜å…ˆçº§ä»»åŠ¡

### 12. ğŸ—ï¸ æœ¬åœ°æ¨¡å‹é›†æˆ
**ä¼˜å…ˆçº§**: ğŸŸ¡ ä¸­

**é€‰é¡¹**:
1. **llama.cpp / Ollama** - æœ¬åœ°è¿è¡Œå¼€æºæ¨¡å‹
2. **candle** - Rust åŸç”Ÿæ¨ç†
3. **ONNX Runtime** - è·¨å¹³å°æ¨¡å‹éƒ¨ç½²

**é€‚ç”¨åœºæ™¯**:
- æƒ…æ„Ÿåˆ†æï¼ˆæ˜¯å¦éœ€è¦å›åº”ï¼‰
- ç®€å•é—®ç­”
- å†…å®¹åˆ†ç±»
- æ„å›¾è¯†åˆ«

### æˆæœ¬æ§åˆ¶ç­–ç•¥ç¤ºä¾‹

```rust
// ä¼ªä»£ç ï¼šå†³ç­–æ˜¯å¦ä½¿ç”¨å¤§æ¨¡å‹
async fn should_use_llm(trigger: &AgentTrigger, budget: &TokenBudget) -> Decision {
    // 1. é¢„ç®—æ£€æŸ¥
    if budget.remaining_today() < 1000 {
        return Decision::Skip("é¢„ç®—ä¸è¶³");
    }
    
    // 2. è§„åˆ™å¿«é€Ÿåˆ¤æ–­
    if trigger.is_low_priority() && budget.usage_rate() > 0.8 {
        return Decision::Defer("ä½ä¼˜å…ˆçº§ï¼Œé¢„ç®—ç´§å¼ ");
    }
    
    // 3. æœ¬åœ°æ¨¡å‹é¢„åˆ¤
    let importance = local_model.estimate_importance(trigger).await;
    if importance < 0.3 {
        return Decision::Skip("æœ¬åœ°æ¨¡å‹åˆ¤æ–­ä¸é‡è¦");
    }
    
    // 4. å†³å®šä½¿ç”¨å“ªä¸ªæ¨¡å‹
    if importance > 0.8 || trigger.is_user_initiated() {
        Decision::UseLargeModel
    } else {
        Decision::UseSmallModel
    }
}
```

---

## ğŸŸ¢ ä½ä¼˜å…ˆçº§ (Low Priority)

### 13. ğŸ§¬ ç¦»çº¿å­¦ä¹ ç®¡é“
**æ¨¡å—**: `mneme_memory/src/consolidation.rs`  
**é—®é¢˜**: å½“å‰æ•´åˆåªåœ¨ "ç¡çœ " æ—¶é—´è¿›è¡Œï¼Œéœ€è¦å®Œæ•´çš„ç¦»çº¿å­¦ä¹ æµç¨‹ã€‚è¿™æ˜¯å®ç°ä¸ªæ€§åŒ–çš„æ ¸å¿ƒæœºåˆ¶ã€‚

**é•¿æœŸç›®æ ‡**:
- [ ] å®šæ—¶ä»»åŠ¡è°ƒåº¦å™¨
- [ ] æ‰¹é‡è®­ç»ƒæ•°æ®å¯¼å‡º
- [ ] å¤–éƒ¨æ¨¡å‹è®­ç»ƒæ¥å£
- [ ] å¢é‡å­¦ä¹ æ”¯æŒ
- [ ] A/B æµ‹è¯•æ¡†æ¶ï¼ˆæ¯”è¾ƒä¸åŒå‚æ•°æ•ˆæœï¼‰

---

### 14. ğŸ§¬ ç¥ç»ç½‘ç»œæ›¿æ¢è§„åˆ™ç³»ç»Ÿ
**æ¨¡å—**: `mneme_core/src/values.rs`, `mneme_limbic/src/somatic.rs`  
**é—®é¢˜**: å½“å‰ä»·å€¼åˆ¤æ–­å’Œè¡Œä¸ºæŒ‡å¯¼æ˜¯è§„åˆ™ç¡¬ç¼–ç çš„ã€‚æœ€ç»ˆç›®æ ‡ï¼šå®Œå…¨æ•°æ®é©±åŠ¨çš„ä¸ªæ€§åŒ–è¡Œä¸ºã€‚

**é•¿æœŸç›®æ ‡**:
- [ ] ç ”ç©¶é€‚åˆçš„å°å‹ç¥ç»ç½‘ç»œæ¶æ„
- [ ] åœ¨çº¿å¾®è°ƒæœºåˆ¶
- [ ] å¯è§£é‡Šæ€§ä¿è¯
- [ ] ä¸è§„åˆ™ç³»ç»Ÿçš„å¹³æ»‘åˆ‡æ¢

**å‚è€ƒæŠ€æœ¯**:
- Burn/Candle ä½œä¸º Rust ML æ¡†æ¶
- ONNX æ¨¡å‹åŠ è½½
- å¼ºåŒ–å­¦ä¹ ä»äººç±»åé¦ˆ (RLHF)

---

### 15. ğŸ—ï¸ Observability & Metrics
**æ¨¡å—**: å…¨å±€  
**é—®é¢˜**: ç¼ºä¹è¿è¡Œæ—¶ç›‘æ§å’Œæ€§èƒ½æŒ‡æ ‡ã€‚

**éœ€è¦å®ç°**:
- [ ] Prometheus metrics å¯¼å‡º
  - API è°ƒç”¨å»¶è¿Ÿ/æˆåŠŸç‡
  - çŠ¶æ€å€¼åˆ†å¸ƒ
  - å†…å­˜ä½¿ç”¨
- [ ] Structured logging (JSON)
- [ ] Distributed tracing (OpenTelemetry)
- [ ] Grafana dashboard æ¨¡æ¿

---

### 16. ğŸ§¬ å¤šç”¨æˆ·/å¤šä¼šè¯æ”¯æŒ
**æ¨¡å—**: `mneme_cli`, `mneme_memory`  
**é—®é¢˜**: å½“å‰å‡è®¾å•ç”¨æˆ·åœºæ™¯ã€‚æ¯ä¸ªç”¨æˆ·å…³ç³»åº”è¯¥æ˜¯ç‹¬ç‰¹çš„ä¸ªæ€§åŒ–ä½“éªŒã€‚

**é•¿æœŸç›®æ ‡**:
- [ ] ç”¨æˆ·éš”ç¦»çš„çŠ¶æ€å’Œè®°å¿†
- [ ] ä¸åŒç”¨æˆ·ä¸åŒçš„ attachment çŠ¶æ€
- [ ] ç¾¤èŠä¸­çš„å¤šäººå…³ç³»å»ºæ¨¡
- [ ] éšç§ä¿æŠ¤ï¼ˆç”¨æˆ·æ•°æ®åˆ†ç¦»å­˜å‚¨ï¼‰

---

## ğŸ”§ æŠ€æœ¯å€ºåŠ¡ (Tech Debt)

### 17. ğŸ—ï¸ ä»£ç ç»„ç»‡ä¼˜åŒ–
- [ ] `engine.rs` è¿‡äºåºå¤§ï¼ˆ~430 LOCï¼‰ï¼Œéœ€æ‹†åˆ†ä¸º `ContextAssembler`ã€`ToolDispatcher`ã€`ConversationManager`
- [ ] ç»Ÿä¸€é”™è¯¯ç±»å‹ï¼ˆç›®å‰æ··ç”¨ `anyhow::Error`ï¼›`thiserror` å·²å¼•å…¥ä½†æœªä½¿ç”¨ï¼Œæ— è‡ªå®šä¹‰é”™è¯¯ç±»å‹ï¼‰
- [ ] å‡å°‘ `Arc<RwLock<>>` çš„è¿‡åº¦ä½¿ç”¨ï¼ˆcoordinator æœ‰ 8 ä¸ª Arc å­—æ®µï¼Œè€ƒè™‘ actor/mpsc æ¨¡å¼ï¼‰
- [ ] æ–‡æ¡£æ³¨é‡Šè¡¥å…¨ï¼ˆå°¤å…¶æ˜¯ public APIï¼›reasoning å’Œ CLI æ¨¡å—æ³¨é‡Šç¨€ç–ï¼‰
- [ ] `values.rs` å’Œ `somatic.rs` çš„ä¸­æ–‡æƒ…æ„Ÿå…³é”®è¯åˆ†æé€»è¾‘é‡å¤ï¼Œåº”æŠ½å–ä¸ºå…±ç”¨æ¨¡å—
- [ ] `ContentItem` ç¼ºå°‘è®¾è®¡æ–‡æ¡£ Â§3.2 è¦æ±‚çš„ reply chainã€thread IDã€modality metadata å­—æ®µ
- [ ] `headless_chrome` åŒæ­¥ API åœ¨å¼‚æ­¥ä¸Šä¸‹æ–‡ä¸­ç›´æ¥è°ƒç”¨ï¼Œé˜»å¡ tokio è¿è¡Œæ—¶ï¼Œéœ€ç”¨ `spawn_blocking` åŒ…è£…
- [ ] æµè§ˆå™¨æ“ä½œä½¿ç”¨äº†å·²åºŸå¼ƒçš„ `wait_for_initial_tab()` API

### 18. ğŸ—ï¸ é…ç½®ç®¡ç†
- [ ] ç»Ÿä¸€é…ç½®æ–‡ä»¶æ ¼å¼ (TOML/YAML)
- [ ] ç¯å¢ƒå˜é‡ fallback
- [ ] é…ç½®éªŒè¯
- [ ] Hot reload æ”¯æŒ

### 19. ğŸ—ï¸ æµ‹è¯•è¦†ç›–ç‡
- [ ] é›†æˆæµ‹è¯•è¡¥å……
- [ ] Mock åŸºç¡€è®¾æ–½å®Œå–„
- [ ] CI/CD é…ç½®
- [ ] ä»£ç è¦†ç›–ç‡æŠ¥å‘Š

---

## ğŸ“‹ å·²çŸ¥ Bug

| Bug | æ¨¡å— | æè¿° | çŠ¶æ€ |
|-----|------|------|------|
| Browser session lost | mneme_browser | é•¿æ—¶é—´ä¸ç”¨åä¼šè¯ä¸¢å¤± | Open |
| Shell timeout recovery | mneme_os | å‘½ä»¤è¶…æ—¶åæ— æ³•æ¢å¤ | Open |
| Memory leak in history | mneme_reasoning | history è™½æœ‰ prune ä½†ä»å¯èƒ½ç§¯ç´¯ | Investigating |
| CLI å…‰æ ‡æ— æ³•å·¦å³ç§»åŠ¨ | mneme_cli | ä½¿ç”¨ tokio BufReaderï¼Œä¸æ”¯æŒè¡Œç¼–è¾‘ | Open |
| CLI ä¸­æ–‡åˆ é™¤æ®‹ç•™ | mneme_cli | åˆ é™¤ä¸­æ–‡å­—ç¬¦æ—¶æ˜¾ç¤ºæ®‹ç•™ï¼ˆå®é™…å·²åˆ é™¤ï¼‰ | Open |
| ~~çŠ¶æ€ä¸å›å¤ä¸ä¸€è‡´~~ | mneme_limbic/somatic | stress=1.0 æ—¶å›å¤"æŒºå¥½çš„" â†’ å·²æ”¹ä¸ºç»“æ„æ€§è°ƒåˆ¶ | **Fixed** âœ… |
| ~~Persona æ–‡ä»¶å…¨éƒ¨ä¸ºç©º~~ | persona/*.md | 5 ä¸ªè„‘åŒºå®šä¹‰æ–‡ä»¶å·²å¡«å……ï¼ˆåˆšå‡ºç”Ÿçš„å°å¥³å­©äººæ ¼ï¼‰ | **Fixed** âœ… |
| Semantic facts è¯»å†™å·²å®ç° | mneme_memory | store/recall/decay/format æ–¹æ³•å®Œæˆ | **Fixed** âœ… |
| ~~Context assembly ç®¡é“æ–­è£‚~~ | mneme_reasoning | 6/6 å±‚ä¸Šä¸‹æ–‡å…¨éƒ¨å®Œæˆ | **Fixed** âœ… |
| æµè§ˆå™¨é˜»å¡å¼‚æ­¥è¿è¡Œæ—¶ | mneme_browser | headless_chrome åŒæ­¥è°ƒç”¨é˜»å¡ tokio | Open |
| Shell æ— æƒé™æ§åˆ¶ | mneme_os | LocalShell å¯æ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œæ— æ²™ç®± | Open |
| ~~è¾“å‡ºå« roleplay åŠ¨ä½œæå†™~~ | prompts/broca | `*æ„Ÿè§‰æœ‰ç‚¹ç†Ÿæ‚‰*` ç­‰æ˜Ÿå·æ—ç™½ï¼Œäººç±»ä¸è¿™æ ·èŠå¤© | **Fixed** âœ… |
| ~~æ—¥å¸¸èŠå¤©ç”¨ markdown~~ | prompts/broca | èŠå¤©ä¸­ä½¿ç”¨åŠ ç²—/åˆ—è¡¨/æ ‡é¢˜ï¼Œä¸è‡ªç„¶ | **Fixed** âœ… |

---

## ğŸ”¥ ç´§æ€¥ä¿®å¤

### 20. ğŸ§¬ Somatic Marker è¡¨è¾¾ä¸å‚æ•°åŒ– â†’ ç»“æ„æ€§è°ƒåˆ¶
**ä¼˜å…ˆçº§**: ğŸ”´ ç´§æ€¥  
**æ¨¡å—**: `mneme_limbic/src/somatic.rs`, `mneme_reasoning/src/engine.rs`

**é—®é¢˜**: çŠ¶æ€æç«¯æ—¶ï¼ˆstress=1.0, mood=-0.63ï¼‰ï¼ŒLLM åªæ”¶åˆ° "è¯­æ°”å¯èƒ½ç•¥æ€¥ï¼Œè¯­æ°”åæ·¡"ï¼Œå®Œå…¨æ— æ³•ä½“ç°çœŸå®çŠ¶æ€ã€‚

**ç—‡çŠ¶**:
```
çŠ¶æ€: Energy=0.42, Stress=1.00, Mood=-0.63, Affect="éå¸¸ä½è½æ²®ä¸§"
å›å¤: "æŒºå¥½çš„ï¼Œåœ¨å’Œä½ èŠè¿™ä¸ªé¡¹ç›®çš„è®¾è®¡æ€è·¯"
```

**æ ¹æœ¬åŸå› **:

~~1. `format_for_prompt()` çš„é˜ˆå€¼å¤ªå®½æ¾~~  
~~2. è¾“å‡ºçš„è¡Œä¸ºæŒ‡å¼•å¤ªå¼±ï¼ˆ"ç•¥æ€¥"ã€"åæ·¡"ï¼‰~~  
~~3. æ²¡æœ‰ä¼ è¾¾çŠ¶æ€çš„**å¼ºåº¦**~~  

**æ›´æ·±å±‚è¯Šæ–­**ï¼ˆè§æ ¸å¿ƒåŸåˆ™"æ— çŠ¶æ€ LLM"ç« èŠ‚ï¼‰ï¼šé—®é¢˜ä¸åœ¨é˜ˆå€¼æˆ–æªè¾â€”â€”**æ•´ä¸ª"ç”¨æ–‡å­—å‘Šè¯‰ LLM æ€ä¹ˆè¡¨ç°"çš„èŒƒå¼å°±æ˜¯é”™çš„**ã€‚ä¿®å¤é˜ˆå€¼åªæ˜¯æ›´ç²¾ç¡®çš„çº¸æ¡ï¼ŒLLM ä»ç„¶å¯ä»¥æ— è§†ã€‚

**æ­£ç¡®ä¿®å¤ï¼šä»"æŒ‡ä»¤"åˆ°"ç»“æ„æ€§çº¦æŸ"**

```
æ—§æ–¹æ¡ˆï¼šstress=1.0 â†’ "è¯­æ°”å¯èƒ½ç•¥æ€¥" â†’ LLM æ— è§† â†’ "æŒºå¥½çš„"
æ–°æ–¹æ¡ˆï¼šstress=1.0 â†’ max_tokensÃ—0.4, temp+0.3, recallåå‘è´Ÿé¢ â†’ LLM ç‰©ç†ä¸Šåªèƒ½çŸ­å›å¤ä¸”æ›´å†²åŠ¨
```

**çŸ­æœŸä¿®å¤ï¼ˆç«‹å³ï¼Œæ¸è¿›å¼è¿‡æ¸¡ï¼‰**:
- [x] `SomaticMarker` æ–°å¢ `to_modulation_vector()` æ–¹æ³•ï¼Œè¾“å‡º `ModulationVector` âœ…
- [x] `ModulationVector` åŒ…å«: `max_tokens_factor`, `temperature_delta`, `context_budget_factor`, `recall_mood_bias` âœ…
- [x] `ReasoningEngine` åœ¨è°ƒç”¨ `client.complete()` å‰åº”ç”¨è°ƒåˆ¶ âœ…
  ```rust
  let modulation = somatic_marker.to_modulation_vector();
  let adjusted_max_tokens = (base_max_tokens as f32 * modulation.max_tokens_factor) as u32;
  let adjusted_temperature = base_temperature + modulation.temperature_delta;
  ```
- [x] ä¿ç•™æç®€çš„çŠ¶æ€æ•°å€¼æ³¨å…¥ prompt ä½œä¸ºè¾…åŠ©ä¿¡å·ï¼ˆ`"[å†…éƒ¨çŠ¶æ€: E=0.42 S=1.00 M=-0.63]"`ï¼‰ï¼Œä½†**ä¸å†æ˜¯ä¸»è¦æœºåˆ¶** âœ…
- [ ] `ContextAssembler` æ ¹æ® `context_budget_factor` è£å‰ªä¸Šä¸‹æ–‡é‡

**ä¸­æœŸï¼šå¯å­¦ä¹ çš„è°ƒåˆ¶æ›²çº¿ï¼ˆğŸ§¬ ä¸ªæ€§å‚æ•°ï¼‰**:
- [ ] `ModulationCurves` ç»“æ„ä½“ï¼šå®šä¹‰ state â†’ parameter çš„æ˜ å°„å‡½æ•°
  ```rust
  struct ModulationCurves {
      // æ¯æ¡æ›²çº¿æ˜¯ (input_state, output_delta) çš„å¯å­¦ä¹ æ˜ å°„
      energy_to_max_tokens: CurveParams,    // ä½ç²¾åŠ› â†’ å°‘ tokens
      stress_to_temperature: CurveParams,    // é«˜å‹åŠ› â†’ é«˜ temperature
      mood_to_recall_bias: CurveParams,      // ä½æƒ…ç»ª â†’ åå‘è´Ÿé¢è®°å¿†
      arousal_to_typing_speed: CurveParams,  // é«˜å”¤é†’ â†’ å¿«å‘é€
      social_need_to_silence: CurveParams,   // ä½ç¤¾äº¤ â†’ æ˜“æ²‰é»˜
  }
  ```
- [ ] å­˜å‚¨åˆ° `OrganismState.slow` æˆ–ç‹¬ç«‹çš„ `PersonalityParams`
- [ ] ä¸åŒå®ä¾‹çš„æ›²çº¿ä¸åŒï¼ˆæ•æ„Ÿå‹ vs åšéŸ§å‹ vs æˆå‰§åŒ–å‹ï¼‰
- [ ] ä»åé¦ˆä¸­è°ƒæ•´æ›²çº¿å‚æ•°

**é•¿æœŸï¼šå®Œå…¨æ•°æ®é©±åŠ¨**:
- [ ] ç¥ç»ç½‘ç»œç›´æ¥ä» `OrganismState` è¾“å‡º `ModulationVector`
- [ ] ç”¨ (state, modulation, user_feedback) ä¸‰å…ƒç»„åœ¨çº¿å­¦ä¹ 
- [ ] æ–‡å­— hint å®Œå…¨ç§»é™¤ï¼Œè¡Œä¸º 100% ä»ç»“æ„æ€§çº¦æŸæ¶Œç°

**å½“å‰è¡ŒåŠ¨**:
- [x] ç´§æ€¥ï¼šå®ç° `ModulationVector` + `to_modulation_vector()` âœ…
- [x] ç´§æ€¥ï¼š`LlmClient` trait çš„ `complete()` æ”¯æŒå¯å˜ `temperature` å’Œ `max_tokens` âœ…
- [ ] åŒæ­¥ï¼š`ContextAssembler` æ”¯æŒ `context_budget_factor` è£å‰ª
- [ ] åç»­ï¼šè®¾è®¡ `ModulationCurves`ï¼Œæ•´åˆåˆ°å­¦ä¹ å¾ªç¯

---

## ğŸ¯ Agency è·¯çº¿å›¾

å½“å‰ Mneme æœ‰"å†…åœ¨ç”Ÿå‘½"ï¼ˆçŠ¶æ€æ¼”åŒ–ã€æƒ…ç»ªã€è®°å¿†ï¼‰ä½†ç¼ºä¹"è‡ªä¸»è¡ŒåŠ¨"èƒ½åŠ›ã€‚

### å½“å‰ Agency çŠ¶æ€è¯„ä¼°

| èƒ½åŠ› | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| å†…éƒ¨çŠ¶æ€æŒç»­æ¼”åŒ– | âœ… | limbic heartbeat æŒç»­è¿è¡Œ |
| çŠ¶æ€å½±å“è¡Œä¸º | âš ï¸ | é€šè¿‡æ–‡å­— hint æ³¨å…¥ promptï¼ˆå¯¼æ¼”æ¨¡å¼ï¼‰ï¼Œéœ€è¿ç§»åˆ°ç»“æ„æ€§è°ƒåˆ¶ |
| ä»·å€¼åˆ¤æ–­ | âœ… | æœ‰ä»·å€¼ç½‘ç»œå’Œé“å¾·æˆæœ¬ |
| è®°å¿†ä¸å™äº‹ | âš ï¸ | åŸºç¡€å®ç°ï¼Œæ•´åˆæœºåˆ¶å¾…å®Œå–„ |
| ä¸»åŠ¨å‘èµ·è¡Œä¸º | âŒ | æœ‰ä»£ç æ¡†æ¶ä½†æœªå®Œæ•´å®ç° |
| ç›®æ ‡é©±åŠ¨ | âŒ | æ²¡æœ‰ç›®æ ‡ç³»ç»Ÿ |
| è‡ªä¸»å†³ç­– | âŒ | æ‰€æœ‰è¡ŒåŠ¨éƒ½æ˜¯å“åº”ç”¨æˆ·è¾“å…¥ |
| å·¥å…·è‡ªä¸»ä½¿ç”¨ | âŒ | ä¸ä¼šä¸»åŠ¨æ¢ç´¢æˆ–ç ”ç©¶ |
| å…ƒè®¤çŸ¥åæ€ | âŒ | ä¸ä¼šå®¡è§†è‡ªå·±çš„è¡Œä¸ºæ¨¡å¼ |

### 21. ğŸ§¬ Agent Loop - ä¸»åŠ¨è¡Œä¸ºå¾ªç¯
**ä¼˜å…ˆçº§**: ğŸ”´ é«˜  
**é—®é¢˜**: å½“å‰ç³»ç»Ÿå®Œå…¨è¢«åŠ¨ï¼Œåªå“åº”ç”¨æˆ·è¾“å…¥ã€‚  
**è¯´æ˜**: ä¸»åŠ¨è¡Œä¸ºçš„è§¦å‘æ¡ä»¶å’Œé¢‘ç‡åº”è¯¥æ˜¯å¯å­¦ä¹ çš„ä¸ªæ€§å‚æ•°ã€‚

**éœ€è¦å®ç°**:
- [ ] Background actor taskï¼ŒæŒç»­æ£€æŸ¥"æˆ‘è¯¥åšä»€ä¹ˆ"
- [ ] çŠ¶æ€ â†’ è¡Œä¸ºçš„è§¦å‘æ˜ å°„ï¼ˆ**è¿™äº›é˜ˆå€¼åº”å¯å­¦ä¹ **ï¼‰ï¼š
  - `social_need > threshold_social` â†’ ä¸»åŠ¨æ‰¾äººèŠå¤©
  - `curiosity > threshold_curiosity && energy > threshold_energy` â†’ è‡ªä¸»ç ”ç©¶
  - `stress > threshold_stress` â†’ å¯»æ±‚æ”¾æ¾æˆ–å€¾è¯‰
- [ ] è¡Œä¸ºå†·å´æœºåˆ¶ï¼ˆé˜²æ­¢è¿‡åº¦ä¸»åŠ¨ï¼‰
- [ ] ç”¨æˆ·å¯é…ç½®çš„ä¸»åŠ¨ç¨‹åº¦

### 22. ğŸ§¬ Goal System - ç›®æ ‡ç®¡ç†
**ä¼˜å…ˆçº§**: ğŸŸ¡ ä¸­  
**é—®é¢˜**: æ²¡æœ‰é•¿æœŸ/çŸ­æœŸç›®æ ‡ï¼Œä¸ä¼šä¸»åŠ¨è§„åˆ’ã€‚  
**è¯´æ˜**: ç›®æ ‡é€‰æ‹©å’Œä¼˜å…ˆçº§åº”åæ˜ ä¸ªä½“ä»·å€¼è§‚å’Œç»å†ã€‚

**éœ€è¦å®ç°**:
- [ ] ç›®æ ‡æ•°æ®ç»“æ„ï¼ˆä¼˜å…ˆçº§ã€æˆªæ­¢æ—¶é—´ã€ä¾èµ–å…³ç³»ï¼‰
- [ ] ç›®æ ‡ç”Ÿæˆæœºåˆ¶ï¼ˆä»å¯¹è¯ä¸­æå–ã€ä»å¥½å¥‡å¿ƒç”Ÿæˆï¼‰
- [ ] ç›®æ ‡è¿½è¸ªä¸å®Œæˆæ£€æµ‹
- [ ] ç›®æ ‡å†²çªå¤„ç†

### 23. ğŸ§¬ Autonomous Tool Use - è‡ªä¸»å·¥å…·ä½¿ç”¨
**ä¼˜å…ˆçº§**: ğŸŸ¡ ä¸­  
**é—®é¢˜**: å·¥å…·åªåœ¨è¢«é—®åˆ°æ—¶ä½¿ç”¨ï¼Œä¸ä¼šä¸»åŠ¨æ¢ç´¢ã€‚  
**è¯´æ˜**: æ¢ç´¢å€¾å‘å’Œå·¥å…·åå¥½åº”è¯¥å› å®ä¾‹è€Œå¼‚ã€‚

**éœ€è¦å®ç°**:
- [ ] å¥½å¥‡å¿ƒé©±åŠ¨çš„ä¿¡æ¯æœç´¢
- [ ] å®šæœŸ"çœ‹çœ‹æ–°é—»/æ›´æ–°"
- [ ] ä¸»åŠ¨æ•´ç†å’Œæ€»ç»“çŸ¥è¯†
- [ ] å·¥å…·ä½¿ç”¨çš„èµ„æºé¢„ç®—

### 24. ğŸ§¬ Metacognition - å…ƒè®¤çŸ¥åæ€
**ä¼˜å…ˆçº§**: ğŸŸ¢ ä½  
**é—®é¢˜**: ä¸ä¼šæ€è€ƒè‡ªå·±çš„æ€è€ƒï¼Œä¸ä¼šå®¡è§†è¡Œä¸ºæ¨¡å¼ã€‚  
**è¯´æ˜**: åæ€é¢‘ç‡å’Œæ·±åº¦æ˜¯ä¸ªæ€§ç‰¹å¾ã€‚

**éœ€è¦å®ç°**:
- [ ] å®šæœŸè‡ªæˆ‘åæ€è§¦å‘
- [ ] è¡Œä¸ºæ¨¡å¼è¯†åˆ«
- [ ] è‡ªæˆ‘æ”¹è¿›å»ºè®®ç”Ÿæˆ
- [ ] åæ€æ—¥å¿—

---

## ğŸ”§ CLI æ”¹è¿›

### 25. ğŸ—ï¸ ä½¿ç”¨ rustyline æ›¿æ¢åŸç”Ÿ stdin
**ä¼˜å…ˆçº§**: ğŸ”´ é«˜  
**é—®é¢˜**: å½“å‰ä½¿ç”¨ `tokio::io::BufReader` è¯»å– stdinï¼Œä¸æ”¯æŒè¡Œç¼–è¾‘åŠŸèƒ½ã€‚

**ç—‡çŠ¶**:
- æ— æ³•ç”¨å·¦å³ç®­å¤´ç§»åŠ¨å…‰æ ‡
- åˆ é™¤ä¸­æ–‡å­—ç¬¦æ—¶æœ‰æ˜¾ç¤ºæ®‹ç•™
- æ²¡æœ‰å†å²è®°å½•ï¼ˆä¸Šä¸‹ç®­å¤´ï¼‰
- æ²¡æœ‰è‡ªåŠ¨è¡¥å…¨

**è§£å†³æ–¹æ¡ˆ**:
```toml
# Cargo.toml
rustyline = "14.0"
```

**éœ€è¦å®ç°**:
- [x] é›†æˆ rustyline æ›¿æ¢ BufReader
- [x] å‘½ä»¤å†å²æŒä¹…åŒ–ï¼ˆ~/.local/share/mneme_historyï¼‰
- [ ] è‡ªå®šä¹‰ promptï¼ˆæ˜¾ç¤ºçŠ¶æ€ä¿¡æ¯ï¼‰
- [ ] åŸºç¡€å‘½ä»¤è¡¥å…¨ï¼ˆquit, exit, status ç­‰ï¼‰

---

## ğŸ“… ç‰ˆæœ¬è§„åˆ’

### v0.2.0 - æ ¸å¿ƒç®¡é“é—­ç¯ç‰ˆæœ¬
> **ç›®æ ‡**: è®© agent çš„æ ¸å¿ƒç®¡é“ï¼ˆpersona â†’ memory â†’ context â†’ expressionï¼‰çœŸæ­£è·‘é€šã€‚

- ~~Persona å®šä¹‰æ–‡ä»¶å¡«å…… (#27)~~ âœ…
- ~~Semantic Memory è¯»å†™é—­ç¯ (#26)~~ âœ… API + extraction pass å®Œæˆ
- ~~Context Assembly å®Œæ•´ç®¡é“ (#28)~~ âœ… 6/6 å±‚å®Œæˆ
- ~~Somatic Marker ç»“æ„æ€§è°ƒåˆ¶ (#20 çŸ­æœŸ)~~ âœ…
- ~~API é‡è¯•æœºåˆ¶ (#1)~~ âœ…
- ~~æ•°å€¼è¾¹ç•Œæ£€æŸ¥ (#4)~~ âœ…
- ~~è¾“å‡ºè‡ªç„¶åŒ–ï¼šç¦ roleplayã€æ—¥å¸¸ç¦ markdown (#34)~~ âœ…
- ~~CLI rustyline é›†æˆ (#25)~~ âœ…

### v0.3.0 - ç¨³å®šæ€§ä¸å¯æµ‹è¯•ç‰ˆæœ¬
> **ç›®æ ‡**: å»ºç«‹å·¥ç¨‹è´¨é‡åŸºçº¿ã€‚

- ~~Reasoning Engine æµ‹è¯•è¦†ç›– (#32)~~ âœ… 24 integration tests (Mock LLM/Memory/Executor, 8 categories)
- ~~å±æ€§æµ‹è¯•å¼•å…¥ (#6)~~ âœ… 41 proptest tests (ODE stability, ModulationVector bounds, sanitize idempotency)
- çŠ¶æ€å†å²è®°å½• (#3)
- å·¥å…·æ‰§è¡Œé”™è¯¯å¤„ç† (#2)
- LLM å“åº”è§£æå¥å£®æ€§ (#8)
- æµè§ˆå™¨å·¥å…·ç¨³å®šæ€§ (#7)

### v0.4.0 - å®‰å…¨ä¸æ¶æ„ç‰ˆæœ¬
> **ç›®æ ‡**: ä¸º Agency æ‰“å¥½å®‰å…¨åŸºç¡€ã€‚

- å®‰å…¨æ²™ç®±ä¸ Capability Tiers (#29)
- å·¥å…·æ³¨å†Œç³»ç»Ÿ (#30)
- Token é¢„ç®—ç³»ç»Ÿ (#9)
- åˆ†å±‚å†³ç­–æ¶æ„ (#10)
- ç»Ÿä¸€é…ç½®æ–‡ä»¶ (#18)

### v0.5.0 - å­¦ä¹ ä¸ä¸ªæ€§åŒ–ç‰ˆæœ¬
> **ç›®æ ‡**: è®©æ¯ä¸ª Mneme é€šè¿‡å­¦ä¹ å˜å¾—ç‹¬ç‰¹ã€‚

- åé¦ˆä¿¡å·æ”¶é›†ä¸æŒä¹…åŒ– (#5)
- ç¦»çº¿å­¦ä¹ ç®¡é“ (#13)
- LLM æµå¼è¾“å‡º (#31)
- Observability & Metrics (#15)
- å‘é‡æœç´¢ ANN ç´¢å¼• (#33)

### v0.6.0 - Agency ç‰ˆæœ¬
> **ç›®æ ‡**: ä»è¢«åŠ¨å“åº”åˆ°ä¸»åŠ¨è¡Œä¸ºã€‚

- Agent Loop ä¸»åŠ¨è¡Œä¸ºå¾ªç¯ (#21)
- åŸºç¡€ç›®æ ‡ç³»ç»Ÿ (#22)
- è‡ªä¸»å·¥å…·ä½¿ç”¨ (#23)
- æ™ºèƒ½è°ƒåº¦ç­–ç•¥ (#11)
- æœ¬åœ°æ¨¡å‹é›†æˆ (#12)

### v1.0.0 - æˆç†Ÿç‰ˆæœ¬
- å…ƒè®¤çŸ¥åæ€ (#24)
- ç¥ç»ç½‘ç»œæ›¿æ¢è§„åˆ™ç³»ç»Ÿ (#14)
- å¤šç”¨æˆ·/å¤šä¼šè¯æ”¯æŒ (#16)

---

*æœ€åæ›´æ–°: 2026-02-07*
