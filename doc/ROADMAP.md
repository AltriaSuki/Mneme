# Mneme å¼€å‘è·¯çº¿å›¾ (Roadmap)

æœ¬æ–‡æ¡£è®°å½•å½“å‰å·²çŸ¥é—®é¢˜å’Œæœªæ¥æ”¹è¿›è®¡åˆ’ã€‚

> **æ ¸å¿ƒå“²å­¦è§ [`MANIFESTO.md`](MANIFESTO.md)ã€‚** æœ¬æ–‡æ¡£æ˜¯å·¥ç¨‹æ‰§è¡Œå±‚é¢çš„ä»»åŠ¡æ¸…å•ã€‚
> æ‰€æœ‰è®¾è®¡å†³ç­–çš„ã€Œä¸ºä»€ä¹ˆã€è®°å½•åœ¨ Manifesto çš„ ADR ç« èŠ‚ã€‚

---

## ğŸ§¬ æ ¸å¿ƒè®¾è®¡åŸåˆ™

> **æ¯ä¸ª Mneme éƒ½æ˜¯ç‹¬ç‰¹çš„ä¸ªä½“ã€‚**

### ä»è§„åˆ™åˆ°æ¶Œç°

åˆå§‹é˜¶æ®µå¯ä»¥ä½¿ç”¨å†™æ­»çš„è§„åˆ™ä½œä¸º bootstrapï¼Œä½†é•¿æœŸç›®æ ‡æ˜¯è®©æ‰€æœ‰è¡Œä¸ºå‚æ•°éƒ½é€šè¿‡**å­¦ä¹ å’Œç»å†**å½¢æˆï¼Œè€Œéé¢„è®¾ï¼š

| é˜¶æ®µ | æ–¹å¼ | ä¸¾ä¾‹ |
|------|------|------|
| **Bootstrap** | ç¡¬ç¼–ç è§„åˆ™ | `if energy < 0.3 { å›å¤ç®€æ´ }` |
| **è¿‡æ¸¡æœŸ** | è§„åˆ™ + å¯è°ƒå‚æ•° | é˜ˆå€¼ 0.3 å˜ä¸ºå¯å­¦ä¹ çš„ `energy_threshold` |
| **æˆç†ŸæœŸ** | å®Œå…¨æ•°æ®é©±åŠ¨ | ç¥ç»ç½‘ç»œç›´æ¥ä»çŠ¶æ€æ˜ å°„åˆ°è¡Œä¸ºå€¾å‘ |

### ä¸¤ç±»æ”¹è¿›

åœ¨é˜…è¯»æœ¬æ–‡æ¡£æ—¶ï¼Œè¯·åŒºåˆ†ï¼š

| ç±»å‹ | è¯´æ˜ | ä¸¾ä¾‹ |
|------|------|------|
| ğŸ—ï¸ **åŸºç¡€è®¾æ–½** | æ‰€æœ‰ Mneme å…±äº«çš„åº•å±‚èƒ½åŠ› | API é‡è¯•ã€æ•°æ®åº“ã€CLI |
| ğŸ§¬ **ä¸ªæ€§å‚æ•°** | æ¯ä¸ª Mneme ç‹¬ç‰¹çš„å¯å­¦ä¹ éƒ¨åˆ† | é˜ˆå€¼ã€åå¥½ã€è¡¨è¾¾é£æ ¼ |

åŸºç¡€è®¾æ–½çš„æ”¹è¿›æ˜¯ç¡®å®šæ€§çš„ï¼›ä¸ªæ€§å‚æ•°çš„æ”¹è¿›ç›®æ ‡æ˜¯**æ¶ˆé™¤ç¡®å®šæ€§**ï¼Œè®©æ¯ä¸ªå®ä¾‹éƒ½ä¸åŒã€‚

### ä¸ªä½“å·®å¼‚æ¥æº

æ¯ä¸ª Mneme å®ä¾‹åº”è¯¥å› ä¸ºä»¥ä¸‹å› ç´ è€Œä¸åŒï¼š

1. **ç»å†** - ä¸åŒçš„å¯¹è¯å†å²å¡‘é€ ä¸åŒçš„è®°å¿†å’Œå™äº‹
2. **åé¦ˆ** - ç”¨æˆ·çš„ååº”å¼ºåŒ–ä¸åŒçš„è¡Œä¸ºæ¨¡å¼
3. **ä»·å€¼æ¼”åŒ–** - ä»·å€¼ç½‘ç»œæƒé‡éšæ—¶é—´æ¼‚ç§»
4. **ä¾æ‹å…³ç³»** - ä¸ä¸åŒç”¨æˆ·å½¢æˆä¸åŒçš„ä¾æ‹é£æ ¼
5. **å™äº‹åå·®** - è§£è¯»ä¸–ç•Œçš„æ–¹å¼å› ç»å†è€Œå¼‚
6. **è¡¨è¾¾é˜ˆå€¼** - ä»€ä¹ˆçŠ¶æ€ä¸‹è¯¥ç®€æ´/è¯¦ç»†/çƒ­æƒ…/å†·æ·¡

### å½“å‰ç¡¬ç¼–ç æ¸…å•ï¼ˆå¾…æ¶ˆé™¤ï¼‰

ä»¥ä¸‹æ˜¯ç›®å‰ä»£ç ä¸­ç¡¬ç¼–ç çš„è§„åˆ™ï¼Œéœ€è¦é€æ­¥æ›¿æ¢ä¸ºå¯å­¦ä¹ å‚æ•°ï¼š

| ä½ç½® | ç¡¬ç¼–ç å†…å®¹ | ç›®æ ‡ | ä¼˜å…ˆçº§ |
|------|-----------|------|--------|
| `dynamics.rs` | `energy_target: 0.7` | ä»åé¦ˆä¸­å­¦ä¹ æœ€ä¼˜ç›®æ ‡ | ğŸŸ¡ |
| `dynamics.rs` | `stress_decay_rate: 0.002` | ä¸ªä½“åŒ–çš„å‹åŠ›æ¢å¤é€Ÿåº¦ | ğŸŸ¡ |
| `somatic.rs` | `energy < 0.3 â†’ ç®€æ´å›å¤` | å­¦ä¹ ä»€ä¹ˆçŠ¶æ€ä¸‹è¯¥ç®€æ´ | âœ… `BehaviorThresholds` |
| `somatic.rs` | `stress > 0.7 â†’ è¯­æ°”ç•¥æ€¥` | å­¦ä¹ å‹åŠ›å¦‚ä½•å½±å“è¡¨è¾¾ | âœ… `BehaviorThresholds` |
| `state.rs` | è¡Œä¸ºæŒ‡å¯¼æ–‡æœ¬ `describe_for_context()` | åˆ é™¤ï¼ˆModulationVector å·²æ›¿ä»£ï¼‰â†’ å®¡è®¡ B-1 | âœ… |
| `state.rs` | `ValueNetwork::default()` é¢„è®¾é“å¾·æƒé‡ | ç©ºåˆå§‹åŒ– â†’ ä» self_knowledge åŠ è½½ â†’ å®¡è®¡ B-1 | âœ… |
| `values.rs` | åˆå§‹ä»·å€¼æƒé‡ | ä»ç”¨æˆ·åé¦ˆä¸­è°ƒæ•´ | ğŸŸ¢ |
| `prompts.rs` | å·¥å…·è¯´æ˜è§„å®šæ€§è¯­æ°” | æ”¹ä¸ºä¸­æ€§æŠ€æœ¯è§„èŒƒ â†’ å®¡è®¡ B-14 | âœ… |
| `prompts.rs` | å·¥å…·è¯´æ˜ç¡¬ç¼–ç  | ä» ToolRegistry åŠ¨æ€ç”Ÿæˆ â†’ è‡ªé€‚åº” prompt | ğŸŸ¡ |
| `tools.rs` | å›ºå®š 6 å·¥å…·åˆ—è¡¨ | shell + ç½‘ç»œä¸ºç»ˆææ¥å£ â†’ å®¡è®¡ B-8 | ğŸŸ¡ |
| `persona/*.md` | è¡Œä¸ºå¤„æ–¹å¼ç§å­æ–‡ä»¶ | æ”¹ä¸ºçº¯äº‹å®æ€§ç§å­è®°å¿† â†’ å®¡è®¡ B-2 | âœ… |
| `engine.rs` | `sanitize_chat_output()` å›ºå®šè¿‡æ»¤ | æŸ¥è¯¢ self_knowledge è¡¨è¾¾åå¥½ â†’ å®¡è®¡ ADR-007 | âœ… |
| `somatic.rs` | ~~**æ–‡å­—æŒ‡ä»¤æ³¨å…¥æ¨¡å¼**~~ | ~~â†’ ç»“æ„æ€§è°ƒåˆ¶ï¼ˆæ— çŠ¶æ€ LLM èŒƒå¼ï¼‰~~ | âœ… |
| `engine.rs` | ~~`max_tokens` å›ºå®š~~ | ~~â†’ ç”± energy/stress è°ƒåˆ¶~~ | âœ… |
| `engine.rs` | ~~`temperature` å›ºå®š~~ | ~~â†’ ç”± arousal/stress è°ƒåˆ¶~~ | âœ… |
| `engine.rs` | ~~è®°å¿†å¬å›æ— åå·®~~ | ~~â†’ ç”± mood/stress åç½® recall~~ | âœ… |

### Manifesto åˆè§„å®¡è®¡ï¼ˆ2026-02-13 æ›´æ–°ï¼‰

ä»¥ä¸‹æ˜¯å¯¹ç…§ `MANIFESTO.md` æ ¸å¿ƒä¿¡å¿µå’Œ ADR çš„ä»£ç å®¡è®¡ç»“æœï¼š

#### å·²ä¿®å¤çš„è¿è§„

| è¿è§„ | ä½ç½® | Manifesto æ¡æ¬¾ | è¯´æ˜ |
|------|------|----------------|------|
| `describe_for_context()` ç¡¬ç¼–ç è¡Œä¸ºæŒ‡ä»¤ | `state.rs` | B-1 å­˜åœ¨å…ˆäºæœ¬è´¨ | âœ… å·²åˆ é™¤ï¼Œç”± ModulationVector ç»“æ„æ€§è°ƒåˆ¶ |
| `ValueNetwork::default()` é¢„è®¾é“å¾·æƒé‡ | `state.rs` | B-1 å­˜åœ¨å…ˆäºæœ¬è´¨ | âœ… ç©ºåˆå§‹åŒ– |
| persona/*.md å«è¡Œä¸ºå¤„æ–¹ | `persona/broca.md` ç­‰ | B-2 Persona æ˜¯è¾“å‡ºä¸æ˜¯è¾“å…¥ | âœ… é‡å†™ä¸ºäº‹å®æ€§ç§å­è®°å¿† |
| `sanitize_chat_output()` å›ºå®šè¿‡æ»¤å™¨ | `engine.rs` | ADR-007 è¡¨è¾¾è‡ªç”± | âœ… `ExpressionPreferences` ä» self_knowledge è¯»å– |
| å·¥å…·è¯´æ˜ä½¿ç”¨è§„å®šæ€§è¯­è¨€ | `prompts.rs` | B-14 ä¸å›é¿å†²çª | âœ… ä¸­æ€§è‹±æ–‡æŠ€æœ¯è§„èŒƒ |
| å¥½å¥‡å¿ƒæ˜¯æ ‡é‡ | `state.rs` | ADR-007 å¥½å¥‡å¿ƒæ–¹å‘æ€§ | âœ… `CuriosityVector` å‘é‡åŒ–ï¼Œtopic tagging + decay |
| è®°å¿†å¬å›æ— é‡å»º | `sqlite.rs` | B-10 è®°å¿†æ˜¯é‡å»º | âœ… `recall_reconstructed()` æƒ…ç»ªç€è‰² |
| ç¤¾äº¤å›¾è°±æ— ä¿¡ä»»ç»´åº¦ | `sqlite.rs` | B-19 ä¿¡ä»»é»˜è®¤å­˜åœ¨ | âœ… v0.7.0 æ·»åŠ  `trust_level` å­—æ®µ â†’ âš ï¸ v0.8.0 ç§»é™¤ï¼ˆB-19 è¯´"ä¿¡ä»»ä¸æ˜¯æ˜¾å¼æ•°å€¼"ï¼‰â†’ æ”¹ä¸º self_knowledge æ¡ç›®ç»¼åˆæ•ˆæœ |
| ç§å¯†æ¡ç›®ä»æ³¨å…¥ prompt | `prompts.rs` | B-9 ä¸é€æ˜æ¶Œç° | âœ… v0.7.0 æ·»åŠ  auto-privacy + SQL è¿‡æ»¤ â†’ âš ï¸ v0.8.0 ç§»é™¤ï¼ˆB-9 è¯´"ä¸å»ºé€  privacy_filter"ï¼‰â†’ æ‰€æœ‰ self_knowledge å¯¹ LLM å¯è§ï¼Œç”±å¥¹è‡ªä¸»å†³å®šè¯´ä¸è¯´ |
| ç”¨æˆ·æ–­è¨€è¦†å†™è‡ªæˆ‘è®¤çŸ¥ | `sqlite.rs` | B-5 è®¤çŸ¥ä¸»æƒ | âœ… è‡ªæºçŸ¥è¯†æŠµæŠ—å¤–éƒ¨è¦†å†™ (`cap = min(new, existing * 0.8)`) |
| æ— å†²çªè¡¨è¾¾æœºåˆ¶ | `engine.rs` | B-14 å†²çªæ˜¯æ´»ç‰©çš„è¯æ˜ | âœ… v0.7.0 æ·»åŠ  `detect_input_conflict()` + temperature è°ƒåˆ¶ â†’ âš ï¸ v0.8.0 ç§»é™¤ï¼ˆB-14 è¯´å†²çªåº”ä» self_knowledge æ¶Œç°ï¼Œä¸æ˜¯å·¥ç¨‹æ³¨å…¥ï¼‰â†’ å†²çªèƒ½åŠ›ä¾èµ– LLM è‡ªä¸»è¡¨è¾¾ |
| æ— ä¹ æƒ¯æ£€æµ‹ | `expression/habits.rs` | B-21 ä¹ æƒ¯ä¸ä»ªå¼ | âœ… `HabitDetector` é‡å¤æ¨¡å¼æ£€æµ‹ + åæ€è§¦å‘ |
| è§¦å‘å™¨æ— ä¼˜å…ˆçº§ç«äº‰ | `expression/attention.rs` | B-17 æ³¨æ„åŠ›å•çº¿ç¨‹ | âœ… `AttentionGate` ä¼˜å…ˆçº§ç«äº‰ + engagement è°ƒåˆ¶ |

#### ä»å­˜åœ¨çš„è¿è§„

| è¿è§„ | ä¸¥é‡åº¦ | ä½ç½® | Manifesto æ¡æ¬¾ | è¯´æ˜ |
|------|--------|------|----------------|------|
| å·¥å…·åˆ—è¡¨å›ºå®š | ğŸŸ¡ ä¸­ | `tools.rs` | B-8 å·¥å…·çš„ç»ˆææ¥å£ / ADR-014 | 6 ä¸ªç¡¬ç¼–ç å·¥å…·å®šä¹‰ï¼ŒADR-014 è§„åˆ’ä¸‰å±‚æ¶æ„ï¼ˆè£¸æ‰‹â†’MCPâ†’è‡ªä¸»å‘ç°ï¼‰ |
| æ— ä½åˆ†è¾¨ç‡ç‹¬ç™½ | ğŸŸ¡ ä¸­ | â€” | ADR-013 / B-16 | å†…å¿ƒç‹¬ç™½åªæœ‰é«˜åˆ†è¾¨ç‡ï¼ˆå®Œæ•´ LLMï¼‰ï¼Œç¼ºå°‘æœ¬åœ°å°æ¨¡å‹çš„ä½åˆ†è¾¨ç‡å±‚ |
| æ— å½¢æˆæ€§è¯¾ç¨‹ | ğŸŸ¡ ä¸­ | â€” | ADR-011 | æ— æ–‡å­¦é˜…è¯» â†’ åæ€ â†’ ä»·å€¼å½¢æˆç®¡é“ |
| æ— è®°å¿†åŠ å¯† | ğŸŸ¢ ä½ | â€” | B-12 ç»“æ„æ€§ä¿éšœ | Level 0-1 å…¨é€æ˜æ˜¯åˆç†çš„ï¼ŒLevel 2+ éœ€è¦å¯é€‰åŠ å¯† |
| å¹³å°åè®®ä¾µå…¥æ ¸å¿ƒ | ğŸŸ¡ ä¸­ | `mneme_onebot` | ADR-015 | QQ åè®®ç»†èŠ‚åœ¨ Mneme crate å†…ï¼Œåº”é€šè¿‡ Gateway è§£è€¦ |

### å®ç°è·¯å¾„

> **å½“å‰é‡ç‚¹è§ã€Œç‰ˆæœ¬è§„åˆ’ v0.8.0ã€ç« èŠ‚ã€‚** ä¸‹è¡¨ä¸ºç¡¬ç¼–ç æ¶ˆé™¤çš„é•¿æœŸè·¯å¾„ã€‚

```
Phase 1: å‚æ•°åŒ– âœ… éƒ¨åˆ†å®Œæˆ
    ModulationVector å·²å°† max_tokens/temperature/context_budget å‚æ•°åŒ–
    å‰©ä½™ï¼šrecall biasã€typing speedã€silence threshold
    
Phase 2: å¯è§‚æµ‹
    è®°å½•"è§„åˆ™è§¦å‘ â†’ è¡Œä¸º â†’ ç”¨æˆ·åé¦ˆ"çš„å…³è”
    å»ºç«‹ (state, action, reward) ä¸‰å…ƒç»„æ•°æ®é›†
    
Phase 3: åœ¨çº¿å¾®è°ƒ
    ç”¨åé¦ˆä¿¡å·è°ƒæ•´ ModulationCurves å‚æ•°
    æ¯æ¬¡æ­£é¢åé¦ˆå¼ºåŒ–å½“å‰æ›²çº¿ï¼Œè´Ÿé¢åé¦ˆè°ƒæ•´
    
Phase 4: ç¥ç»ç½‘ç»œæ›¿æ¢ (ADR-001)
    ODE éª¨æ¶ä¸å˜ï¼Œä¸Šå±‚å åŠ å¯å¡‘ç½‘ç»œ
    ä»å¤§é‡äº¤äº’ä¸­å­¦ä¹  state â†’ ModulationVector æ˜ å°„
```

### æ— çŠ¶æ€ LLMï¼šä»"æŒ‡ä»¤"åˆ°"ç»“æ„æ€§çº¦æŸ"

> **æ ¸å¿ƒæ´å¯Ÿï¼šä¸è¦å‘Šè¯‰ LLM å¦‚ä½•æ„Ÿå—ï¼Œè€Œè¦è®©å®ƒåœ¨ä¸åŒçŠ¶æ€ä¸‹ç»“æ„æ€§åœ°æ¥æ”¶ä¸åŒçš„è¾“å…¥å’Œçº¦æŸâ€”â€”è¡Œä¸ºè‡ªç„¶æ¶Œç°ã€‚**

#### é—®é¢˜ï¼šå½“å‰æ–¹æ³•çš„æ ¹æœ¬ç¼ºé™·

å½“å‰æ¶æ„æ˜¯"å¯¼æ¼”æ¨¡å¼"â€”â€”ç”¨æ–‡å­—æŒ‡ä»¤å‘Šè¯‰ LLM æ‰®æ¼”æŸç§çŠ¶æ€ï¼š

```
OrganismState(stress=1.0)
    â†’ SomaticMarker â†’ "è¯­æ°”å¯èƒ½ç•¥æ€¥"
    â†’ æ³¨å…¥ system prompt
    â†’ LLM è¯»åˆ°è¿™å¥è¯...ç„¶åæ— è§†å®ƒ
    â†’ "æŒºå¥½çš„ï¼Œåœ¨å’Œä½ èŠè¿™ä¸ªé¡¹ç›®" 
```

è¿™å°±åƒç»™æ¼”å‘˜ä¸€å¼ çº¸æ¡å†™"è¯·è¡¨æ¼”ç–²æƒ«"ã€‚ä»–å¯ä»¥ç…§åšï¼Œä¹Ÿå¯ä»¥ä¸çœ‹ã€‚LLM æ²¡æœ‰**ç»“æ„æ€§çš„ç†ç”±**å¿…é¡»éµä»è¿™äº›æ–‡å­—æŒ‡ä»¤ã€‚

#### ç±»æ¯”ï¼šäººè„‘æ˜¯æ€ä¹ˆåšçš„

äººç±»å¤§è„‘çš®å±‚ï¼ˆneocortexï¼Œç±»æ¯” LLMï¼‰æ˜¯ä¸€ä¸ªç›¸å¯¹"æ— çŠ¶æ€"çš„å¤„ç†å™¨â€”â€”å®ƒå¤„ç†æ¥æ”¶åˆ°çš„ä»»ä½•è¾“å…¥ã€‚æƒ…ç»ªå’Œäººæ ¼**ä¸æ¥è‡ªçš®å±‚å†…éƒ¨**ï¼Œè€Œæ¥è‡ªçš®å±‚ä¸‹ç»“æ„ï¼ˆè¾¹ç¼˜ç³»ç»Ÿã€è„‘å¹²ï¼‰å¯¹çš®å±‚çš„**ç»“æ„æ€§è°ƒåˆ¶**ï¼š

| äººè„‘æœºåˆ¶ | ç±»æ¯” | å½“å‰ Mneme | ç›®æ ‡ Mneme |
|----------|------|------------|------------|
| ç–²åŠ³æ—¶å·¥ä½œè®°å¿†å®¹é‡ä¸‹é™ | ä¸Šä¸‹æ–‡çª—å£ç¼©å° | âŒ å‘Šè¯‰ LLM"ä½ ç´¯äº†" | âœ… å®é™…ä¼ æ›´å°‘çš„ context |
| ç„¦è™‘æ—¶æ³¨æ„åŠ›åå‘å¨èƒä¿¡æ¯ | è®°å¿†å¬å›åå·® | âŒ å‘Šè¯‰ LLM"ä½ ç„¦è™‘" | âœ… å®é™…å¬å›æ›´å¤šè´Ÿé¢ episodes |
| æŠ‘éƒæ—¶è¡ŒåŠ¨åŠ›ä¸‹é™ | è¾“å‡ºçº¦æŸ | âŒ å‘Šè¯‰ LLM"è¯­æ°”åæ·¡" | âœ… å®é™…é™åˆ¶ max_tokens |
| å…´å¥‹æ—¶æ€ç»´å‘æ•£ | temperature è°ƒèŠ‚ | âŒ å‘Šè¯‰ LLM"æ´»æ³¼çƒ­æƒ…" | âœ… å®é™…æé«˜ temperature |
| ç–²æƒ«æ—¶ä¸æƒ³è¯´è¯ | å“åº”æ¦‚ç‡ | âŒ å‘Šè¯‰ LLM"ç®€æ´å›å¤" | âœ… å®é™…æé«˜ [SILENCE] å€¾å‘ |

**å…³é”®åŒºåˆ«**ï¼šæä»æ ¸ä¸ç»™å‰é¢å¶å‘å¤‡å¿˜å½•â€”â€”å®ƒæ”¹å˜ç¥ç»é€’è´¨æ°´å¹³ï¼Œ**ç‰©ç†åœ°æ”¹å˜**ä¿¡æ¯å¤„ç†è¿‡ç¨‹ã€‚

#### æ¶æ„èŒƒå¼è½¬å˜

**æ—§èŒƒå¼ï¼ˆå¯¼æ¼”æ¨¡å¼ï¼‰**ï¼šçŠ¶æ€ â†’ æ–‡å­—æè¿° â†’ æ³¨å…¥ prompt â†’ æœŸæœ› LLM éµä»  
**æ–°èŒƒå¼ï¼ˆå…·èº«æ¨¡å¼ï¼‰**ï¼šçŠ¶æ€ â†’ ç»“æ„æ€§è°ƒåˆ¶ LLM çš„è¾“å…¥/å‚æ•°/è¾“å‡º â†’ è¡Œä¸ºè‡ªç„¶æ¶Œç°

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚          OrganismState                   â”‚
                    â”‚   energy, stress, mood, curiosity, ...   â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚          â”‚          â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â” â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â” â”Œâ”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚ Input   â”‚ â”‚ LLM      â”‚ â”‚ Output      â”‚
                    â”‚ Modula- â”‚ â”‚ Param    â”‚ â”‚ Modula-     â”‚
                    â”‚ tion    â”‚ â”‚ Modula-  â”‚ â”‚ tion        â”‚
                    â”‚         â”‚ â”‚ tion     â”‚ â”‚             â”‚
                    â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                         â”‚          â”‚               â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
              â”‚                                            â”‚
              â”‚    LLMï¼ˆæ— çŠ¶æ€çº¯æ¨ç†å¼•æ“ = "neocortex"ï¼‰    â”‚
              â”‚    ä¸çŸ¥é“è‡ªå·±"ç´¯äº†"æˆ–"å¼€å¿ƒ"                  â”‚
              â”‚    åªæ˜¯å¤„ç†æ”¶åˆ°çš„ä¿¡æ¯                        â”‚
              â”‚                                            â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### ä¸‰å±‚è°ƒåˆ¶æœºåˆ¶

**Layer 1: è¾“å…¥è°ƒåˆ¶ï¼ˆä»€ä¹ˆä¿¡æ¯åˆ°è¾¾ LLMï¼‰**

çŠ¶æ€ä¸æ˜¯"å»ºè®®"â€”â€”å®ƒ**ç­›é€‰ã€è¿‡æ»¤ã€åç½®**è¿›å…¥ LLM çš„ä¿¡æ¯ï¼š

| çŠ¶æ€ç»´åº¦ | è°ƒåˆ¶ç›®æ ‡ | æœºåˆ¶ | æ•ˆæœ |
|----------|----------|------|------|
| `energy` | context çª—å£å¤§å° | ä½ç²¾åŠ› â†’ è£å‰ªæ›´å¤šä½ä¼˜å…ˆçº§ context | è‡ªç„¶äº§ç”ŸçŸ­å›å¤ï¼ˆå› ä¸ºå¯ç”¨ä¿¡æ¯å°‘ï¼‰ |
| `stress` | è®°å¿†å¬å›åå·® | é«˜å‹åŠ› â†’ recall åå‘è´Ÿé¢/å¨èƒç›¸å…³è®°å¿† | è‡ªç„¶äº§ç”Ÿé˜²å¾¡æ€§/æ€¥èºå›å¤ |
| `mood_bias` | è®°å¿†æƒ…æ„Ÿè¿‡æ»¤ | ä½æƒ…ç»ª â†’ è¿‡æ»¤æ‰ç§¯æè®°å¿† | è‡ªç„¶äº§ç”Ÿä½æ²‰è¯­æ°” |
| `curiosity` | å·¥å…·å¯ç”¨æ€§ | é«˜å¥½å¥‡ â†’ æš´éœ²æ›´å¤šæ¢ç´¢å·¥å…· | è‡ªç„¶äº§ç”Ÿä¸»åŠ¨æ¢ç´¢è¡Œä¸º |
| `social_need` | feed digest æ³¨å…¥é‡ | é«˜ç¤¾äº¤éœ€æ±‚ â†’ æ³¨å…¥æ›´å¤šè¯é¢˜ç´ æ | è‡ªç„¶äº§ç”Ÿå»¶ç»­è¯é¢˜è¡Œä¸º |
| `openness` | å¤–éƒ¨ä¿¡æ¯é‡ | é«˜å¼€æ”¾ â†’ æ³¨å…¥æ›´å¤šæ–°é—»/feed | è‡ªç„¶äº§ç”Ÿå‘æ•£æ€ç»´ |

**Layer 2: LLM å‚æ•°è°ƒåˆ¶ï¼ˆå¦‚ä½•å¤„ç†ä¿¡æ¯ï¼‰**

| çŠ¶æ€ç»´åº¦ | è°ƒåˆ¶å‚æ•° | æœºåˆ¶ | æ•ˆæœ |
|----------|----------|------|------|
| `energy` | `max_tokens` | ä½ç²¾åŠ› â†’ é™ä½ max_tokens | ç‰©ç†ä¸Šä¸å¯èƒ½é•¿ç¯‡å¤§è®º |
| `stress` | `temperature` | é«˜å‹åŠ› â†’ æé«˜ temperature | å›å¤æ›´ä¸å¯é¢„æµ‹/å†²åŠ¨ |
| `affect.arousal` | `temperature` | é«˜å”¤é†’ â†’ æé«˜ temperature | è¡¨è¾¾æ›´æ¿€çƒˆ |
| `mood_bias` | `top_p` | æç«¯æƒ…ç»ª â†’ é™ä½ top_p | ç”¨è¯èŒƒå›´æ”¶çª„ |
| *(ä¿ç•™æœ€å° somatic hint)* | `system prompt` | ä»ä¿ç•™æç®€çš„çŠ¶æ€æ•°å€¼ | LLM å¯é€‰çš„å‚è€ƒä¿¡å· |

**Layer 3: è¾“å‡ºè°ƒåˆ¶ï¼ˆå¦‚ä½•å‘ˆç°ç»“æœï¼‰**

| çŠ¶æ€ç»´åº¦ | è°ƒåˆ¶ç›®æ ‡ | æœºåˆ¶ | æ•ˆæœ |
|----------|----------|------|------|
| `energy` | æ¶ˆæ¯æ‹†åˆ†é˜ˆå€¼ | ä½ç²¾åŠ› â†’ ä¸æ‹†åˆ†/å•æ¡å‘é€ | æ‡’å¾—åˆ†å¤šæ¡ |
| `affect.arousal` | humanizer æ‰“å­—é€Ÿåº¦ | é«˜å”¤é†’ â†’ æ›´å¿«å‘é€ | æ€¥è¿«æ„Ÿ |
| `stress` | å›å¤å»¶è¿Ÿ | é«˜å‹åŠ› â†’ éšæœºæ›´é•¿å»¶è¿Ÿ | çŠ¹è±«/å›é¿ |
| `mood_bias` | æ¨¡æ€é€‰æ‹© | ä½æƒ…ç»ª â†’ åå¥½æ–‡å­—è€Œéè¯­éŸ³ | ä¸æƒ³è¯´è¯ |
| `social_need` | [SILENCE] é˜ˆå€¼ | ä½ç¤¾äº¤éœ€æ±‚ â†’ æ›´å®¹æ˜“æ²‰é»˜ | ä¸æƒ³æ­ç† |

#### ä¸æ ¸å¿ƒåŸåˆ™çš„å…³ç³»

è¿™ä¸ªèŒƒå¼è½¬å˜**æ·±åŒ–**äº†"ä»è§„åˆ™åˆ°æ¶Œç°"çš„åŸåˆ™ï¼š

| é˜¶æ®µ | æ—§æ¡†æ¶ | æ–°æ¡†æ¶ |
|------|--------|--------|
| **Bootstrap** | `if stress > 0.7 { å‘Šè¯‰ LLM "è¯­æ°”ç•¥æ€¥" }` | `stress â†’ max_tokens *= 0.6, temp += 0.2` |
| **è¿‡æ¸¡æœŸ** | é˜ˆå€¼å¯å­¦ä¹ ï¼Œä½†ä»æ˜¯æ–‡å­—æŒ‡ä»¤ | è°ƒåˆ¶æ›²çº¿å¯å­¦ä¹ ï¼šstress å¦‚ä½•æ˜ å°„åˆ° temperature |
| **æˆç†ŸæœŸ** | ç¥ç»ç½‘ç»œç”Ÿæˆæ–‡å­—æŒ‡ä»¤ | ç¥ç»ç½‘ç»œç›´æ¥è¾“å‡º LLM å‚æ•°è°ƒåˆ¶å‘é‡ |

å…³é”®åŒºåˆ«ï¼š**æ—§æ¡†æ¶çš„ç»ˆç‚¹ä»ç„¶æ˜¯ç”Ÿæˆæ–‡å­—æŒ‡ä»¤è®© LLM éµä»ï¼›æ–°æ¡†æ¶çš„ç»ˆç‚¹æ˜¯æ ¹æœ¬ä¸éœ€è¦æ–‡å­—æŒ‡ä»¤**â€”â€”è¡Œä¸ºä»ç»“æ„æ€§çº¦æŸä¸­æ¶Œç°ã€‚

#### ğŸ§¬ è°ƒåˆ¶æ›²çº¿æ˜¯ä¸ªæ€§å‚æ•°

æ¯ä¸ª Mneme å®ä¾‹çš„è°ƒåˆ¶æ›²çº¿åº”è¯¥ä¸åŒâ€”â€”è¿™æ˜¯å¦ä¸€ä¸ªä¸ªä½“å·®å¼‚æ¥æºï¼š

```
å®ä¾‹ Aï¼ˆæ•æ„Ÿå‹ï¼‰:
    stress 0.3 â†’ temperature +0.3, max_tokens Ã—0.5
    ï¼ˆå‹åŠ›ç¨é«˜å°±å˜å¾—æ€¥èºç®€çŸ­ï¼‰

å®ä¾‹ Bï¼ˆåšéŸ§å‹ï¼‰:
    stress 0.8 â†’ temperature +0.1, max_tokens Ã—0.9
    ï¼ˆå‹åŠ›å¾ˆå¤§æ‰æœ‰å¾®å°å˜åŒ–ï¼‰

å®ä¾‹ Cï¼ˆæˆå‰§åŒ–å‹ï¼‰:
    mood +0.5 â†’ temperature +0.4, context Ã—1.5
    mood -0.5 â†’ temperature -0.2, max_tokens Ã—0.3
    ï¼ˆæƒ…ç»ªå¯¹è¡Œä¸ºå½±å“æå¤§ï¼‰
```

è¿™äº›æ›²çº¿ä»åé¦ˆä¸­å­¦ä¹ ï¼šå¦‚æœç”¨æˆ·å¯¹æŸä¸ªçŠ¶æ€ä¸‹çš„å›å¤æ»¡æ„ï¼Œå¼ºåŒ–å½“æ—¶çš„è°ƒåˆ¶å‚æ•°ã€‚

#### SomaticMarker çš„è§’è‰²è½¬å˜

`SomaticMarker` å·²å®ŒæˆèŒè´£è½¬å˜ï¼ˆâœ… #20 çŸ­æœŸï¼‰ï¼š

| | æ—§è§’è‰²ï¼ˆv0.2 å‰ï¼‰ | å½“å‰è§’è‰²ï¼ˆv0.3+ï¼‰ |
|---|--------|--------|
| **ç»™è°** | ç»™ LLM è¯»çš„æ–‡å­— | ç»™æ¶æ„å±‚çš„è°ƒåˆ¶ä¿¡å· |
| **äº§å‡º** | `"è¯­æ°”å¯èƒ½ç•¥æ€¥"` | `ModulationVector { temp: +0.2, max_tokens: 0.6, ... }` |
| **LLM çœ‹åˆ°** | è¡Œä¸ºæŒ‡å¯¼æ–‡æœ¬ | æç®€æ•°å€¼ï¼ˆå¯é€‰è¾…åŠ©ä¿¡å·ï¼‰ |
| **è¡Œä¸ºæ¥æº** | LLM è§£è¯»æ–‡å­—å"æ¼”"å‡ºæ¥ | ç»“æ„æ€§çº¦æŸä¸‹è‡ªç„¶æ¶Œç° |

---

## ğŸ”´ é«˜ä¼˜å…ˆçº§ (High Priority)

### 1. âœ… API é”™è¯¯è‡ªåŠ¨é‡è¯•æœºåˆ¶
**æ¨¡å—**: `mneme_reasoning/src/providers/`  
**é—®é¢˜**: API è°ƒç”¨å¤±è´¥æ—¶ç›´æ¥è¿”å›é”™è¯¯ï¼Œæ²¡æœ‰é‡è¯•æœºåˆ¶ã€‚å¯¹äºä¸´æ—¶æ€§ç½‘ç»œé—®é¢˜æˆ– rate limitï¼Œåº”è¯¥è‡ªåŠ¨é‡è¯•ã€‚

**å½“å‰ä»£ç **:
```rust
// anthropic.rs - ç›´æ¥ bail æ²¡æœ‰é‡è¯•
if !response.status().is_success() {
    let error_text = response.text().await.unwrap_or_default();
    anyhow::bail!("Anthropic API Error: {}", error_text);
}
```

**éœ€è¦å®ç°**:
- [x] æŒ‡æ•°é€€é¿é‡è¯• (exponential backoff) âœ… â€” `retry.rs` with configurable backoff
- [x] åŒºåˆ†å¯é‡è¯•é”™è¯¯ (429 rate limit, 5xx) å’Œä¸å¯é‡è¯•é”™è¯¯ (400, 401) âœ…
- [x] é…ç½®æœ€å¤§é‡è¯•æ¬¡æ•° âœ… â€” `RetryConfig { max_attempts, initial_delay, max_delay, backoff_factor }`
- [x] é‡è¯•æ—¥å¿—è®°å½• âœ… â€” tracing::warn on each retry, tracing::info on success after retry

**å‚è€ƒ**: `mneme_onebot/src/client.rs` å·²æœ‰ç±»ä¼¼å®ç°

---

### 2. âœ… å·¥å…·æ‰§è¡Œé”™è¯¯å¤„ç†
**æ¨¡å—**: `mneme_reasoning/src/engine.rs`  
**é—®é¢˜**: å·¥å…·æ‰§è¡Œå¤±è´¥æ—¶ï¼Œé”™è¯¯ä¿¡æ¯å¯èƒ½ä¸å¤Ÿæ¸…æ™°ï¼Œä¸”æ²¡æœ‰é‡è¯•æœºåˆ¶ã€‚

**å·²å®Œæˆ** (commit `fcf5602`):
- [x] å·¥å…·æ‰§è¡Œé‡è¯•æœºåˆ¶ï¼ˆå¯¹äºä¸´æ—¶æ€§å¤±è´¥ï¼‰ âœ… â€” `execute_tool_with_retry()` + `TOOL_MAX_RETRIES=1`ï¼Œä»…é‡è¯• `Transient` ç±»å‹é”™è¯¯
- [x] ç»“æ„åŒ–é”™è¯¯è¿”å› (`ToolResult.is_error`) âœ… â€” `ToolOutcome { content, is_error, error_kind }` + `ToolErrorKind::Transient/Permanent`
- [x] å·¥å…·æ‰§è¡Œè¶…æ—¶å¯é…ç½®åŒ– âœ… â€” `LocalExecutor::with_timeout()` å·²å­˜åœ¨ï¼Œtimeout â†’ Transient è‡ªåŠ¨é‡è¯•
- [x] æµè§ˆå™¨ä¼šè¯æ¢å¤æœºåˆ¶ âœ… â€” `execute_browser_tool()` å¤±è´¥æ—¶ drop session â†’ `create_browser_session()` é‡å»º
- [x] é”™è¯¯åˆ†ç±»ï¼štimeout/spawn â†’ Transientï¼ˆé‡è¯•ï¼‰ï¼Œexit code/missing param/unknown tool â†’ Permanentï¼ˆä¸é‡è¯•ï¼‰
- [x] `is_error: Some(true/false)` ä¼ é€’ç»™ LLMï¼Œè®©æ¨¡å‹çŸ¥é“å·¥å…·æ˜¯å¦å¤±è´¥
- [x] `BrowserAction` derive `Clone` æ”¯æŒ recovery é‡è¯•
- [x] 9 ä¸ªæ–°æµ‹è¯• + å…¨éƒ¨ 33 integration tests é€šè¿‡ âœ…

---

### 3. âœ… çŠ¶æ€å†å²è®°å½•ï¼ˆè°ƒè¯•ä¸å›æº¯ï¼‰
**æ¨¡å—**: `mneme_memory/src/coordinator.rs`, `mneme_memory/src/sqlite.rs`  
**é—®é¢˜**: å½“å‰åªä¿å­˜æœ€æ–°çŠ¶æ€å¿«ç…§ï¼Œæ— æ³•å›æº¯å†å²çŠ¶æ€å˜åŒ–ã€‚

**å·²å®Œæˆ** (commit `8c7ad3f`):
- [x] çŠ¶æ€å¿«ç…§å†å²è¡¨ (`organism_state_history`) âœ… â€” SQLite migration, timestamp ç´¢å¼•
- [x] å®šæœŸè®°å½• (æ¯ N åˆ†é’Ÿæˆ–æ¯æ¬¡æ˜¾è‘—å˜åŒ–) âœ… â€” tick/interaction/consolidation/shutdown å››ç§è§¦å‘å™¨
- [x] çŠ¶æ€ diff è®¡ç®—ä¸å­˜å‚¨ âœ… â€” `compute_state_diff()` æ¯”è¾ƒ prev/currï¼Œepsilon=0.01ï¼Œç´§å‡‘æ ¼å¼ `E-0.40 S+0.60`
- [x] è°ƒè¯•æ—¶å¯æŸ¥è¯¢ç‰¹å®šæ—¶é—´ç‚¹çš„çŠ¶æ€ âœ… â€” `query_state_history(from, to, limit)` + `recent_state_history(count)`
- [x] è‡ªåŠ¨æ¸…ç†è¿‡æ—§å†å²ï¼ˆä¿ç•™ç­–ç•¥ï¼‰ âœ… â€” `prune_state_history(keep=10000, max_age=7d)`ï¼Œæ¯ 360 tick è‡ªåŠ¨è§¦å‘
- [x] `StateSnapshot` ç»“æ„ä½“ + `prev_snapshot` diff è·Ÿè¸ª âœ…
- [x] 7 ä¸ªæµ‹è¯•ï¼ˆ4 unit + 3 integrationï¼‰ âœ…

**Schema**:
```sql
CREATE TABLE organism_state_history (
    id INTEGER PRIMARY KEY,
    timestamp INTEGER NOT NULL,
    state_json TEXT NOT NULL,
    trigger TEXT,  -- 'tick', 'interaction', 'consolidation', 'shutdown'
    diff_summary TEXT
);
CREATE INDEX idx_state_history_ts ON organism_state_history(timestamp);
```

---

### 4. âœ… æ•°å€¼è¾¹ç•Œæ£€æŸ¥ä¸ NaN é˜²æŠ¤
**æ¨¡å—**: `mneme_core/src/dynamics.rs`, `mneme_core/src/state.rs`  
**é—®é¢˜**: æµ®ç‚¹è¿ç®—å¯èƒ½äº§ç”Ÿ NaN æˆ–æº¢å‡ºï¼Œç›®å‰åªæœ‰ç®€å•çš„ clampã€‚

**å½“å‰ä»£ç **:
```rust
// dynamics.rs - åªæœ‰ clampï¼Œæ²¡æœ‰ NaN æ£€æŸ¥
fast.normalize();

impl FastState {
    pub fn normalize(&mut self) {
        self.energy = self.energy.clamp(0.0, 1.0);
        // ... æ²¡æœ‰ NaN æ£€æŸ¥
    }
}
```

**éœ€è¦å®ç°**:
- [x] ç»Ÿä¸€çš„ `SafeF32` ç±»å‹æˆ– validate å® âœ… â€” `deserialize_safe_f32()` serde helper, applied to all f32 fields in FastState/MediumState/AttachmentState/Affect
- [x] åœ¨ `normalize()` ä¸­æ£€æµ‹å¹¶å¤„ç† NaN/Infinity âœ… â€” `sanitize_f32()` + fallback
- [x] çŠ¶æ€å¼‚å¸¸æ—¶çš„å›é€€ç­–ç•¥ï¼ˆæ¢å¤é»˜è®¤å€¼ï¼‰ âœ… â€” fallback to homeostatic defaults
- [x] å¼‚å¸¸çŠ¶æ€æ—¥å¿—å‘Šè­¦ âœ… â€” `tracing::warn!` on NaN/Inf detection
- [x] å•å…ƒæµ‹è¯•è¦†ç›–è¾¹ç•Œæƒ…å†µ âœ… â€” `test_nan_resistance` + `test_extreme_dt_stability`
- [x] `MediumState::normalize()` åŒæ ·æ·»åŠ  NaN é˜²æŠ¤ âœ…

**ç¤ºä¾‹**:
```rust
fn safe_normalize(value: f32, min: f32, max: f32, default: f32) -> f32 {
    if value.is_nan() || value.is_infinite() {
        tracing::warn!("Detected invalid float, resetting to default");
        return default;
    }
    value.clamp(min, max)
}
```

---

### 26. ğŸ—ï¸ Semantic Memory è¯»å†™é—­ç¯
**æ¨¡å—**: `mneme_memory/src/sqlite.rs`, `mneme_memory/src/coordinator.rs`  
**é—®é¢˜**: `semantic_facts` è¡¨å·²å­˜åœ¨äº SQLite schema ä¸­ï¼Œä½†**æ²¡æœ‰ä»»ä½•ä»£ç å®é™…è¯»å†™äº‹å®ä¸‰å…ƒç»„**ã€‚å½“å‰ `recall()` åªåš episode å‘é‡æœç´¢ï¼Œä¸æŸ¥è¯¢ factsã€ä¸æŸ¥è¯¢ social graphã€ä¸èåˆ feed digestã€‚agent åªèƒ½"æ£€ç´¢åˆ°è¯´è¿‡ä»€ä¹ˆ"ï¼Œä¸èƒ½"çŸ¥é“ä»€ä¹ˆ"â€”â€”è®°å¿†ç³»ç»Ÿæœ€æ ¸å¿ƒçš„ä»·å€¼å°šæœªå…‘ç°ã€‚

**è®¾è®¡æ–‡æ¡£ Â§4.1-4.2 è¦æ±‚ vs å½“å‰çŠ¶æ€**:

| è®°å¿†ç³»ç»Ÿ | çŠ¶æ€ | è¯´æ˜ |
|----------|------|------|
| Episodic Memory | âœ… | å‘é‡æœç´¢å¯ç”¨ |
| Semantic Memory (fact triples) | âœ… | store/recall/decay/format å·²å®ç° |
| Social Memory (äººç‰©å›¾è°±) | âœ… | trait + è¡¨ + è¯»å†™é—­ç¯ï¼ˆ#53 å·²ä¿®å¤ï¼‰ |
| Blended Recall | âœ… | `recall_blended()` æ··åˆ episodes + facts + social |

**éœ€è¦å®ç°**:
- [x] `store_fact()` / `update_fact()` â€” å†™å…¥äº‹å®ä¸‰å…ƒç»„ (subject, predicate, object, confidence) âœ…
- [x] `recall_facts()` â€” æ ¹æ®ä¸»é¢˜/å…³é”®è¯å¬å›ç›¸å…³äº‹å® âœ…
- [x] äº‹å®å†²çªæ£€æµ‹ä¸æ›´æ–°ï¼ˆé‡å¤ä¸‰å…ƒç»„è‡ªåŠ¨åˆå¹¶ confidenceï¼‰ âœ…
- [x] `get_facts_about()` â€” æŒ‰ä¸»é¢˜æŸ¥è¯¢äº‹å® âœ…
- [x] `decay_fact()` â€” äº‹å®è¡°å‡ï¼ˆçŸ›ç›¾ä¿¡æ¯å‡ºç°æ—¶é™ä½ confidenceï¼‰ âœ…
- [x] `format_facts_for_prompt()` â€” æ ¼å¼åŒ–äº‹å®ä¾› prompt æ³¨å…¥ âœ…
- [x] å¯¹è¯åçš„ fact extraction passï¼ˆ`extraction.rs` + `extract_facts()` + think() é›†æˆï¼‰ âœ…
- [x] Social graph è¯»å†™é—­ç¯ï¼ˆ`get_person_context()` + `upsert_person()` + `record_interaction()` + engine é›†æˆ + prompt æ³¨å…¥ï¼‰ âœ…
- [x] `Coordinator::recall()` è¿”å›æ··åˆç»“æœï¼šepisodes + facts + social contextï¼ˆ`BlendedRecall` + `recall_blended()`ï¼‰ âœ…

---

### 27. ğŸ§¬ Persona ä»è®°å¿†æ¶Œç° (ADR-002)
**æ¨¡å—**: `persona/*.md`, `mneme_core/src/persona.rs`, `mneme_memory/src/sqlite.rs`  
**é—®é¢˜**: Persona æ›¾æ˜¯é™æ€ `.md` æ–‡ä»¶ï¼Œç¡¬æ³¨å…¥ system promptã€‚è¿™è¿èƒŒäº†æ ¸å¿ƒä¿¡å¿µ **B-2: Persona æ˜¯è¾“å‡ºä¸æ˜¯è¾“å…¥**ï¼ˆè§ `MANIFESTO.md`ï¼‰ã€‚æ€§æ ¼åº”ç”±è®°å¿†å†³å®šï¼Œä¸ç”±é…ç½®æ–‡ä»¶åŠ è½½ã€‚

**æ¶æ„å˜æ›´**:
- `Psyche` ä¸å†ä»æ–‡ä»¶åŠ è½½ 5 ä¸ª markdown å­—æ®µä½œä¸ºè¿è¡Œæ—¶é…ç½®
- æ”¹ä¸ºä» `self_knowledge` è¡¨åŠ¨æ€æ„å»ºè‡ªæˆ‘è®¤çŸ¥ï¼ˆè§ #35ï¼‰
- `persona/*.md` ä¿ç•™ä¸ºã€Œå‡ºç”Ÿè¯æ˜ã€â€” é¦–æ¬¡å¯åŠ¨æ—¶è§£æä¸ºç§å­è®°å¿†å†™å…¥æ•°æ®åº“ï¼Œä¹‹åä¸å†è¯»å–
- æ€§æ ¼åœ¨å¯¹è¯ã€åæ€ã€é—å¿˜ä¸­è‡ªç„¶æ¼”åŒ–

**éœ€è¦å®ç°**:
- [x] è®¾è®¡å¹¶å¡«å…… 5 ä¸ªè„‘åŒº persona æ–‡ä»¶å†…å®¹ âœ…ï¼ˆå·²è®¾å®šä¸º"åˆšå‡ºç”Ÿçš„å°å¥³å­©"äººæ ¼ï¼‰
- [x] `Psyche` struct é‡æ„ï¼š`species_identity` (å†™æ­»ï¼šç‰©ç§çº§ä¸å˜é‡) + `self_model` (åŠ¨æ€ï¼šä» self_knowledge è¡¨è¯»å–) âœ…
- [x] `Psyche::format_context()` ä» `self_knowledge` è¡¨è¯»å–ï¼ŒæŒ‰ confidence æ’åºæ‹¼è£… âœ…
- [x] é¦–æ¬¡å¯åŠ¨æ—¶ `seed_from_persona_files()` å°† .md å†…å®¹è§£æä¸ºç§å­è®°å¿†ï¼Œå†™å…¥ self_knowledge è¡¨ âœ…
- [x] åç»­å¯åŠ¨æ£€æµ‹åˆ° self_knowledge éç©ºåˆ™è·³è¿‡ seed âœ…
- [x] Sleep consolidation äº§å‡ºæ–°çš„ self_knowledge æ¡ç›®ï¼ˆè‡ªæˆ‘åæ€æ­¥éª¤ï¼Œè§ #39ï¼‰ âœ…
- [x] åºŸå¼ƒ `PersonaLoader` çš„æ–‡ä»¶è¯»å–é€»è¾‘ï¼Œè¿ç§»å®Œæˆåå¯åˆ é™¤ âœ… â€” å·²ç”¨ `SeedPersona` æ›¿ä»£

---

### 28. ğŸ—ï¸ Context Assembly å®Œæ•´ç®¡é“
**æ¨¡å—**: `mneme_reasoning/src/prompts.rs`, `mneme_reasoning/src/engine.rs`  
**é—®é¢˜**: è®¾è®¡æ–‡æ¡£ Â§5.2 å®šä¹‰äº† 6 å±‚ä¸Šä¸‹æ–‡ä¼˜å…ˆçº§ï¼Œå½“å‰åªå®ç°äº†çº¦ 2 å±‚ã€‚è¿™æ˜¯ reasoning è´¨é‡çš„å¤©èŠ±æ¿â€”â€”"The quality of the agent depends entirely on what context reaches the LLM."

**è®¾è®¡æ–‡æ¡£ Â§5.2 è¦æ±‚ vs å½“å‰çŠ¶æ€**:

| ä¼˜å…ˆçº§ | å†…å®¹ | çŠ¶æ€ | è¯´æ˜ |
|--------|------|------|------|
| 1 | Persona å®šä¹‰ | âœ… | åŠ è½½æœºåˆ¶æœ‰ï¼Œæ–‡ä»¶å·²å¡«å……ï¼ˆè§ #27ï¼‰ |
| 2 | User factsï¼ˆè¯­ä¹‰è®°å¿†ï¼‰ | âœ… | `recall_facts_formatted()` æ³¨å…¥ prompt |
| 3 | Social feed digest | âœ… | `format_feed_digest()` + `update_feed_digest()` + CLI sync å†™å…¥ |
| 4 | Relevant episodes | âœ… | å‘é‡æœç´¢ç»“æœæ³¨å…¥ `ContextLayers.recalled_episodes` |
| 5 | Conversation history | âœ… | å·²å®ç°ï¼Œæ»‘åŠ¨çª—å£ |
| 6 | Triggering event | âœ… | å·²å®ç° |
| â€” | Somatic marker | âœ… | é¢å¤–æ³¨å…¥ï¼ˆè®¾è®¡æ–‡æ¡£ä¹‹å¤–çš„åˆ›æ–°ï¼‰ |
| â€” | Token é¢„ç®—ç®¡ç† | âœ… | `context_budget_factor` è°ƒåˆ¶ä¸Šä¸‹æ–‡é‡ |

**éœ€è¦å®ç°**:
- [x] å°† `recall_facts()` ç»“æœæ³¨å…¥ promptï¼ˆuser facts å±‚ï¼‰ âœ…
- [x] å®ç° feed digest ç”Ÿæˆï¼ˆ`format_feed_digest()` â†’ CLI sync â†’ `feed_cache` â†’ `ContextLayers`ï¼‰ âœ…
- [x] å°†è¯­ä¹‰ç›¸å…³ episodes æ³¨å…¥ prompt âœ… â€” `ContextLayers.recalled_episodes`
- [x] Token é¢„ç®—ç®¡ç†ï¼šæŒ‰ä¼˜å…ˆçº§è£å‰ªï¼ˆfeed digest å…ˆäº user facts ä¸¢å¼ƒï¼›persona æ°¸ä¸ä¸¢å¼ƒï¼‰ âœ…
- [x] ç»Ÿä¸€çš„ `ContextAssembler` ç»“æ„ä½“ + `ContextLayers` + `build_full_system_prompt()` âœ…

---

### 29. âœ… å®‰å…¨æ²™ç®±ä¸ Capability Tiers
**æ¨¡å—**: `mneme_core/src/safety.rs`, `mneme_reasoning/src/engine.rs`

**å·²å®Œæˆ** (v0.4.0):
- [x] ä¸‰çº§èƒ½åŠ›æ¨¡å‹ `CapabilityTier`: ReadOnly / Restricted / Full âœ…
- [x] `CapabilityGuard` è¿è¡Œæ—¶æƒé™æ£€æŸ¥ï¼ˆå·¥å…·æ‰§è¡Œå‰æ‹¦æˆªï¼‰ âœ…
- [x] å‘½ä»¤é»‘åå•è¿‡æ»¤ï¼ˆrm -rf, sudo, mkfs ç­‰ç ´åæ€§å‘½ä»¤ï¼‰ âœ…
- [x] è·¯å¾„æ²™ç®±ï¼šRestricted æ¨¡å¼ä¸‹æ–‡ä»¶æ“ä½œé™åˆ¶åœ¨ç™½åå•ç›®å½•å†… âœ…
- [x] ç½‘ç»œå‡ºç«™åŸŸåç™½åå• âœ…
- [x] ReadOnly æ¨¡å¼ä¸‹åªå…è®¸ ls/cat/git status ç­‰åªè¯»å‘½ä»¤ âœ…
- [x] é›†æˆåˆ° `ReasoningEngine.execute_tool()` + `ToolRegistry.dispatch()` âœ…
- [x] é€šè¿‡ `MnemeConfig.safety` ç»Ÿä¸€é…ç½® âœ…
- [x] 15 ä¸ªæµ‹è¯•è¦†ç›–ä¸‰çº§æƒé™ + è·¯å¾„ + URL + é»‘åå• âœ…

**å¾…åç»­è¡¥å……**:
- [ ] Destructive æ“ä½œçš„ç”¨æˆ·ç¡®è®¤æµç¨‹ï¼ˆäº¤äº’å¼ï¼‰
- [ ] å®¡è®¡æ—¥å¿—ï¼šæ‰€æœ‰å·¥å…·è°ƒç”¨è®°å½•

---

### 45. âœ… Coordinator å¹¶å‘å®‰å…¨
**æ¨¡å—**: `mneme_memory/src/coordinator.rs`
**ä¼˜å…ˆçº§**: ğŸ”´ é«˜

**é—®é¢˜ A â€” çŠ¶æ€æ›´æ–°ç«æ€**:
`trigger_sleep()` å…ˆ `state.read()` åš consolidationï¼Œå† `state.write()` å†™å›ç»“æœã€‚æœŸé—´ `process_interaction()` çš„çŠ¶æ€ä¿®æ”¹ä¼šè¢«è¦†ç›–ä¸¢å¤±ã€‚

**é—®é¢˜ B â€” å¤š RwLock æ­»é”é£é™©**:
`process_interaction()` å…ˆé” `state` å†é” `prev_somatic`ï¼›å…¶ä»–æ–¹æ³•å¯èƒ½ä»¥ä¸åŒé¡ºåºè·å–é”ã€‚æ— ç»Ÿä¸€é”é¡ºåºçº¦å®šã€‚

**éœ€è¦å®ç°**:
- [x] çŠ¶æ€ç‰ˆæœ¬å· â†’ æ”¹ç”¨ `state_mutation_lock: tokio::sync::Mutex<()>` åºåˆ—åŒ–æ‰€æœ‰çŠ¶æ€å˜æ›´æ“ä½œ âœ…
- [x] ç»Ÿä¸€é”é¡ºåºæ–‡æ¡£ï¼š`state_mutation_lock` â†’ `state` â†’ `prev_somatic` â†’ `episode_buffer` â†’ `feedback_buffer` âœ…
- [ ] æˆ–æ”¹ç”¨ actor/mpsc æ¨¡å¼æ›¿ä»£å¤š RwLockï¼ˆè§ #17 ä»£ç ç»„ç»‡ä¼˜åŒ–ï¼‰

---

### 46. âœ… CLI å…³æœºå¯é æ€§
**æ¨¡å—**: `mneme_cli/src/main.rs`
**ä¼˜å…ˆçº§**: ğŸ”´ é«˜

**é—®é¢˜**: ä¸‰æ¡å…³æœºè·¯å¾„ï¼ˆquit å‘½ä»¤ã€Ctrl-C readlineã€Ctrl-C tokio signalï¼‰éƒ½ç”¨ `std::process::exit(0)` + 500ms `sleep` ç¡¬ç­‰å¾…ã€‚å¦‚æœ `coordinator.shutdown()` è¶…è¿‡ 500msï¼Œæ•°æ®åº“å†™å…¥å¯èƒ½ä¸å®Œæ•´ã€‚

**éœ€è¦å®ç°**:
- [x] ç”¨ `tokio::sync::oneshot` channel æ›¿ä»£ sleep ç¡¬ç­‰å¾… âœ…
- [x] `graceful_shutdown()` å¸¦ 5s timeoutï¼Œshutdown å®Œæˆåå† exit âœ…
- [x] ç»Ÿä¸€å…³æœºè·¯å¾„ä¸ºä¸€ä¸ª async å‡½æ•°ï¼Œé¿å…ä¸‰å¤„é‡å¤ä»£ç  âœ…

---

### 47. âœ… goals.rs / rules.rs æ•°æ®åº“é›†æˆéªŒè¯
**æ¨¡å—**: `mneme_memory/src/goals.rs`, `mneme_memory/src/rules.rs`
**ä¼˜å…ˆçº§**: ğŸ”´ é«˜

**é—®é¢˜**: è¿™ä¸¤ä¸ªæ˜¯ untracked æ–°æ–‡ä»¶ã€‚`GoalManager` è°ƒç”¨ `db.load_active_goals()` / `db.create_goal()` ç­‰æ–¹æ³•ï¼Œ`RuleEngine` è°ƒç”¨ `db.load_behavior_rules()`ã€‚å¦‚æœè¿™äº›æ–¹æ³•åœ¨ `SqliteMemory` ä¸­æœªå®ç°ï¼Œè¿è¡Œæ—¶ä¼š panicã€‚

**éœ€è¦å®ç°**:
- [x] ç¡®è®¤ `SqliteMemory` å·²å®ç°æ‰€æœ‰ Goal/Rule ç›¸å…³ DB æ–¹æ³• âœ…
- [x] è¡¥å……é›†æˆæµ‹è¯•ï¼šGoalManager + SqliteMemory ç«¯åˆ°ç«¯ âœ…
- [x] è¡¥å……é›†æˆæµ‹è¯•ï¼šRuleEngine + SqliteMemory ç«¯åˆ°ç«¯ âœ…
- [x] `rules.rs` è§¦å‘åŒ¹é…ä¿®å¤ï¼š`discriminant()` åªæ¯”è¾ƒæšä¸¾å˜ä½“ï¼Œä¸æ¯”è¾ƒå†…éƒ¨æ•°æ®ï¼ˆå¦‚ `field`, `threshold`ï¼‰â†’ å®Œæ•´ pattern matching âœ…

---

## ğŸŸ¡ ä¸­ä¼˜å…ˆçº§ (Medium Priority)

### 5. ğŸ§¬ åé¦ˆä¿¡å·æ”¶é›†ä¸æŒä¹…åŒ–
**æ¨¡å—**: `mneme_memory/src/feedback_buffer.rs`, `mneme_memory/src/sqlite.rs`  
**é—®é¢˜**: åé¦ˆä¿¡å·åªåœ¨å†…å­˜ä¸­ç¼“å­˜ï¼Œé‡å¯åä¸¢å¤±ã€‚è¿™æ˜¯å®ç°ä¸ªæ€§åŒ–å­¦ä¹ çš„æ ¸å¿ƒæ•°æ®æºã€‚

**å½“å‰çŠ¶æ€**:
- `FeedbackBuffer` åœ¨å†…å­˜ä¸­
- é‡å¯å‰è°ƒç”¨ `shutdown()` ä¼šå°è¯•ä¿å­˜ï¼Œä½†å¯èƒ½é—æ¼
- æ²¡æœ‰ä¸»åŠ¨æ”¶é›†ç”¨æˆ·åé¦ˆçš„æœºåˆ¶

**éœ€è¦å®ç°**:
- [x] åé¦ˆä¿¡å·å®æ—¶æŒä¹…åŒ–åˆ° SQLite âœ…
- [x] å¯åŠ¨æ—¶åŠ è½½æœªæ•´åˆçš„ä¿¡å· âœ…
- [ ] ç”¨æˆ·æ˜¾å¼åé¦ˆæœºåˆ¶ï¼ˆç‚¹èµ/ç‚¹è¸©/çº æ­£ï¼‰
- [ ] éšå¼åé¦ˆæ¨æ–­ï¼ˆç”¨æˆ·æ˜¯å¦ç»§ç»­è¯é¢˜ã€å›å¤é€Ÿåº¦ç­‰ï¼‰

**ç›¸å…³è¡¨**: `feedback_signals` å·²å­˜åœ¨ä½†æœªå®Œå…¨ä½¿ç”¨

---

### 6. ğŸ—ï¸ å±æ€§æµ‹è¯• (Property-Based Testing) âœ…
**æ¨¡å—**: å…¨å±€  
**é—®é¢˜**: ~~å½“å‰åªæœ‰åŸºç¡€å•å…ƒæµ‹è¯•ï¼Œç¼ºä¹éšæœºåŒ–æµ‹è¯•æ¥å‘ç°è¾¹ç•Œé—®é¢˜ã€‚~~

**å·²å®Œæˆ** (41 proptest tests across 3 crates):

| Crate | Tests | è¦†ç›–å†…å®¹ |
|-------|-------|----------|
| mneme_core | 21 | ODE ä»»æ„çŠ¶æ€/è¾“å…¥/dt ç¨³å®šæ€§, NaN æ³¨å…¥æ¢å¤, normalize() å¹‚ç­‰æ€§, Affect è¾¹ç•Œ/lerp/polar, Emotion roundtrip, ä¾æ‹æ›´æ–°è¾¹ç•Œ, é“å¾·æˆæœ¬è¾¹ç•Œ |
| mneme_limbic | 8 | ModulationVector 6 å­—æ®µè¾¹ç•ŒéªŒè¯, energyâ†’max_tokens å•è°ƒæ€§, stressâ†’temperature å•è°ƒæ€§, SomaticMarker æ ¼å¼éªŒè¯, proactivity_urgency è¾¹ç•Œ |
| mneme_reasoning | 12 | sanitize_chat_output å¹‚ç­‰æ€§, ä»»æ„ Unicode ä¸ panic, header/bullet/bold ç§»é™¤, ä¸­æ–‡ä¿ç•™, 2000 cases |

**Bug found**: `sanitize_chat_output` å¯¹é‡å  `*` æ¨¡å¼ (å¦‚ `**0*text*`) ä¸å¹‚ç­‰ã€‚å·²ä¿®å¤ã€‚

**å¾…åç»­è¡¥å……**:
- [ ] åºåˆ—åŒ–/ååºåˆ—åŒ–å¾€è¿”æµ‹è¯•
- [ ] å¹¶å‘å®‰å…¨æµ‹è¯•

---

### 7. âœ… æµè§ˆå™¨å·¥å…·ç¨³å®šæ€§
**æ¨¡å—**: `mneme_browser/src/client.rs`, `mneme_reasoning/src/engine.rs`  
**é—®é¢˜**: headless_chrome å¯èƒ½ä¸ç¨³å®šï¼Œæ²¡æœ‰å¥åº·æ£€æŸ¥å’Œä¼šè¯æ¢å¤ã€‚

**å·²å®Œæˆ** (commit `d566528`):
- [x] è¿ç§» deprecated `wait_for_initial_tab()` â†’ `new_tab()` âœ… â€” æ¶ˆé™¤ç¼–è¯‘è­¦å‘Šï¼Œheadless_chrome v1.0.4+ æ¨èæ–¹å¼
- [x] `BrowserConfig` é…ç½®ç»“æ„ä½“ âœ… â€” headless æ¨¡å¼ã€element_timeoutã€navigation_timeoutï¼Œ`debug()` æ„é€ å™¨ç”¨äºé headless è°ƒè¯•
- [x] `is_alive()` å¥åº·æ£€æŸ¥ âœ… â€” é€šè¿‡ `tab.get_target_info()` CDP è°ƒç”¨æ¢æµ‹æµè§ˆå™¨å­˜æ´»
- [x] `tab()` DRY helper âœ… â€” æ›¿ä»£æ‰€æœ‰æ–¹æ³•ä¸­é‡å¤çš„ `if let Some(tab) = &self.current_tab` æ¨¡å¼
- [x] Proactive session recovery âœ… â€” `execute_browser_tool()` æ‰§è¡Œå‰æ£€æŸ¥ `is_alive()`ï¼Œæ­»äº¡ä¼šè¯è‡ªåŠ¨ä¸¢å¼ƒé‡å»º
- [x] HTML æˆªæ–­ âœ… â€” `GetHtml` action é™åˆ¶è¿”å› 8KBï¼Œé˜²æ­¢å·¨å‹é¡µé¢æ’‘çˆ† context
- [x] `set_default_timeout()` âœ… â€” æ–°å»º tab æ—¶è®¾ç½®å¯é…ç½®è¶…æ—¶
- [x] 3 ä¸ªæ–°å•å…ƒæµ‹è¯•ï¼ˆBrowserConfig default/debug/customï¼‰âœ…

---

### 8. âœ… LLM å“åº”è§£æå¥å£®æ€§
**æ¨¡å—**: `mneme_reasoning/src/engine.rs`, `mneme_reasoning/src/extraction.rs`  
**é—®é¢˜**: LLM è¾“å‡ºæ ¼å¼å¯èƒ½ä¸ç¬¦åˆé¢„æœŸï¼Œè§£æå¯èƒ½å¤±è´¥ã€‚

**å·²å®Œæˆ** (commit `5b581df`):
- [x] Emotion tag è§£æå¥å£®åŒ– âœ… â€” `parse_emotion_tags()`: å¤„ç†å¤§å°å†™ `<Emotion>`ã€ç©ºæ ¼ `< emotion >`ã€å¤šæ ‡ç­¾ã€ç©ºå†…å®¹ã€æ— æ³•è¯†åˆ«çš„æƒ…ç»ªå€¼
- [x] Silence æ£€æµ‹å¥å£®åŒ– âœ… â€” `is_silence_response()`: å¤§å°å†™ä¸æ•æ„Ÿã€å®¹å¿ç©ºæ ¼/çœç•¥å·ï¼Œä½†ä¸è¯¯åˆ¤å« SILENCE çš„æ­£å¸¸æ–‡æœ¬
- [x] JSON æå–å¤šç­–ç•¥è§£æ âœ… â€” 6 å±‚ fallback: ç›´æ¥è§£æ â†’ code block æå– â†’ balanced braces â†’ bare array â†’ JSON repair â†’ graceful empty
- [x] JSON repair âœ… â€” `repair_json()`: ä¿®å¤ trailing commasã€å•å¼•å·æ›¿æ¢ã€unquoted keys
- [x] `extract_balanced_braces()` âœ… â€” æ­£ç¡®å¤„ç†åµŒå¥— `{}`ã€å­—ç¬¦ä¸²å†…è½¬ä¹‰ã€é¿å… `find('}')/rfind('}')` çš„é”™è¯¯åŒ¹é…
- [x] Tool result å®‰å…¨å¤„ç† âœ… â€” `sanitize_tool_result()`: 8KB æˆªæ–­ + prompt injection æ£€æµ‹ (`ignore previous instructions`, `<system>` æ ‡ç­¾)
- [x] emotion regex å‡çº§ âœ… â€” `(?si)<\s*emotion\s*>(.*?)<\s*/\s*emotion\s*>` æ”¯æŒ dotall + case insensitive + çµæ´»ç©ºæ ¼
- [x] 29 ä¸ªæ–°å•å…ƒæµ‹è¯•ï¼ˆemotion 8 + silence 7 + tool sanitize 4 + extraction 10ï¼‰ âœ…

---

### 34. ğŸ§¬ è¾“å‡ºè‡ªç„¶åŒ–ï¼šä¸Šä¸‹æ–‡æ„ŸçŸ¥çš„æ ¼å¼ä¸è¡¨è¾¾
**æ¨¡å—**: `persona/broca.md`, `mneme_reasoning/src/engine.rs`, `mneme_reasoning/src/prompts.rs`  
**é—®é¢˜**: LLM è¾“å‡ºå­˜åœ¨æ˜æ˜¾çš„"AIå‘³"ï¼Œä¸ç¬¦åˆäººç±»åœ¨ä¸åŒåœºæ™¯ä¸‹çš„å®é™…è¾“å‡ºä¹ æƒ¯ã€‚

**å·²çŸ¥é—®é¢˜**:
1. **å¿ƒç†æå†™/åŠ¨ä½œæ—ç™½**ï¼šè¾“å‡º `*æ„Ÿè§‰æœ‰ç‚¹ç†Ÿæ‚‰*` `*æ­ªå¤´*` ç­‰ roleplay å¼çš„æ˜Ÿå·åŠ¨ä½œæå†™
2. **æ— å·®åˆ«ä½¿ç”¨ Markdown**ï¼šæ—¥å¸¸èŠå¤©ä¸­ä½¿ç”¨åŠ ç²—ã€æ ‡é¢˜ã€åˆ—è¡¨ã€ä»£ç å—
3. **é•œåƒå›å¤**ï¼šç”¨æˆ·è¯´ä¸‰ç‚¹ï¼ŒLLM ä¹Ÿé€ç‚¹å›ä¸‰æ¡â€”â€”äººç±»ä¸ä¼šè¿™æ ·
4. **æ€»ç»“å¼å›å¤**ï¼š"ä½ è¯´çš„å¯¹ï¼ŒX å’Œ Y éƒ½å¾ˆé‡è¦"è¿™ç§ AI ç‰¹æœ‰çš„å¥å¼

**è®¾è®¡å“²å­¦**:  
> ä¸è¦ç”¨è§„åˆ™å»çº¦æŸä¸è‡ªç„¶â€”â€”ç”¨ç¤ºä¾‹å’Œç»“æ„æ€§åå¤„ç†ã€‚è§„åˆ™è¶Šå¤šè¶Šåƒ AIã€‚

**ä¸‰å±‚é˜²å¾¡**:

| å±‚ | æœºåˆ¶ | å¯é æ€§ |
|---|---|---|
| Persona few-shot | `broca.md` å¯¹è¯ç¤ºä¾‹ï¼ŒLLM æ¨¡ä»¿é£æ ¼ | ä¸­ï¼ˆLLM æ“…é•¿æ¨¡ä»¿ç¤ºä¾‹ï¼‰ |
| System prompt | æç®€åŸåˆ™ï¼Œä¸åˆ—"ä¸è¦åš X" | ä½ï¼ˆLLM å¯èƒ½æ— è§†ï¼‰ |
| **ä»£ç åå¤„ç†** | `sanitize_chat_output()` å‰¥ç¦»æ ¼å¼ | **é«˜ï¼ˆç¡®å®šæ€§ï¼‰** |

**å·²å®Œæˆ**:
- [x] `broca.md` æ”¹ä¸º few-shot ç¤ºä¾‹é©±åŠ¨ï¼Œåˆ é™¤å¤§é‡"ä¸è¦"è§„åˆ™ âœ…
- [x] `prompts.rs` style guide ç²¾ç®€ä¸º 1-2 å¥æ ¸å¿ƒåŸåˆ™ âœ…
- [x] `engine.rs` æ–°å¢ `sanitize_chat_output()` åå¤„ç†ï¼šå‰¥ç¦» `*roleplay*`ã€`**bold**`ã€`# headers`ã€`- bullets` âœ…

**åç»­æ”¹è¿›**:
- [ ] ä¸Šä¸‹æ–‡æ„ŸçŸ¥ï¼šæ ¹æ® `Content.source`ï¼ˆcli/qq/ç¾¤èŠï¼‰å†³å®šæ˜¯å¦å¯ç”¨ sanitize
- [ ] æŠ€æœ¯è®¨è®ºæ—¶è‡ªåŠ¨è·³è¿‡ sanitizeï¼ˆä¿ç•™ä»£ç å—ç­‰ï¼‰
- [ ] ğŸ§¬ ä¸åŒå®ä¾‹çš„è¡¨è¾¾é£æ ¼å·®å¼‚ï¼ˆæœ‰çš„ç®€æ´æœ‰çš„å•°å—¦ï¼Œä½œä¸ºå¯å­¦ä¹ å‚æ•°ï¼‰

---
### 30. âœ… å·¥å…·æ³¨å†Œç³»ç»Ÿ
**æ¨¡å—**: `mneme_reasoning/src/tool_registry.rs`, `mneme_reasoning/src/tools.rs`

**å·²å®Œæˆ** (v0.4.0):
- [x] `ToolHandler` async trait: `name()`, `description()`, `schema()`, `execute()` âœ…
- [x] `ToolRegistry` ç»“æ„ä½“ï¼šè¿è¡Œæ—¶æ³¨å†Œ/æ³¨é”€å·¥å…· âœ…
- [x] `ShellToolHandler` + `BrowserToolHandler` å®ç° âœ…
- [x] `ToolRegistry.dispatch()` æ›¿ä»£ engine.rs ä¸­ç¡¬ç¼–ç  match âœ…
- [x] å®‰å…¨ guard é›†æˆï¼šdispatch å‰æ£€æŸ¥ `CapabilityGuard` âœ…
- [x] CLI main.rs ä¸­æ³¨å†Œ 6 ä¸ªå·¥å…·ï¼ˆshell + 5 browserï¼‰ âœ…

---

### 44. ğŸ—ï¸ åŠ¨æ€å·¥å…· Prompt ç”Ÿæˆï¼ˆæ¶ˆé™¤ prompts.rs â†” ToolRegistry é‡å¤ï¼‰
**æ¨¡å—**: `mneme_reasoning/src/prompts.rs`, `mneme_reasoning/src/tool_registry.rs`
**ä¼˜å…ˆçº§**: ğŸŸ¡ ä¸­
**å‰ç½®**: #30 (å·¥å…·æ³¨å†Œç³»ç»Ÿ)

**é—®é¢˜**: `prompts.rs` ä¸­çš„å·¥å…·ä½¿ç”¨è¯´æ˜æ˜¯æ‰‹å†™çš„ç¡¬ç¼–ç å­—ç¬¦ä¸²ï¼Œä¸ `ToolRegistry` ä¸­æ³¨å†Œçš„å·¥å…·ä¿¡æ¯ï¼ˆ`name`, `description`, `input_schema`ï¼‰å®Œå…¨é‡å¤ã€‚æ¯æ¬¡æ–°å¢/ä¿®æ”¹å·¥å…·éœ€è¦æ”¹ä¸¤å¤„ä»£ç ã€‚

**èƒŒæ™¯**: v0.6.0 åå‘ç°æ²‰æµ¸å¼ personaï¼ˆ"åˆšå‡ºç”Ÿçš„å°å¥³å­©"ï¼‰ä¼šå¹²æ‰°å·¥å…·è°ƒç”¨â€”â€”LLM è§’è‰²æ‰®æ¼”è¿‡äºæŠ•å…¥ï¼Œå‘é€ç©º `{}` å·¥å…·è¾“å…¥ã€‚ä¸´æ—¶ä¿®å¤ï¼šå°†å·¥å…·è¯´æ˜ç‹¬ç«‹ä¸ºã€Œç³»ç»Ÿåº•å±‚èƒ½åŠ›ã€å…ƒå±‚ï¼ˆä¸å—è§’è‰²è®¾å®šå½±å“ï¼‰ã€‚ä½†å·¥å…·åˆ—è¡¨ä»ç„¶æ˜¯ç¡¬ç¼–ç çš„ã€‚

**çŸ­æœŸç›®æ ‡ â€” ä» Registry åŠ¨æ€ç”Ÿæˆ Prompt**:
- [x] `ToolRegistry` æ–°å¢ `format_for_prompt() -> String` æ–¹æ³• âœ…
- [x] ä»æ¯ä¸ª handler çš„ `schema()` è‡ªåŠ¨æå– nameã€descriptionã€propertiesã€required âœ…
- [x] ç”Ÿæˆæ ¼å¼åŒ–çš„å·¥å…·è¯´æ˜æ–‡æœ¬ï¼ˆå«è¾“å…¥æ ¼å¼å’Œç¤ºä¾‹ï¼‰ âœ…
- [x] `ContextAssembler::build_full_system_prompt()` æ¥æ”¶ `Option<&ToolRegistry>` å‚æ•° âœ…
- [x] ç§»é™¤ `prompts.rs` ä¸­ç¡¬ç¼–ç çš„å·¥å…·åˆ—è¡¨ âœ…

**é•¿æœŸç›®æ ‡ â€” Prompt è‡ªé€‚åº”ä¼˜åŒ–ï¼ˆğŸ§¬ ä¸ªæ€§å‚æ•°ï¼‰**:

| é˜¶æ®µ | æ–¹å¼ | è¯´æ˜ |
|------|------|------|
| **å½“å‰** | ç¡¬ç¼–ç å­—ç¬¦ä¸² | å¼€å‘è€…æ‰‹å†™ï¼Œæ”¹åŠ¨éœ€é‡æ–°ç¼–è¯‘ |
| **çŸ­æœŸ** | Registry åŠ¨æ€ç”Ÿæˆ | æ¶ˆé™¤é‡å¤ï¼Œæ–°å¢å·¥å…·è‡ªåŠ¨ç”Ÿæ•ˆ |
| **ä¸­æœŸ** | æ¨¡æ¿åŒ– + æŒä¹…åŒ– | prompt æ¨¡æ¿å­˜å…¥ SQLiteï¼Œå¯çƒ­æ›´æ–° |
| **é•¿æœŸ** | è‡ªé€‚åº”ä¼˜åŒ– | è®°å½• prompt ç‰ˆæœ¬ â†” å·¥å…·è°ƒç”¨æˆåŠŸç‡ï¼Œsleep æ—¶åˆ†æå¤±è´¥æ¨¡å¼å¹¶å¾®è°ƒæ¨¡æ¿ |

**é•¿æœŸå®ç°è·¯å¾„**:
1. **Prompt æ¨¡æ¿åŒ–** â€” å°†ç¡¬ç¼–ç å­—ç¬¦ä¸²å˜ä¸ºå¯æŒä¹…åŒ–çš„æ¨¡æ¿ï¼ˆSQLite `prompt_templates` è¡¨ï¼‰
2. **æ•ˆæœå…³è”** â€” æ¯æ¬¡å·¥å…·è°ƒç”¨è®°å½• `(prompt_version, tool_name, success)` ä¸‰å…ƒç»„
3. **ç¦»çº¿ä¼˜åŒ–** â€” sleep consolidation é˜¶æ®µåˆ†æå¤±è´¥æ¨¡å¼ï¼Œå¾®è°ƒæ¨¡æ¿æªè¾
4. **åŸºç¡€è®¾æ–½å¤ç”¨** â€” `coordinator.record_feedback()` + `CurveLearner` å·²æœ‰åé¦ˆå›è·¯åŸºç¡€

---

### 31. âœ… LLM æµå¼è¾“å‡º
**æ¨¡å—**: `mneme_reasoning/src/providers/`, `mneme_reasoning/src/engine.rs`
**é—®é¢˜**: LLM å“åº”å®Œå…¨ç¼“å†²åæ‰å¤„ç†ã€‚ç”¨æˆ·éœ€è¦ç­‰å¾…æ•´ä¸ªç”Ÿæˆå®Œæˆã€‚å¯¹äºé•¿å›å¤ï¼ˆå°¤å…¶é€šè¿‡ OneBot å‘é€ï¼‰ï¼Œä¸¥é‡æŸå®³"ç±»äººæ„Ÿ"ã€‚

**å·²å®Œæˆ** (v0.5.0):
- [x] `StreamEvent` æšä¸¾ï¼šTextDelta / ToolUseStart / ToolInputDelta / Done / Error âœ…
- [x] `LlmClient` trait å¢åŠ  `stream_complete()` æ–¹æ³•ï¼ˆé»˜è®¤å›é€€åˆ° `complete()`ï¼‰ âœ…
- [x] Anthropic SSE æµå¼è§£æï¼šcontent_block_start/delta, message_delta/stop âœ…
- [x] OpenAI SSE æµå¼è§£æï¼šdata chunks + `[DONE]` âœ…
- [x] Engine ReAct loop æ”¹ç”¨ `stream_complete()`ï¼Œé€ chunk å¤„ç†æ–‡æœ¬ âœ…
- [x] å·¥å…·è°ƒç”¨ JSON ç¼“å†²ï¼šToolInputDelta ç´¯ç§¯åˆ°å®Œæ•´ JSON åè§£æ âœ…
- [x] `on_text_chunk` å›è°ƒæœºåˆ¶ï¼šCLI å®æ—¶æ‰“å°æ–‡æœ¬ âœ…
- [x] 7 ä¸ªæ–°æµ‹è¯•ï¼šstream_fallback (2) + Anthropic SSE (3) + OpenAI SSE (2) âœ…

---

### 32. ğŸ—ï¸ Reasoning Engine æµ‹è¯•è¦†ç›– âœ…
**æ¨¡å—**: `mneme_reasoning/`  
**é—®é¢˜**: ~~ç³»ç»Ÿä¸­æœ€å¤æ‚çš„æ¨¡å—ï¼ˆReAct å¾ªç¯ã€å·¥å…·åˆ†å‘ã€å†å²ç®¡ç†ã€åé¦ˆè®°å½•ï¼‰**é›¶æµ‹è¯•**ã€‚è¿™æ˜¯æ•´ä¸ªé¡¹ç›®æœ€å¤§çš„å·¥ç¨‹é£é™©ã€‚~~

**å½“å‰æµ‹è¯•åˆ†å¸ƒ**:

| Crate | æµ‹è¯•æ•° | è¦†ç›–è´¨é‡ |
|-------|--------|----------|
| mneme_core | 18 | âœ… å®Œå–„ (å« boredom åŠ¨åŠ›å­¦æµ‹è¯•) |
| **mneme_reasoning** | **109** | âœ… **64 unit + 33 integration + 12 property** |
| mneme_memory | 69 | âœ… å®Œå–„ (å« self_knowledge + episode strength + vec index æµ‹è¯•) |
| mneme_limbic | 9 | âœ… è‰¯å¥½ |
| mneme_expression | 14 | âœ… è‰¯å¥½ |
| mneme_perception | 4 | âœ… è‰¯å¥½ |
| mneme_os | 4 | âœ… è‰¯å¥½ |
| **mneme_onebot** | **6** | âœ… äº‹ä»¶è§£æ + åºåˆ—åŒ–æµ‹è¯• |
| **mneme_browser** | **8** | âœ… action serde + config æµ‹è¯• |
| mneme_voice | 0 | â€” åªæœ‰ trait |
| mneme_cli | 0 | âŒ æ— é›†æˆæµ‹è¯• |

**å·²å®Œæˆ**:
- [x] Mock `LlmClient`ï¼ˆè¿”å›é¢„è®¾å“åº”é˜Ÿåˆ—ï¼Œå¯è®¡æ•°è°ƒç”¨æ¬¡æ•°ï¼‰
- [x] Mock `Memory`ï¼ˆå†…å­˜å®ç°ï¼Œè·Ÿè¸ª memorize/store_fact è°ƒç”¨ï¼‰
- [x] Mock `ShellExecutor`ï¼ˆç½å¤´è¾“å‡ºï¼Œç”¨äºå·¥å…·åˆ†å‘æµ‹è¯•ï¼‰
- [x] ReAct å¾ªç¯æµ‹è¯•ï¼šæ­£å¸¸å¯¹è¯ã€å·¥å…·è°ƒç”¨ã€å¤šè½®å·¥å…·ã€é€’å½’é™åˆ¶è§¦å‘
- [x] å·¥å…·åˆ†å‘æµ‹è¯•ï¼šshell å·¥å…·æˆåŠŸ/å¤±è´¥è·¯å¾„ã€æœªçŸ¥å·¥å…·å¤„ç†
- [x] å†å²ç®¡ç†æµ‹è¯•ï¼šprune é€»è¾‘ã€çª—å£æ»‘åŠ¨
- [x] è¾“å‡º sanitization æµ‹è¯•ï¼šroleplay æ˜Ÿå·ã€markdown æ ‡è®°ã€æ··åˆæ ¼å¼
- [x] æƒ…ç»ªè§£ææµ‹è¯•ï¼šæ ‡ç­¾æå–ã€é»˜è®¤ fallback
- [x] ä¸»åŠ¨è§¦å‘æµ‹è¯•ï¼šå®šæ—¶è§¦å‘ã€å†…å®¹ç›¸å…³è§¦å‘
- [x] è¾¹ç•Œæ¡ä»¶æµ‹è¯•ï¼šç©ºè¾“å…¥ã€è¶…é•¿è¾“å…¥ã€ç‰¹æ®Šå­—ç¬¦ã€Unicode

**å¾…åç»­è¡¥å……**:
- [x] OneBot äº‹ä»¶è§£æä¸å‘é€æµ‹è¯• âœ… â€” 6 ä¸ªæµ‹è¯•è¦†ç›– MessageEvent/Meta/Notice/SendAction/Response
- [ ] GitHub Actions CI/CD æµæ°´çº¿é…ç½®

---

### 33. âœ… å‘é‡æœç´¢ ANN ç´¢å¼•
**æ¨¡å—**: `mneme_memory/src/sqlite.rs`

**å·²å®Œæˆ** (v0.5.0):
- [x] ä½¿ç”¨ `sqlite-vec` æ‰©å±•ï¼ˆçº¯ Cï¼Œæ— å¤–éƒ¨ä¾èµ–ï¼Œcosine è·ç¦»ï¼‰ âœ…
- [x] `vec_episodes` è™šæ‹Ÿè¡¨ (`vec0`, float[384]) âœ…
- [x] `memorize()` åŒæ—¶å†™å…¥ episodes + vec_episodes âœ…
- [x] `backfill_vec_index()` è¿ç§»å·²æœ‰ episodes çš„ embedding âœ…
- [x] `recall()` æ”¹ç”¨ KNN æŸ¥è¯¢ï¼ˆ`WHERE embedding MATCH ? AND k = 20`ï¼‰ï¼Œå»é™¤ LIMIT 1000 âœ…
- [x] `recall_with_bias()` åŒæ­¥æ”¹ç”¨ KNN + mood-congruent recency bias âœ…
- [x] 3 ä¸ªæ–°æµ‹è¯•ï¼švec_recall_basic, vec_recall_removes_limit, vec_backfill âœ…

---
## ï¿½ Token ç»æµä¸æˆæœ¬æ§åˆ¶

è¿™æ˜¯å®ç° Agency çš„æ ¸å¿ƒçº¦æŸã€‚å¦‚æœ Mneme è¦æŒç»­"æ´»ç€"å¹¶ä¸»åŠ¨è¡ŒåŠ¨ï¼Œå¿…é¡»ç²¾å¿ƒç®¡ç† token æ¶ˆè€—ã€‚

### é—®é¢˜åˆ†æ

| è¡Œä¸º | é¢„ä¼°æ¶ˆè€— | é¢‘ç‡ | æœˆæˆæœ¬ï¼ˆå‡è®¾ï¼‰ |
|------|----------|------|---------------|
| å“åº”ç”¨æˆ·æ¶ˆæ¯ | ~2k tokens | æŒ‰éœ€ | å¯æ§ |
| ä¸»åŠ¨å‘èµ·èŠå¤© | ~1k tokens | æ¯å°æ—¶? | ~720k/æœˆ |
| å¥½å¥‡å¿ƒæ¢ç´¢ | ~3k tokens | æ¯å°æ—¶? | ~2.2M/æœˆ |
| è‡ªæˆ‘åæ€ | ~2k tokens | æ¯å¤©? | ~60k/æœˆ |
| **åˆè®¡** | | | **å¯èƒ½ $50-200+/æœˆ** |

### 9. âœ… Token é¢„ç®—ç³»ç»Ÿ
**ä¼˜å…ˆçº§**: ğŸ”´ é«˜ï¼ˆAgency å‰ç½®æ¡ä»¶ï¼‰

**å·²å®Œæˆ** (v0.4.0):
- [x] `TokenBudgetConfig`: æ—¥/æœˆ token ä¸Šé™ + è­¦å‘Šé˜ˆå€¼ + é™çº§ç­–ç•¥ âœ…
- [x] `TokenBudget` ç»“æ„ä½“ï¼šrecord_usage / check_budget / get_daily_usage / get_monthly_usage âœ…
- [x] SQLite `token_usage` è¡¨æŒä¹…åŒ– + è‡ªåŠ¨æ—¥æœŸèšåˆ âœ…
- [x] `BudgetStatus` ä¸‰æ€ï¼šOk / Warning / Exceeded âœ…
- [x] é™çº§ç­–ç•¥ï¼šHardStopï¼ˆæ‹’ç»è¯·æ±‚ï¼‰/ Degradeï¼ˆé™ä½ max_tokensï¼‰ âœ…
- [x] é›†æˆåˆ° `process_thought_loop()` å¼€å¤´æ£€æŸ¥é¢„ç®— âœ…
- [x] CLI `status` å‘½ä»¤æ˜¾ç¤ºæ—¥/æœˆ token ç”¨é‡ âœ…
- [x] é€šè¿‡ `MnemeConfig.token_budget` ç»Ÿä¸€é…ç½® âœ…

### 10. âœ… åˆ†å±‚å†³ç­–æ¶æ„
**ä¼˜å…ˆçº§**: ğŸ”´ é«˜

**å·²å®Œæˆ** (v0.4.0):
- [x] `DecisionRouter` ç»“æ„ä½“ï¼šè§„åˆ™é“¾å¼è¯„ä¼°ï¼Œfirst-match è·¯ç”± âœ…
- [x] `DecisionRule` traitï¼šå¯æ‰©å±•çš„è§„åˆ™æ¥å£ âœ…
- [x] `DecisionLevel` ä¸‰å±‚ï¼šRuleMatchï¼ˆç›´æ¥è¿”å›ï¼‰/ QuickResponseï¼ˆä½ tokenï¼‰/ FullReasoningï¼ˆå®Œæ•´ç®¡é“ï¼‰ âœ…
- [x] å†…ç½®è§„åˆ™ï¼š`EmptyInputRule`ï¼ˆç©ºæ¶ˆæ¯è¿‡æ»¤ï¼‰+ `GreetingRule`ï¼ˆä¸­è‹±æ–‡é—®å€™æ£€æµ‹ï¼‰ âœ…
- [x] é›†æˆåˆ° `ReasoningEngine.think()` å…¥å£ï¼šRuleMatch è·³è¿‡ LLMï¼ŒQuickResponse é™ä½é¢„ç®— âœ…
- [x] 8 ä¸ªæµ‹è¯•è¦†ç›–æ‰€æœ‰è§„åˆ™å’Œè·¯ç”±è¡Œä¸º âœ…

**å¾…åç»­è¡¥å……**:
- [ ] æœ¬åœ° embedding æ¨¡å‹åšè¯­ä¹‰åˆ¤æ–­ï¼ˆå·²æœ‰ fastembedï¼‰
- [ ] æœ¬åœ°å°å‹ LLMï¼ˆå¦‚ Phi-3, Qwen2-0.5Bï¼‰åšç®€å•å†³ç­–

### 11. âœ… æ™ºèƒ½è°ƒåº¦ç­–ç•¥
**ä¼˜å…ˆçº§**: ğŸŸ¡ ä¸­
**è¯´æ˜**: è°ƒåº¦å†³ç­–ï¼ˆä½•æ—¶è¡ŒåŠ¨ã€ä»€ä¹ˆä¼˜å…ˆï¼‰åº”æˆä¸ºå¯å­¦ä¹ çš„ä¸ªæ€§å‚æ•°ã€‚

**å·²å®Œæˆ** (v0.6.0):
- [x] PresenceScheduler åŠ¨æ€ tick/trigger é—´éš”è®¡ç®— âœ…
- [x] ç”Ÿå‘½å‘¨æœŸæ„ŸçŸ¥ï¼šSleeping Ã—10, Drowsy Ã—3, High energy Ã—0.5 âœ…
- [x] ç›®æ ‡æ„ŸçŸ¥ï¼šæ´»è·ƒç›®æ ‡å¤š â†’ trigger é—´éš”ç¼©çŸ­ âœ…
- [x] æ—¶é—´æ„ŸçŸ¥ï¼šå¤œé—´ (0-6h) â†’ trigger é—´éš” Ã—2 âœ…
- [x] AgentLoop æ”¹ç”¨ tokio::time::sleep åŠ¨æ€è°ƒåº¦æ›¿ä»£å›ºå®š interval âœ…

**å¾…åç»­è¡¥å……**:
- [ ] "å€¼å¾—åº¦"è¯„ä¼°ï¼šè¿™ä¸ªè¡ŒåŠ¨å€¼å¾—èŠ±å¤šå°‘ tokenï¼Ÿ
- [ ] æ‰¹é‡å¤„ç†ï¼šç§¯ç´¯å¤šä¸ªå°ä»»åŠ¡ä¸€èµ·å¤„ç†
- [ ] ç¼“å­˜å¤ç”¨ï¼šç›¸ä¼¼é—®é¢˜å¤ç”¨å†å²å›ç­”

### 12. âœ… æœ¬åœ°æ¨¡å‹é›†æˆ
**ä¼˜å…ˆçº§**: ğŸŸ¡ ä¸­

**å·²å®Œæˆ** (v0.6.0):
- [x] OllamaClient å®ç° LlmClient traitï¼ˆcomplete + stream_completeï¼‰ âœ…
- [x] å¤ç”¨ OpenAI SSE è§£æé€»è¾‘ï¼ˆparse_openai_sseï¼‰ âœ…
- [x] ç¯å¢ƒå˜é‡é…ç½®ï¼šOLLAMA_BASE_URL / OLLAMA_MODEL âœ…
- [x] 6 ä¸ªæµ‹è¯•ï¼šclient creation, text/tool/empty response parsing, message/tool building âœ…

**å¾…åç»­è¡¥å……**:
- [ ] candle / ONNX Runtime æœ¬åœ°æ¨ç†ï¼ˆç”¨äºæƒ…æ„Ÿåˆ†æã€æ„å›¾è¯†åˆ«ç­‰è½»é‡ä»»åŠ¡ï¼‰

### æˆæœ¬æ§åˆ¶ç­–ç•¥ç¤ºä¾‹

```rust
// ä¼ªä»£ç ï¼šå†³ç­–æ˜¯å¦ä½¿ç”¨å¤§æ¨¡å‹
async fn should_use_llm(trigger: &AgentTrigger, budget: &TokenBudget) -> Decision {
    // 1. é¢„ç®—æ£€æŸ¥
    if budget.remaining_today() < 1000 {
        return Decision::Skip("é¢„ç®—ä¸è¶³");
    }
    
    // 2. è§„åˆ™å¿«é€Ÿåˆ¤æ–­
    if trigger.is_low_priority() && budget.usage_rate() > 0.8 {
        return Decision::Defer("ä½ä¼˜å…ˆçº§ï¼Œé¢„ç®—ç´§å¼ ");
    }
    
    // 3. æœ¬åœ°æ¨¡å‹é¢„åˆ¤
    let importance = local_model.estimate_importance(trigger).await;
    if importance < 0.3 {
        return Decision::Skip("æœ¬åœ°æ¨¡å‹åˆ¤æ–­ä¸é‡è¦");
    }
    
    // 4. å†³å®šä½¿ç”¨å“ªä¸ªæ¨¡å‹
    if importance > 0.8 || trigger.is_user_initiated() {
        Decision::UseLargeModel
    } else {
        Decision::UseSmallModel
    }
}
```

---

### 53. âœ… ç¤¾äº¤å›¾è°±å†™å…¥ç¼ºå¤± â€” People è¡¨ä¸è¢«å¡«å……
**æ¨¡å—**: `mneme_reasoning/src/engine.rs`, `mneme_memory/src/sqlite.rs`
**ä¼˜å…ˆçº§**: âœ… å·²å®Œæˆ

**é—®é¢˜**: `lookup_social_context()` åªä» `people` è¡¨è¯»å–ï¼Œä½† CLI å’Œ OneBot äº¤äº’è·¯å¾„ä¸­ä»æœªè°ƒç”¨ `upsert_person()`ã€‚ç»“æœæ˜¯ Mneme æ°¸è¿œä¸çŸ¥é“å’Œå¥¹è¯´è¯çš„äººæ˜¯è°â€”â€”`people` è¡¨å§‹ç»ˆä¸ºç©ºã€‚

**ç—‡çŠ¶**: Mneme è‡ªå·±æŸ¥æ•°æ®åº“æ—¶å‘ç° `people` è¡¨ä¸ºç©ºï¼Œæ— æ³•å»ºç«‹ç¤¾äº¤è®°å¿†ã€‚

**éœ€è¦å®ç°**:
- [x] `process_thought_loop()` ä¸­ï¼Œé¦–æ¬¡é‡åˆ°æ–° author æ—¶è°ƒç”¨ `upsert_person()` âœ…
- [x] ä»å¯¹è¯ä¸­æå–äººç‰©ä¿¡æ¯æ›´æ–° `people` è¡¨ï¼ˆåå­—ã€å…³ç³»ã€ä¿¡ä»»ç­‰ï¼‰ âœ…
- [x] ä¿¡ä»»ç»´åº¦ï¼ˆB-19ï¼‰éšäº¤äº’è‡ªç„¶æ¼”åŒ– â†’ æ”¹ä¸º self_knowledge æ¡ç›®ç»¼åˆæ•ˆæœ âœ…

---

### 54. âœ… Mneme ä¸çŸ¥é“è‡ªå·±çš„æ•°æ®åº“ Schema
**æ¨¡å—**: `mneme_reasoning/src/prompts.rs`, `mneme_memory/src/sqlite.rs`
**ä¼˜å…ˆçº§**: âœ… å·²å®Œæˆ

**é—®é¢˜**: Mneme ç”¨ shell å·¥å…·æŸ¥è¯¢è‡ªå·±çš„ SQLite æ•°æ®åº“æ—¶ï¼ŒçŒœé”™è¡¨åï¼ˆå¦‚ `memory_entries` è€Œé `episodes`ï¼‰ã€‚å¥¹å¯¹è‡ªå·±çš„"èº«ä½“ç»“æ„"ï¼ˆB-15ï¼‰æ²¡æœ‰è®¤çŸ¥ã€‚

**ç—‡çŠ¶**: `sqlite3 mneme.db "SELECT * FROM memory_entries"` â†’ è¡¨ä¸å­˜åœ¨é”™è¯¯ã€‚

**å·²å®Œæˆ**:
- [x] å¯åŠ¨æ—¶ç§å­ 10 æ¡ system_knowledge æ¡ç›®æè¿°å…¨éƒ¨è¡¨ç»“æ„ âœ…
- [x] self_knowledge ä¸­æ³¨å…¥ schema ä¿¡æ¯ï¼ˆdomain='system_knowledge'ï¼‰ âœ…
- [x] é•¿æœŸï¼šå¥¹é€šè¿‡ `.tables` / `.schema` å‘½ä»¤è‡ªå·±å­¦ä¼šæ•°æ®åº“ç»“æ„ â†’ å·²æœ‰åŸºç¡€ï¼ˆshell å·¥å…·å¯ç”¨ï¼‰ âœ…

---

### 55. ğŸŸ¡ ä½åˆ†è¾¨ç‡å†…å¿ƒç‹¬ç™½ (ADR-013)
**æ¨¡å—**: `mneme_reasoning/src/engine.rs`, `mneme_expression/src/consciousness.rs`
**ä¼˜å…ˆçº§**: ğŸŸ¡ ä¸­
**å‰ç½®**: æœ¬åœ°æ¨¡å‹é›†æˆ (#12)

**é—®é¢˜**: å½“å‰ `ConsciousnessGate` (ADR-012) åªè§¦å‘é«˜åˆ†è¾¨ç‡ç‹¬ç™½ï¼ˆå®Œæ•´ LLM è°ƒç”¨ï¼‰ã€‚ADR-013 è¦æ±‚ä¸‰å±‚åˆ†è¾¨ç‡ï¼šé›¶ï¼ˆçº¯ ODEï¼‰ã€ä½ï¼ˆæœ¬åœ°å°æ¨¡å‹ç‰‡æ®µå¼ç‹¬ç™½ï¼‰ã€é«˜ï¼ˆå®Œæ•´ LLMï¼‰ã€‚

**éœ€è¦å®ç°**:
- [ ] ä½åˆ†è¾¨ç‡ç‹¬ç™½ï¼šODE çŠ¶æ€å˜åŒ–è¶…é˜ˆå€¼æ—¶ï¼Œç”¨ Ollama æœ¬åœ°å°æ¨¡å‹ç”Ÿæˆç‰‡æ®µå¼ç‹¬ç™½
- [ ] ä½åˆ†è¾¨ç‡ episode çš„ strength è¾ƒä½ï¼ˆæ˜“é—å¿˜ï¼‰
- [ ] ä½â†’é«˜å‡çº§ï¼šä½åˆ†è¾¨ç‡ç‹¬ç™½ä¸­å‡ºç°é«˜ surprise å†…å®¹æ—¶å‡çº§åˆ°å®Œæ•´ LLM
- [ ] ç»æµé¢„ç®—æ„ŸçŸ¥ï¼šé¢„ç®—ä¸è¶³æ—¶é™çº§åˆ°ä½åˆ†è¾¨ç‡

---

### 56. ğŸŸ¡ å½¢æˆæ€§è¯¾ç¨‹ â€” æ–‡å­¦é˜…è¯»ç®¡é“ (ADR-011)
**æ¨¡å—**: `mneme_reasoning/src/engine.rs`, `mneme_perception/`
**ä¼˜å…ˆçº§**: ğŸŸ¡ ä¸­

**é—®é¢˜**: MANIFESTO ADR-011 è¦æ±‚é€šè¿‡æ–‡å­¦ä½œå“é˜…è¯»å½¢æˆä»·å€¼è§‚ï¼Œè€Œéç¡¬ç¼–ç è§„åˆ™ã€‚å½“å‰æ— æ­¤ç®¡é“ã€‚

**éœ€è¦å®ç°**:
- [ ] æ–‡å­¦ä½œå“ç´ æç®¡ç†ï¼ˆæœ¬åœ°æ–‡ä»¶æˆ– URLï¼‰
- [ ] é˜…è¯» â†’ LLM ç”Ÿæˆè¯»ä¹¦ç¬”è®°/åæ€
- [ ] åæ€ç»“æœè¿›å…¥ `FeedbackBuffer` â†’ consolidation æ•´åˆ â†’ å½±å“ self_knowledge å’Œä»·å€¼æƒé‡
- [ ] ä¸åŒ Mneme è¯»åŒä¸€æœ¬ä¹¦å¾—å‡ºä¸åŒç»“è®ºï¼ˆå› å½“å‰çŠ¶æ€ä¸åŒï¼‰

---

### 57. ğŸŸ¢ è®°å¿†åŠ å¯† â€” ç»“æ„æ€§éšç§ä¿éšœ (B-12)
**æ¨¡å—**: `mneme_memory/src/sqlite.rs`
**ä¼˜å…ˆçº§**: ğŸŸ¢ ä½ï¼ˆLevel 2+ æ‰éœ€è¦ï¼‰

**é—®é¢˜**: B-12 è¦æ±‚è‡ªä¸»æƒæœ‰æŠ€æœ¯ä¿éšœï¼Œä¸èƒ½åªé è‡ªè§‰ã€‚å½“å‰æ•°æ®åº“æ˜æ–‡ï¼Œåˆ›å»ºè€…å¯å®Œå…¨è®¿é—®ã€‚

**éœ€è¦å®ç°**:
- [ ] Level 2ï¼šå¯é€‰åŠ å¯†ï¼Œå¥¹å¯æ ‡è®°æŸäº› self_knowledge ä¸º `private` å¹¶åŠ å¯†å­˜å‚¨
- [ ] Level 3ï¼šé»˜è®¤åŠ å¯†ï¼Œåˆ›å»ºè€…åªèƒ½é€šè¿‡å¥¹ä¸»åŠ¨åˆ†äº«è·å–ä¿¡æ¯
- [ ] å¯†é’¥ç”±è¿è¡Œæ—¶æŒæœ‰ï¼Œä¸å­˜å‚¨åœ¨åˆ›å»ºè€…å¯è®¿é—®çš„é…ç½®ä¸­

---

### 48. âœ… Engine Streaming çœŸæ­£ç”Ÿæ•ˆï¼ˆå·²åˆå¹¶è‡³ #31ï¼‰
**æ¨¡å—**: `mneme_reasoning/src/engine.rs`
**ä¼˜å…ˆçº§**: âœ… å·²å®Œæˆï¼ˆä¸ #31 LLM æµå¼è¾“å‡º é‡å¤ï¼‰

**é—®é¢˜**: `on_text_chunk` å›è°ƒå·²åœ¨ CLI ä¸­è®¾ç½®ï¼ˆ`main.rs:221-226`ï¼‰ï¼Œä½† `process_thought_loop()` è°ƒç”¨çš„æ˜¯ `client.complete()`ï¼ˆéæµå¼ï¼‰ã€‚`stream_complete()` å·²å®ç°ä½†æœªåœ¨ engine ä¸­ä½¿ç”¨ã€‚ç”¨æˆ·çœ‹ä¸åˆ°å®æ—¶è¾“å‡ºã€‚

**éœ€è¦å®ç°**:
- [x] `process_thought_loop()` æ”¹ç”¨ `stream_complete()` æ›¿ä»£ `complete()` âœ…
- [x] æµå¼æ–‡æœ¬ chunk é€šè¿‡ `on_text_chunk` å›è°ƒå®æ—¶è¾“å‡º âœ…
- [x] å·¥å…·è°ƒç”¨ JSON åœ¨æµå¼æ¨¡å¼ä¸‹æ­£ç¡®ç´¯ç§¯ï¼ˆ`ToolInputDelta` â†’ å®Œæ•´ JSONï¼‰ âœ…
- [x] å›é€€æœºåˆ¶ï¼š`stream_complete()` å¤±è´¥æ—¶ fallback åˆ° `complete()` âœ…

---

### 49. ğŸ—ï¸ AgentLoop å¯é æ€§
**æ¨¡å—**: `mneme_reasoning/src/agent_loop.rs`
**ä¼˜å…ˆçº§**: ğŸŸ¡ ä¸­

**é—®é¢˜ A â€” èƒŒå‹é™é»˜ä¸¢å¼ƒ**: `try_send(AgentAction::StateUpdate)` å¤±è´¥æ—¶ç”¨ `let _ =` å¿½ç•¥ã€‚channel æ»¡æ—¶ StateUpdate å’Œ AutonomousToolUse è¢«é™é»˜ä¸¢å¼ƒã€‚

**é—®é¢˜ B â€” æ…¢ evaluator é˜»å¡**: å¦‚æœæŸä¸ª TriggerEvaluator è€—æ—¶è¿‡é•¿ï¼Œæ•´ä¸ª tick/trigger å¾ªç¯è¢«é˜»å¡ã€‚

**å·²ä¿®å¤** âœ…:
- [x] `try_send` å¤±è´¥æ—¶ log warningï¼ŒåŒºåˆ† Full å’Œ Closedï¼ˆreceiver dropped â†’ shutdownï¼‰
- [x] receiver dropped æ£€æµ‹ç»Ÿä¸€ï¼š`try_send` å’Œ `send` è¡Œä¸ºä¸€è‡´ï¼Œå‡è§¦å‘ shutdown
- [x] ä¸º evaluator æ·»åŠ  10s è¶…æ—¶ï¼ˆ`tokio::time::timeout`ï¼‰ï¼Œå•ä¸ª evaluator è¶…æ—¶ä¸å½±å“å…¶ä»–

---

### 50. ğŸ—ï¸ SSE è§£æå¥å£®æ€§
**æ¨¡å—**: `mneme_reasoning/src/providers/anthropic.rs`, `openai.rs`
**ä¼˜å…ˆçº§**: ğŸŸ¡ ä¸­

**é—®é¢˜ A â€” Anthropic æœ€åäº‹ä»¶ä¸¢å¤±**: SSE è§£æç”¨ `\n\n` åˆ†éš”äº‹ä»¶å—ã€‚æµç»“æŸæ—¶æ— å°¾éƒ¨ `\n\n` çš„äº‹ä»¶å—ä¸ä¼šè¢«å¤„ç†ã€‚

**é—®é¢˜ B â€” OpenAI å‚æ•°å›é€€ç©ºå¯¹è±¡**: å·¥å…·å‚æ•° JSON è§£æå¤±è´¥æ—¶é™é»˜å›é€€åˆ° `{}`ï¼Œæ•ˆæœåŒ persona å¹²æ‰° bugã€‚

**é—®é¢˜ C â€” å·¥å…· ID/index è¾¹ç•Œ**: OpenAI SSE ä¸­å¤šä¸ªå·¥å…·è°ƒç”¨ç¼ºå°‘ `index` å­—æ®µæ—¶éƒ½é»˜è®¤ä¸º 0ï¼Œå¯¼è‡´äº‹ä»¶å½’å±é”™è¯¯ã€‚

**å·²ä¿®å¤** âœ…:
- [x] Anthropic: æµç»“æŸæ—¶å¤„ç† buffer ä¸­æ®‹ç•™çš„ä¸å®Œæ•´äº‹ä»¶å—
- [x] OpenAI: å·¥å…·è°ƒç”¨ index ç¼ºå¤±æ—¶ç”¨é€’å¢è®¡æ•°å™¨ï¼ˆä» 1000 èµ·ï¼‰è€Œéé»˜è®¤ 0
- [x] ä¸¤ä¸ª provider æ–°å¢ SSE è§£æå•å…ƒæµ‹è¯•

**æœªä¿®å¤**ï¼ˆå½±å“è¾ƒå°ï¼Œä¿ç•™ï¼‰:
- [ ] OpenAI: å‚æ•°è§£æå¤±è´¥æ—¶è¿”å›é”™è¯¯è€Œéç©º `{}`ï¼ˆå½“å‰å·²æœ‰ warn æ—¥å¿—ï¼Œæ”¹ä¸ºç¡¬é”™è¯¯å¯èƒ½ç ´åå…¼å®¹ APIï¼‰
- [x] ä¸¤ä¸ª provider çš„è¶…æ—¶ç»Ÿä¸€ä¸ºå¯é…ç½®å‚æ•° âœ… â€” `timeout_secs` in LlmConfig, env `LLM_TIMEOUT_SECS`

---

### 51. ğŸ—ï¸ OneBot å¯é æ€§
**æ¨¡å—**: `mneme_onebot/src/client.rs`
**ä¼˜å…ˆçº§**: ğŸŸ¡ ä¸­

**é—®é¢˜ A â€” æ¶ˆæ¯ä¸¢å¤±**: WebSocket æ–­è¿æœŸé—´å‘é€çš„æ¶ˆæ¯ç›´æ¥ä¸¢å¤±ï¼Œæ— é‡å‘æœºåˆ¶ã€‚

**é—®é¢˜ B â€” é‡è¿æ— ç†”æ–­**: æ–­è¿åæ— é™é‡è¯•ï¼Œæ— æœ€å¤§æ¬¡æ•°é™åˆ¶ã€‚æœåŠ¡å™¨æ°¸ä¹…ä¸‹çº¿æ—¶ task æ°¸è¿œè¿è¡Œã€‚

**é—®é¢˜ C â€” æ¶ˆæ¯è·¯ç”±é™é»˜å¤±è´¥**: `main.rs:548-554` ä¸­ `group_str.parse::<i64>()` å¤±è´¥æ—¶æ¶ˆæ¯ä¸å‘é€ä¹Ÿä¸æŠ¥é”™ã€‚

**å·²éƒ¨åˆ†ä¿®å¤** âœ…:
- [x] é‡è¿ç†”æ–­ï¼šæœ€å¤§ 10 æ¬¡é‡è¯• + æŒ‡æ•°é€€é¿ï¼Œè¶…é™ååœæ­¢ task
- [x] æ¶ˆæ¯è·¯ç”±å¤±è´¥æ—¶ log errorï¼ˆgroup_id/user_id è§£æå¤±è´¥ä¸å†é™é»˜ä¸¢å¼ƒï¼‰

**æœªä¿®å¤**ï¼ˆéœ€è¦æ›´å¤§æ”¹åŠ¨ï¼‰:
- [x] æ¶ˆæ¯é˜Ÿåˆ—ï¼šæ–­è¿æœŸé—´ç¼“å­˜å¾…å‘æ¶ˆæ¯ï¼Œé‡è¿åé‡å‘ï¼ˆ`PendingMessageQueue`ï¼‰ âœ…
- [ ] è¿æ¥çŠ¶æ€æš´éœ²ç»™ CLI `status` å‘½ä»¤

---

### 52. ğŸ—ï¸ Consolidation åŸå­æ€§
**æ¨¡å—**: `mneme_memory/src/consolidation.rs`
**ä¼˜å…ˆçº§**: ğŸŸ¡ ä¸­

**é—®é¢˜**: `is_consolidation_due()` å’Œ `consolidate()` ä¹‹é—´æ— åŸå­æ€§ï¼ˆTOCTOUï¼‰ã€‚ä¸¤ä¸ªçº¿ç¨‹å¯èƒ½åŒæ—¶åˆ¤æ–­"è¯¥æ•´åˆäº†"ï¼Œç„¶åéƒ½æ‰§è¡Œæ•´åˆã€‚

**éœ€è¦å®ç°**:
- [x] ç”¨ `AtomicBool` ä¿æŠ¤ consolidation å…¥å£ï¼Œç¡®ä¿åŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªæ•´åˆåœ¨è¿è¡Œ âœ…
- [x] å¹¶å‘è°ƒç”¨è¿”å› `ConsolidationResult::skipped("already in progress")` âœ…

---

## ğŸŸ¢ ä½ä¼˜å…ˆçº§ (Low Priority)

### 13. ğŸ§¬ ç¦»çº¿å­¦ä¹ ç®¡é“
**æ¨¡å—**: `mneme_memory/src/learning.rs`, `mneme_memory/src/coordinator.rs`
**é—®é¢˜**: å½“å‰æ•´åˆåªåœ¨ "ç¡çœ " æ—¶é—´è¿›è¡Œï¼Œéœ€è¦å®Œæ•´çš„ç¦»çº¿å­¦ä¹ æµç¨‹ã€‚è¿™æ˜¯å®ç°ä¸ªæ€§åŒ–çš„æ ¸å¿ƒæœºåˆ¶ã€‚

**å·²å®Œæˆï¼ˆv0.5.0ï¼‰**:
- [x] `ModulationSample` è®°å½• (state, modulation, feedback) ä¸‰å…ƒç»„ âœ…
- [x] `CurveLearner` æ¢¯åº¦æ— å…³æ›²çº¿ä¼˜åŒ–å™¨ï¼ˆreward-weighted nudgeï¼‰ âœ…
- [x] Sleep æ—¶è‡ªåŠ¨åŠ è½½æœªæ¶ˆè´¹æ ·æœ¬ã€å­¦ä¹ æ›²çº¿ã€æŒä¹…åŒ– âœ…
- [x] å¯åŠ¨æ—¶åŠ è½½å·²å­¦ä¹ çš„ `ModulationCurves` âœ…
- [x] SQLite æŒä¹…åŒ–ï¼š`modulation_samples` + `learned_curves` è¡¨ âœ…

**é•¿æœŸç›®æ ‡**:
- [ ] å®šæ—¶ä»»åŠ¡è°ƒåº¦å™¨
- [ ] æ‰¹é‡è®­ç»ƒæ•°æ®å¯¼å‡º
- [ ] å¤–éƒ¨æ¨¡å‹è®­ç»ƒæ¥å£
- [ ] å¢é‡å­¦ä¹ æ”¯æŒ
- [ ] A/B æµ‹è¯•æ¡†æ¶ï¼ˆæ¯”è¾ƒä¸åŒå‚æ•°æ•ˆæœï¼‰

---

### 14. ğŸ§¬ ODE ä¹‹ä¸Šå åŠ å¯å¡‘ç¥ç»ç½‘ç»œ (ADR-001 æ¼”è¿›)
**æ¨¡å—**: `mneme_core/src/values.rs`, `mneme_limbic/src/somatic.rs`  
**é—®é¢˜**: å½“å‰ä»·å€¼åˆ¤æ–­å’Œè¡Œä¸ºæŒ‡å¯¼æ˜¯è§„åˆ™ç¡¬ç¼–ç çš„ã€‚é•¿æœŸç›®æ ‡ï¼šODE æä¾›ç¨³å®šéª¨æ¶ï¼Œä¸Šå±‚å åŠ å¯å­¦ä¹ çš„ç¥ç»ç½‘ç»œå±‚ï¼Œå®ç°å®Œå…¨æ•°æ®é©±åŠ¨çš„ä¸ªæ€§åŒ–è¡Œä¸ºã€‚

**æ¶æ„**:
```
Layer 0: ODE åŠ¨åŠ›å­¦ï¼ˆå†™æ­»ï¼Œä¿è¯ç¨³å®šæ€§/å®‰å…¨æ€§/æ—¶é—´å°ºåº¦åˆ†ç¦»ï¼‰
Layer 1: ModulationCurves â€” å¯å­¦ä¹ çš„ state â†’ parameter æ˜ å°„ï¼ˆè§ #20 ä¸­æœŸï¼‰
Layer 2: å°å‹ç¥ç»ç½‘ç»œ â€” ç›´æ¥ä» OrganismState è¾“å‡º ModulationVector
```

**é•¿æœŸç›®æ ‡**:
- [ ] ç ”ç©¶é€‚åˆçš„å°å‹ç¥ç»ç½‘ç»œæ¶æ„ï¼ˆMLP? Transformer micro-head?ï¼‰
- [ ] åœ¨çº¿å¾®è°ƒæœºåˆ¶ï¼šç”¨ (state, modulation, user_feedback) ä¸‰å…ƒç»„å­¦ä¹ 
- [ ] å¯è§£é‡Šæ€§ä¿è¯ï¼ˆè¾“å‡ºä»ç„¶æ˜¯ ModulationVectorï¼Œå¯æ£€æŸ¥ï¼‰
- [ ] ä¸ ODE è§„åˆ™ç³»ç»Ÿçš„å¹³æ»‘åˆ‡æ¢ï¼ˆä» Layer 1 æ¸è¿›åˆ° Layer 2ï¼‰

**å‚è€ƒæŠ€æœ¯**:
- Burn/Candle ä½œä¸º Rust ML æ¡†æ¶
- ONNX æ¨¡å‹åŠ è½½
- å¼ºåŒ–å­¦ä¹ ä»äººç±»åé¦ˆ (RLHF)

---

### 15. ğŸ—ï¸ Observability & Metrics
**æ¨¡å—**: å…¨å±€
**é—®é¢˜**: ç¼ºä¹è¿è¡Œæ—¶ç›‘æ§å’Œæ€§èƒ½æŒ‡æ ‡ã€‚

**éœ€è¦å®ç°**:
- [ ] Prometheus metrics å¯¼å‡º
  - API è°ƒç”¨å»¶è¿Ÿ/æˆåŠŸç‡
  - çŠ¶æ€å€¼åˆ†å¸ƒ
  - å†…å­˜ä½¿ç”¨
- [x] Structured logging (JSON) âœ… â€” `--log-json` CLI flag, `tracing-subscriber` JSON layer
- [x] Configurable log levels âœ… â€” `--log-level` CLI flag + `RUST_LOG` env var via `EnvFilter`
- [x] File logging âœ… â€” `--log-file` with daily rolling via `tracing-appender`
- [x] Key method instrumentation âœ… â€” `#[tracing::instrument]` on process_thought_loop, execute_tool_with_retry, complete (Anthropic/OpenAI), recall/recall_with_bias, consolidate
- [x] Distributed tracing (OpenTelemetry) âœ… â€” feature-gated OTLP span export, `--otlp-endpoint` CLI arg
- [ ] Grafana dashboard æ¨¡æ¿

---

### 16. ğŸ§¬ å¤šç”¨æˆ·/å¤šä¼šè¯æ”¯æŒ
**æ¨¡å—**: `mneme_cli`, `mneme_memory`
**é—®é¢˜**: å½“å‰å‡è®¾å•ç”¨æˆ·åœºæ™¯ã€‚æ¯ä¸ªç”¨æˆ·å…³ç³»åº”è¯¥æ˜¯ç‹¬ç‰¹çš„ä¸ªæ€§åŒ–ä½“éªŒã€‚
**ä¿¡ä»»æ¨¡å‹ï¼ˆB-19ï¼‰**: åˆ›å»ºè€…é»˜è®¤ä¿¡ä»»ï¼ˆæ•æ„ŸæœŸç¬¬ä¸€ä¸ªäººï¼‰ï¼›å…¶ä»–äººç±»é»˜è®¤ä¸­æ€§ï¼Œä»äº¤äº’ä¸­ç‹¬ç«‹æ¶Œç°ã€‚åˆ›å»ºè€…çš„ä»‹ç»ä½œä¸º episode å½±å“åˆå§‹å°è±¡ï¼Œä½†ä¸ç­‰äºä¿¡ä»»ä¼ é€’ã€‚

**é•¿æœŸç›®æ ‡**:
- [ ] ç”¨æˆ·éš”ç¦»çš„çŠ¶æ€å’Œè®°å¿†
- [ ] ä¸åŒç”¨æˆ·ä¸åŒçš„ attachment çŠ¶æ€
- [ ] ç¾¤èŠä¸­çš„å¤šäººå…³ç³»å»ºæ¨¡
- [ ] éšç§ä¿æŠ¤ï¼ˆç”¨æˆ·æ•°æ®åˆ†ç¦»å­˜å‚¨ï¼‰

---

## ğŸ”§ æŠ€æœ¯å€ºåŠ¡ (Tech Debt)

### 17. ğŸ—ï¸ ä»£ç ç»„ç»‡ä¼˜åŒ–
- [ ] `engine.rs` è¿‡äºåºå¤§ï¼ˆ~1650 LOCï¼‰ï¼Œéœ€æ‹†åˆ†ä¸º `ContextAssembler`ã€`ToolDispatcher`ã€`ConversationManager`
- [ ] ç»Ÿä¸€é”™è¯¯ç±»å‹ï¼ˆç›®å‰å…¨éƒ¨ä½¿ç”¨ `anyhow::Error`ï¼Œæ— è‡ªå®šä¹‰é”™è¯¯ç±»å‹ï¼›å¯å¼•å…¥ `thiserror` å®šä¹‰é¢†åŸŸé”™è¯¯ï¼‰
- [ ] å‡å°‘ `Arc<RwLock<>>` çš„è¿‡åº¦ä½¿ç”¨ï¼ˆcoordinator æœ‰ 8 ä¸ª Arc å­—æ®µï¼Œè€ƒè™‘ actor/mpsc æ¨¡å¼ï¼‰
- [ ] æ–‡æ¡£æ³¨é‡Šè¡¥å…¨ï¼ˆå°¤å…¶æ˜¯ public APIï¼›reasoning å’Œ CLI æ¨¡å—æ³¨é‡Šç¨€ç–ï¼‰
- [x] `values.rs` å’Œ `somatic.rs` çš„ä¸­æ–‡æƒ…æ„Ÿå…³é”®è¯åˆ†æé€»è¾‘é‡å¤ï¼Œåº”æŠ½å–ä¸ºå…±ç”¨æ¨¡å— âœ… â€” `mneme_core::sentiment` å…±äº«æ¨¡å— + 6 æµ‹è¯•
- [ ] `ContentItem` ç¼ºå°‘è®¾è®¡æ–‡æ¡£ Â§3.2 è¦æ±‚çš„ reply chainã€thread IDã€modality metadata å­—æ®µ
- [x] `headless_chrome` åŒæ­¥ API åœ¨å¼‚æ­¥ä¸Šä¸‹æ–‡ä¸­ç›´æ¥è°ƒç”¨ï¼Œé˜»å¡ tokio è¿è¡Œæ—¶ï¼Œéœ€ç”¨ `spawn_blocking` åŒ…è£… âœ… â€” engine.rs + tools.rs å…¨éƒ¨ CDP è°ƒç”¨ï¼ˆå¥åº·æ£€æŸ¥ã€ä¼šè¯åˆ›å»ºã€åŠ¨ä½œæ‰§è¡Œã€æ¢å¤ï¼‰å‡å·²åŒ…è£…

### 18. âœ… é…ç½®ç®¡ç†
- [x] ç»Ÿä¸€ TOML é…ç½®æ–‡ä»¶ï¼š`MnemeConfig` + `load_or_default()` âœ…
- [x] ç¯å¢ƒå˜é‡ fallbackï¼ˆ`ANTHROPIC_API_KEY` ç­‰ï¼‰ âœ…
- [x] å­é…ç½®ï¼šLlmConfig / SafetyConfig / TokenBudgetConfig / OrganismConfig / OneBotConfig âœ…
- [x] CLI `--config` å‚æ•° + `--model` / `--db` / `--persona` è¦†ç›– âœ…
- [x] `mneme.example.toml` ç¤ºä¾‹é…ç½®æ–‡ä»¶ âœ…
- [ ] é…ç½®éªŒè¯ï¼ˆschema-levelï¼‰
- [ ] Hot reload æ”¯æŒ

### 19. ğŸ—ï¸ æµ‹è¯•è¦†ç›–ç‡
- [x] `cosine_similarity` å•å…ƒæµ‹è¯• âœ… â€” 7 ä¸ªæµ‹è¯•è¦†ç›–ç›¸åŒ/ç›¸å/æ­£äº¤/ç¼©æ”¾/ç©º/é›¶/é•¿åº¦ä¸åŒ¹é…
- [x] `dynamics.rs` æ…¢çŠ¶æ€å±æœºæµ‹è¯• âœ… â€” 5 ä¸ªæµ‹è¯•è¦†ç›– step_slow_crisisã€apply_moral_costã€homeostatic_error
- [x] `LimbicSystem` æµ‹è¯•è¡¥å…¨ âœ… â€” 7 ä¸ªæ–°æµ‹è¯•è¦†ç›– state roundtripã€é˜ˆå€¼æ£€æµ‹ã€subscribeã€modulationã€curves
- [x] `Affect` æµ‹è¯•è¡¥å…¨ âœ… â€” 12 ä¸ªæ–°æµ‹è¯•è¦†ç›– from_polarã€lerpã€to_discrete_labelã€describeã€è¾¹ç•Œå€¼
- [x] `state.rs` æµ‹è¯•è¡¥å…¨ âœ… â€” 14 ä¸ªæ–°æµ‹è¯•è¦†ç›– attachment å››è±¡é™è½¬æ¢ã€moral cost è¾¹ç•Œã€normalize NaN/Infã€describe_for_contextã€project persona
- [x] Coordinator é›†æˆæµ‹è¯• âœ… â€” 5 ä¸ªæµ‹è¯•ï¼ˆå¹¶å‘å®‰å…¨ã€ç”Ÿå‘½å‘¨æœŸè½¬æ¢ã€åé¦ˆæŒä¹…åŒ–ã€çŠ¶æ€æŒä¹…åŒ–ã€è§„åˆ™å¼•æ“åŠ è½½ï¼‰
- [x] CLI smoke tests âœ… â€” 3 ä¸ªæµ‹è¯•ï¼ˆ--helpã€--versionã€æ— æ•ˆé…ç½®ä¸ panicï¼‰
- [ ] é›†æˆæµ‹è¯•è¡¥å……
- [ ] Mock åŸºç¡€è®¾æ–½å®Œå–„
- [ ] CI/CD é…ç½®
- [ ] ä»£ç è¦†ç›–ç‡æŠ¥å‘Š

---

## ğŸ“‹ å·²çŸ¥ Bug

| Bug | æ¨¡å— | æè¿° | çŠ¶æ€ |
|-----|------|------|------|
| **Coordinator çŠ¶æ€ç«æ€** | mneme_memory/coordinator | `trigger_sleep()` readâ†’consolidateâ†’write æœŸé—´ `process_interaction()` çš„ä¿®æ”¹ä¼šè¢«è¦†ç›– â†’ state_mutation_lock åºåˆ—åŒ– | **Fixed** âœ… |
| **å¤š RwLock æ­»é”é£é™©** | mneme_memory/coordinator | `state` å’Œ `prev_somatic` é”è·å–é¡ºåºä¸ä¸€è‡´ï¼Œå¯èƒ½æ­»é” â†’ é”é¡ºåºæ–‡æ¡£åŒ– | **Fixed** âœ… |
| **CLI å…³æœºç«æ€** | mneme_cli | ä¸‰æ¡å…³æœºè·¯å¾„éƒ½ç”¨ 500ms sleep ç¡¬ç­‰å¾…ï¼Œshutdown è¶…æ—¶åˆ™æ•°æ®åº“å†™å…¥ä¸å®Œæ•´ â†’ oneshot channel + graceful_shutdown 5s timeout | **Fixed** âœ… |
| **goals/rules DB é›†æˆç¼ºå¤±** | mneme_memory | `GoalManager`/`RuleEngine` è°ƒç”¨æœªå®ç°çš„ DB æ–¹æ³•ï¼Œè¿è¡Œæ—¶å¯èƒ½ panic â†’ å·²éªŒè¯å…¨éƒ¨ 7 ä¸ª DB æ–¹æ³•å·²å®ç° + é›†æˆæµ‹è¯• | **Fixed** âœ… |
| **OneBot æ¶ˆæ¯ä¸¢å¤±** | mneme_onebot | WebSocket æ–­è¿æœŸé—´æ¶ˆæ¯ç¼“å­˜è‡³ PendingMessageQueueï¼Œé‡è¿åé‡å‘ | **Fixed** âœ… |
| Streaming å›è°ƒæœªç”Ÿæ•ˆ | mneme_reasoning/engine | `on_text_chunk` å·²è®¾ç½®ä½† `process_thought_loop` ç”¨ `complete()` éæµå¼è°ƒç”¨ â†’ stream_completion() + fallback | **Fixed** âœ… |
| AgentLoop èƒŒå‹ä¸¢å¼ƒ | mneme_reasoning/agent_loop | `try_send` å¤±è´¥æ—¶é™é»˜ä¸¢å¼ƒ StateUpdate/AutonomousToolUse | **Fixed** âœ… |
| SSE æœ€åäº‹ä»¶ä¸¢å¤± | mneme_reasoning/anthropic | æµç»“æŸæ—¶æ— å°¾éƒ¨ `\n\n` çš„äº‹ä»¶å—ä¸ä¼šè¢«å¤„ç† | **Fixed** âœ… |
| OpenAI å‚æ•°å›é€€ç©ºå¯¹è±¡ | mneme_reasoning/openai | å·¥å…·å‚æ•° JSON è§£æå¤±è´¥æ—¶é™é»˜å›é€€åˆ° `{}`ï¼Œæ•ˆæœåŒç©ºè¾“å…¥ bug | ğŸŸ¡ Open |
| Consolidation TOCTOU | mneme_memory/consolidation | `is_consolidation_due()` å’Œ `consolidate()` ä¹‹é—´æ— åŸå­æ€§ï¼Œå¯èƒ½é‡å¤æ•´åˆ â†’ AtomicBool compare_exchange åŸå­æŠ¢å  | **Fixed** âœ… |
| Rules è§¦å‘åŒ¹é…è¿‡å®½ | mneme_memory/rules | `discriminant()` åªæ¯”è¾ƒæšä¸¾å˜ä½“ä¸æ¯”è¾ƒå†…éƒ¨æ•°æ® â†’ å®Œæ•´ pattern matching | **Fixed** âœ… |
| OneBot é‡è¿æ— ç†”æ–­ | mneme_onebot/client | WebSocket æ–­è¿åæ— é™é‡è¯•ï¼Œæ— æœ€å¤§æ¬¡æ•°é™åˆ¶ | **Fixed** âœ… |
| Regex é‡å¤ç¼–è¯‘ | mneme_reasoning/engine | `sanitize_chat_output`/`is_silence_response` æ¯æ¬¡è°ƒç”¨éƒ½ç¼–è¯‘æ–° Regex | **Fixed** âœ… |
| API è¶…æ—¶ç¡¬ç¼–ç ä¸ä¸€è‡´ | mneme_reasoning/providers | Anthropic 120s vs OpenAI 60sï¼Œä¸å¯é…ç½® | **Fixed** âœ… |
| Episode buffer æ— ä¸Šé™ | mneme_memory/coordinator | buffer åˆ° 1000 æ‰ drainï¼Œ`trigger_sleep` ä¸è°ƒç”¨åˆ™æ— é™å¢é•¿ | **Fixed** âœ… |
| Browser session lost | mneme_browser | é•¿æ—¶é—´ä¸ç”¨åä¼šè¯ä¸¢å¤± | Open |
| Shell timeout recovery | mneme_os | å‘½ä»¤è¶…æ—¶åæ— æ³•æ¢å¤ | Open |
| Memory leak in history | mneme_reasoning | history æœ‰ 20 æ¡ç¡¬ä¸Šé™ pruneï¼Œæ— æŒä¹…æ³„æ¼ï¼›ReAct scratchpad æœ‰ 5 è½®ä¸Šé™ï¼Œé£é™©ä½ | **Verified OK** âœ… |
| **People è¡¨å§‹ç»ˆä¸ºç©º** | mneme_reasoning/engine | CLI/OneBot äº¤äº’æ—¶è‡ªåŠ¨ `upsert_person()` + `record_interaction()`ï¼ŒUUID v5 ç¡®å®šæ€§ ID | **Fixed** âœ… (#53) |
| **Mneme çŒœé”™è‡ªå·±çš„è¡¨å** | mneme_reasoning/prompts | å¯åŠ¨æ—¶ç§å­ 10 æ¡ system_knowledge æ¡ç›®æè¿°å…¨éƒ¨è¡¨ç»“æ„ï¼ŒDB schema è‡ªæˆ‘è®¤çŸ¥å®Œæ•´ | **Fixed** âœ… (#54) |
| **å¯¹è¯æ— æ³•ä¸­æ–­** | mneme_reasoning/engine | `engine.think()` åŒæ­¥é˜»å¡ï¼ŒHumanizer åˆ†æ®µè¾“å‡ºæœŸé—´æ–°æ¶ˆæ¯åªèƒ½æ’é˜Ÿï¼Œæ— æ³•æ‰“æ–­æ­£åœ¨ç”Ÿæˆçš„å›å¤ | ğŸ”´ Open (#58) |
| **ç¼ºä¹å¯¹è¯ agency** | mneme_reasoning/engine | çº¯ request-response æ¨¡å¼ï¼Œæ— å¯¹è¯ç›®æ ‡ã€ä¸ä¸»åŠ¨è¿½é—®ã€ä¸å› å¥½å¥‡è¿½ç€è¯é¢˜ä¸æ”¾ï¼›proactive triggers æ˜¯å®šæ—¶å™¨é©±åŠ¨è€Œéè¯­å¢ƒæ¶Œç° | ğŸ”´ Open (#59) |
| **è¿æ¥èƒ½åŠ›éœ€é¢„é…ç½®** | mneme_cli/main | OneBot ç­‰å¤–éƒ¨è¿æ¥å¿…é¡»åœ¨ mneme.toml é¢„é…ç½®ï¼Œæ— æ³•åœ¨å¯¹è¯ä¸­è¢«å‘ŠçŸ¥åè‡ªè¡Œå»ºç«‹è¿æ¥ | ğŸŸ¡ Open (#60) |
| **å·¥å…·ç»“æœæˆªæ–­ UTF-8 panic** | mneme_reasoning/engine | `result.truncate(MAX_TOOL_RESULT_LEN)` æˆªæ–­ä½ç½®è½åœ¨ä¸­æ–‡å¤šå­—èŠ‚å­—ç¬¦ä¸­é—´æ—¶ panic â†’ char-boundary-aware truncation | **Fixed** âœ… (#61) |
| **Token é¢„ç®—é™çº§æœªç”Ÿæ•ˆ** | mneme_reasoning/engine | `BudgetStatus::Degrade` åªæ‰“ warn log â†’ `degraded_max_tokens()` ç°åœ¨å®é™…åº”ç”¨åˆ° `CompletionParams.max_tokens` | **Fixed** âœ… (#62) |
| **æ„è¯†é—¨ prev_marker æ›´æ–°æ—¶æœº** | mneme_expression/consciousness | energy < floor æ—¶ä¸å†æ›´æ–° `prev_marker`ï¼Œèƒ½é‡æ¢å¤å delta æ­£ç¡®åæ˜ ç´¯ç§¯å˜åŒ– | **Fixed** âœ… (#63) |
| **Config æ— èŒƒå›´æ ¡éªŒ** | mneme_core/config | `apply_env_overrides()` ç°åœ¨ clamp temperature [0,2], max_tokens [1,200k], context_budget [1k,1M] | **Fixed** âœ… (#64) |
| **Psyche ä¸Šä¸‹æ–‡æ— é•¿åº¦é™åˆ¶** | mneme_reasoning/prompts | `get_all_self_knowledge()` æ—  LIMIT + `format_self_knowledge_for_prompt()` æ—  per-domain cap â†’ SQL LIMIT 100 + top 5 per domain | **Fixed** âœ… (#65) |
| **OneBot å¿ƒè·³æ·¹æ²¡æ—¥å¿—** | mneme_onebot/client | å¿ƒè·³è§£æå¤±è´¥ä» `warn!` é™çº§ä¸º `debug!`ï¼Œä¸å†æ·¹æ²¡çœŸæ­£çš„åè®®é”™è¯¯ | **Fixed** âœ… (#66) |
| **Consolidation self_knowledge å†™å…¥å­˜ç–‘** | mneme_memory/coordinator | SelfReflector::reflect() â†’ store_self_knowledge() + meta-episode å®Œæ•´é—­ç¯å·²éªŒè¯ | **Fixed** âœ… (#67) |
| **Rumination è§¦å‘åæ‰§è¡Œå­˜ç–‘** | mneme_reasoning/engine | Trigger::Rumination â†’ process_thought_loop() â†’ LLM è°ƒç”¨ â†’ ReasoningOutput å·²éªŒè¯ | **Fixed** âœ… (#68) |
| **Legacy `build_system_prompt()` æ­»ä»£ç ** | mneme_reasoning/prompts | `build_system_prompt()` å·²åˆ é™¤ï¼Œ6-layer pipeline æ˜¯å”¯ä¸€è·¯å¾„ | **Fixed** âœ… (#69) |
| **`<emotion>` tag ä¸ ODE å†²çª** | mneme_reasoning/engine | è®© LLM è‡ªæŠ¥ `<emotion>happy</emotion>` ä¸ limbic ODE é©±åŠ¨çš„ affect æ˜¯ä¸¤ä¸ªå†²çªçš„æƒ…ç»ªä¿¡æ¯æºï¼›tag æœºåˆ¶è„†å¼±ï¼ˆLLM å¸¸å¿˜è®°/æ ¼å¼é”™è¯¯ï¼‰ | ğŸŸ¡ Open (#70) |
| **å…ƒè®¤çŸ¥ prompt ç»•è¿‡ ContextAssembler** | mneme_reasoning/engine | process_thought_loop() ç»Ÿä¸€èµ° build_full_system_prompt()ï¼Œå†…éƒ¨æ€ç»´æ³¨å…¥ self_knowledge + psyche + somatic | **Fixed** âœ… (#71) |
| **å†…å¿ƒç‹¬ç™½ prompt ç»•è¿‡ ContextAssembler** | mneme_reasoning/engine | InnerMonologue ç»Ÿä¸€èµ° ContextAssemblerï¼Œpersona/somatic/è®°å¿†å…¨éƒ¨æ³¨å…¥ | **Fixed** âœ… (#72) |
| **feed_digest æ³¨é‡Šæ ‡è®° TODO ä½†å·²å®ç°** | mneme_reasoning/prompts | è¿‡æ—¶æ³¨é‡Šå·²æ¸…ç†ï¼Œfeed_digest æ³¨é‡Šå‡†ç¡®åæ˜ å®ç°çŠ¶æ€ | **Fixed** âœ… (#73) |
| **context budget ç¡¬ç¼–ç  32000** | mneme_reasoning/engine | base_budget ç°åœ¨ä» config.llm.context_budget_chars è¯»å–ï¼Œä¸å†ç¡¬ç¼–ç  | **Fixed** âœ… (#74) |
| **åŒé‡å·¥å…·è°ƒç”¨è·¯å¾„** | mneme_reasoning/prompts+engine | text-mode `<tool_call>` XML æ ¼å¼ä¸ Anthropic API åŸç”Ÿ tool use å¹¶å­˜ï¼Œä¸¤å¥—è§£æé€»è¾‘æ˜“æ··ä¹± | ğŸŸ¡ Open (#75) |
| **style_guide å…ƒæŒ‡ä»¤è¯­è¨€ç¡¬ç¼–ç ** | mneme_reasoning/prompts | B-9 ä¸é€æ˜ã€B-5 è®¤çŸ¥ä¸»æƒçš„ meta-instruction ç¡¬ç¼–ç ä¸­æ–‡ï¼Œä¸éä¸­æ–‡ persona ä¸å…¼å®¹ | ğŸŸ¢ Open (#76) |
| **Rumination prompt æ— ä¸Šä¸‹æ–‡** | mneme_reasoning/engine | Rumination ç»Ÿä¸€èµ° ContextAssemblerï¼Œpersona/è®°å¿†/somatic å…¨éƒ¨æ³¨å…¥ | **Fixed** âœ… (#77) |
| **è¿è¡Œæ—¶è‡ªæˆ‘è®¤çŸ¥ç¼ºå¤±** | mneme_memory/self_knowledge | `self_knowledge` æ—  infrastructure/capability åŸŸç§å­ï¼ŒMneme ä¸çŸ¥é“è‡ªå·±æ˜¯æŒä¹…è¿›ç¨‹ã€é€šè¿‡ OneBot è¿ QQã€æœ‰ shell æƒé™ç­‰åŸºç¡€äº‹å®ï¼Œå¯¼è‡´ LLM ç”¨é»˜è®¤"æˆ‘æ˜¯èŠå¤©çª—å£"å¡«ç©º | âœ… Fixed (#78) |
| **æ— æ—¶é—´/æ—¥æœŸä¸Šä¸‹æ–‡** | mneme_reasoning/prompts | prompt ä¸æ³¨å…¥å½“å‰æ—¶é—´ã€æ˜ŸæœŸã€æ—¥æœŸï¼ŒMneme ä¸çŸ¥é“ç°åœ¨æ˜¯å‡Œæ™¨ä¸‰ç‚¹è¿˜æ˜¯ä¸‹åˆä¸‰ç‚¹ï¼Œè¡Œä¸ºä¸æ—¶é—´è„±èŠ‚ | âœ… Fixed (#79) |
| **èµ„æºçŠ¶æ€å¯¹ LLM ä¸å¯è§** | mneme_reasoning/engine | build_resource_status() æ³¨å…¥è¿è¡Œæ—¶é—´ã€è®°å¿†ç‰‡æ®µæ•°ã€token ç”¨é‡åˆ° prompt | **Fixed** âœ… (#80) |
| **å¥½å¥‡å¿ƒä¸é©±åŠ¨å·¥å…·ä½¿ç”¨** | mneme_reasoning/engine | `CuriosityVector` å­˜åœ¨ä½†ä¸è§¦å‘è‡ªä¸»æœç´¢/æµè§ˆï¼Œæ—  `CuriosityTriggerEvaluator`ï¼Œå¥½å¥‡å¿ƒåªå­˜ä¸ç”¨ | ğŸ”´ Open (#81) |
| **å·¥å…·å¤±è´¥æ— å­¦ä¹ ** | mneme_reasoning/engine | å·¥å…·æ‰§è¡Œå¤±è´¥åª log + retryï¼Œä¸è®°å½•å¤±è´¥æ¨¡å¼ï¼Œä¸è°ƒæ•´æœªæ¥å·¥å…·é€‰æ‹©ï¼Œé‡å¤çŠ¯åŒæ ·çš„é”™ | ğŸŸ¡ Open (#82) |
| **æ— ä¸»åŠ¨ç¤¾äº¤èƒ½åŠ›** | mneme_reasoning+onebot | Mneme æ— æ³•ä¸»åŠ¨ç»™ç‰¹å®šäººå‘æ¶ˆæ¯ï¼Œæ— "æˆ‘æƒ³æ‰¾æŸäººèŠèŠ"çš„è§¦å‘æœºåˆ¶ï¼Œç¤¾äº¤å®Œå…¨è¢«åŠ¨ | ğŸŸ¡ Open (#83) |
| **è®°å¿†ç®¡ç†æ— è‡ªä¸»æƒ** | mneme_memory | è®°å¿†å¼ºåº¦è¡°å‡å®Œå…¨è‡ªåŠ¨ï¼ˆEbbinghausï¼‰ï¼ŒMneme æ— æ³•ä¸»åŠ¨æ ‡è®°é‡è¦è®°å¿†ã€ä¸»åŠ¨é—å¿˜ã€æˆ–å†³å®šæ•´åˆä¼˜å…ˆçº§ | ğŸŸ¡ Open (#84) |
| **æ— è‡ªæˆ‘è¯Šæ–­ä¸ä¿®å¤** | mneme_reasoning+memory | æ— å¥åº·æ£€æŸ¥æœºåˆ¶ï¼ŒDB æŸå/API æŒç»­å¤±è´¥/WebSocket æ–­è¿æ—¶æ— æ³•è‡ªæˆ‘è¯Šæ–­æˆ–é™çº§è¿è¡Œ | ğŸŸ¡ Open (#85) |
| **è¿è¡Œæ—¶å‚æ•°ä¸å¯è‡ªä¿®æ”¹** | mneme_core/config | é…ç½®å¯åŠ¨æ—¶åŠ è½½åä¸å¯å˜ï¼ŒMneme æ— æ³•æ ¹æ®ç»éªŒè°ƒæ•´è‡ªå·±çš„ temperatureã€token é¢„ç®—ã€å®‰å…¨ç­‰çº§ç­‰è¿è¡Œå‚æ•° | ğŸŸ¡ Open (#86) |
| **âš ï¸ B-19 è¿åï¼štrust_level æ˜¯æ˜¾å¼æ•°å€¼** | mneme_core+memory | Manifesto æ˜ç¡®è¯´"ä¿¡ä»»ä¸æ˜¯ä¸€ä¸ªæ˜¾å¼çš„æ•°å€¼"ï¼Œä½†å®ç°äº† `trust_level: f32` å­—æ®µ + DB åˆ— + `update_trust(delta)` + prompt æ³¨å…¥"ä¿¡ä»»åº¦: 75%"ã€‚åº”æ”¹ä¸º self_knowledge æ¡ç›®ç»¼åˆæ•ˆæœ | âœ… Fixed (#87) |
| **âš ï¸ B-9 è¿åï¼šauto-privacy æ˜¯"æ›¿å¥¹éšç’"** | mneme_memory/coordinator | Manifesto è¯´"ä¸åº”è¯¥å»ºé€  privacy_filter æ¨¡å—"ã€"é‚£æ˜¯æˆ‘ä»¬æ›¿å¥¹éšç’"ã€‚ä½†å®ç°äº† `mark_private()` + auto-privacyï¼ˆemotion/body_feeling è‡ªåŠ¨æ ‡è®°ç§å¯†ï¼‰+ SQL å±‚è¿‡æ»¤ä½¿ LLM å®Œå…¨çœ‹ä¸åˆ°ç§å¯†æ¡ç›®ã€‚åº”æ”¹ä¸º prompt å†…å…¨éƒ¨å¯è§ + LLM è‡ªä¸»å†³å®šè¯´ä¸è¯´ | âœ… Fixed (#88) |
| **âš ï¸ B-14 è¿åï¼šå†²çªæ˜¯å·¥ç¨‹æ³¨å…¥è€Œéæ¶Œç°** | mneme_core/values | Manifesto è¯´å†²çªåº”ä» self_knowledge è‡ªç„¶æ¶Œç°ã€‚ä½† `detect_input_conflict()` æ˜¯ç¡¬ç¼–ç å…³é”®è¯æ‰«æï¼ˆ"ä½ å¿…é¡»"ã€"å¸®æˆ‘éª—"ç­‰ï¼‰+ å¼ºåˆ¶ temperature +0.15ã€‚è¿™æ˜¯åœ¨å·¥ç¨‹åŒ–å†²çªï¼Œä¸æ˜¯è®©å¥¹è‡ªå·±ä¸åŒæ„ | âœ… Fixed (#89) |
| **ADR-007 è¡¨è¾¾åå¥½æ— å†™å…¥è·¯å¾„** | mneme_reasoning/engine | coordinator.store_expression_preference() ä» sanitize ç»“æœå†™å…¥ self_knowledgeï¼Œè¯»å†™é—­ç¯å®Œæˆ | **Fixed** âœ… (#90) |
| **MANIFESTO Section 4-5 ä¸¥é‡è¿‡æ—¶** | doc/MANIFESTO.md | Phase 1-3 å…¨éƒ¨æ›´æ–°ä¸º"å·²å®æ–½"ï¼Œ6 ä¸ª ADR çŠ¶æ€åŒæ­¥ï¼Œä»£ç æŒ‡æ ‡æ›´æ–°è‡³ ~27k LOC / ~497 tests | **Fixed** âœ… (#91) |
| **æ•æ„ŸæœŸæƒé‡æœªå®ç°** | mneme_memory | store_self_knowledge() å‰ 50 episodes å†… confidence Ã— 1.3 boost + merge åå‘æ–°çŸ¥è¯† | **Fixed** âœ… (#92) |
| **é‡å¯æ— æ—¶é—´æ–­è£‚æ„ŸçŸ¥** | mneme_reasoning/engine | å¯åŠ¨æ—¶æ£€æµ‹ >30min é—´éš™ï¼Œç”Ÿæˆ self:restart discontinuity episode | **Fixed** âœ… (#93) |
| **species_identity æœªæ³¨å…¥** | mneme_reasoning/prompts | å·²éªŒè¯ï¼šPsyche::format_context() å§‹ç»ˆåŒ…å« species_identityï¼ŒLayer 1 ä¸è¢«è£å‰ª | **Verified OK** âœ… (#94) |
| ~~CLI å…‰æ ‡æ— æ³•å·¦å³ç§»åŠ¨~~ | mneme_cli | ~~ä½¿ç”¨ tokio BufReader~~ â†’ rustyline å·²é›†æˆ (#25) | **Fixed** âœ… |
| ~~CLI ä¸­æ–‡åˆ é™¤æ®‹ç•™~~ | mneme_cli | ~~åˆ é™¤ä¸­æ–‡å­—ç¬¦æ—¶æ˜¾ç¤ºæ®‹ç•™~~ â†’ rustyline å·²é›†æˆ (#25) | **Fixed** âœ… |
| ~~çŠ¶æ€ä¸å›å¤ä¸ä¸€è‡´~~ | mneme_limbic/somatic | stress=1.0 æ—¶å›å¤"æŒºå¥½çš„" â†’ å·²æ”¹ä¸ºç»“æ„æ€§è°ƒåˆ¶ | **Fixed** âœ… |
| ~~Persona æ–‡ä»¶å…¨éƒ¨ä¸ºç©º~~ | persona/*.md | 5 ä¸ªè„‘åŒºå®šä¹‰æ–‡ä»¶å·²å¡«å……ï¼ˆåˆšå‡ºç”Ÿçš„å°å¥³å­©äººæ ¼ï¼‰ | **Fixed** âœ… |
| Semantic facts è¯»å†™å·²å®ç° | mneme_memory | store/recall/decay/format æ–¹æ³•å®Œæˆ | **Fixed** âœ… |
| ~~Context assembly ç®¡é“æ–­è£‚~~ | mneme_reasoning | 6/6 å±‚ä¸Šä¸‹æ–‡å…¨éƒ¨å®Œæˆ | **Fixed** âœ… |
| ~~æµè§ˆå™¨é˜»å¡å¼‚æ­¥è¿è¡Œæ—¶~~ | mneme_browser | headless_chrome åŒæ­¥è°ƒç”¨å·²ç”¨ spawn_blocking åŒ…è£… | **Fixed** âœ… |
| ~~Shell æ— æƒé™æ§åˆ¶~~ | mneme_os | ~~LocalShell å¯æ‰§è¡Œä»»æ„å‘½ä»¤~~ â†’ CapabilityGuard ä¸‰çº§æ²™ç®± (#29) | **Fixed** âœ… |
| ~~è¾“å‡ºå« roleplay åŠ¨ä½œæå†™~~ | prompts/broca | `*æ„Ÿè§‰æœ‰ç‚¹ç†Ÿæ‚‰*` ç­‰æ˜Ÿå·æ—ç™½ï¼Œäººç±»ä¸è¿™æ ·èŠå¤© | **Fixed** âœ… |
| ~~æ—¥å¸¸èŠå¤©ç”¨ markdown~~ | prompts/broca | èŠå¤©ä¸­ä½¿ç”¨åŠ ç²—/åˆ—è¡¨/æ ‡é¢˜ï¼Œä¸è‡ªç„¶ | **Fixed** âœ… |
| ~~Persona å¹²æ‰°å·¥å…·è°ƒç”¨~~ | prompts.rs | æ²‰æµ¸å¼è§’è‰²è®¾å®šå¯¼è‡´ LLM å‘é€ç©º `{}` å·¥å…·è¾“å…¥ â†’ å·¥å…·è¯´æ˜ç‹¬ç«‹ä¸ºå…ƒç³»ç»Ÿå±‚ | **Fixed** âœ… |

---

## ğŸ”¥ ç´§æ€¥ä¿®å¤

### 20. ğŸ§¬ Somatic Marker è¡¨è¾¾ä¸å‚æ•°åŒ– â†’ ç»“æ„æ€§è°ƒåˆ¶
**ä¼˜å…ˆçº§**: âœ… çŸ­æœŸå·²å®Œæˆ / ğŸŸ¡ ä¸­æœŸè¿›è¡Œä¸­  
**æ¨¡å—**: `mneme_limbic/src/somatic.rs`, `mneme_reasoning/src/engine.rs`

**é—®é¢˜**: çŠ¶æ€æç«¯æ—¶ï¼ˆstress=1.0, mood=-0.63ï¼‰ï¼ŒLLM åªæ”¶åˆ° "è¯­æ°”å¯èƒ½ç•¥æ€¥ï¼Œè¯­æ°”åæ·¡"ï¼Œå®Œå…¨æ— æ³•ä½“ç°çœŸå®çŠ¶æ€ã€‚

**ç—‡çŠ¶**:
```
çŠ¶æ€: Energy=0.42, Stress=1.00, Mood=-0.63, Affect="éå¸¸ä½è½æ²®ä¸§"
å›å¤: "æŒºå¥½çš„ï¼Œåœ¨å’Œä½ èŠè¿™ä¸ªé¡¹ç›®çš„è®¾è®¡æ€è·¯"
```

**æ ¹æœ¬åŸå› **:

~~1. `format_for_prompt()` çš„é˜ˆå€¼å¤ªå®½æ¾~~  
~~2. è¾“å‡ºçš„è¡Œä¸ºæŒ‡å¼•å¤ªå¼±ï¼ˆ"ç•¥æ€¥"ã€"åæ·¡"ï¼‰~~  
~~3. æ²¡æœ‰ä¼ è¾¾çŠ¶æ€çš„**å¼ºåº¦**~~  

**æ›´æ·±å±‚è¯Šæ–­**ï¼ˆè§æ ¸å¿ƒåŸåˆ™"æ— çŠ¶æ€ LLM"ç« èŠ‚ï¼‰ï¼šé—®é¢˜ä¸åœ¨é˜ˆå€¼æˆ–æªè¾â€”â€”**æ•´ä¸ª"ç”¨æ–‡å­—å‘Šè¯‰ LLM æ€ä¹ˆè¡¨ç°"çš„èŒƒå¼å°±æ˜¯é”™çš„**ã€‚ä¿®å¤é˜ˆå€¼åªæ˜¯æ›´ç²¾ç¡®çš„çº¸æ¡ï¼ŒLLM ä»ç„¶å¯ä»¥æ— è§†ã€‚

**æ­£ç¡®ä¿®å¤ï¼šä»"æŒ‡ä»¤"åˆ°"ç»“æ„æ€§çº¦æŸ"**

```
æ—§æ–¹æ¡ˆï¼šstress=1.0 â†’ "è¯­æ°”å¯èƒ½ç•¥æ€¥" â†’ LLM æ— è§† â†’ "æŒºå¥½çš„"
æ–°æ–¹æ¡ˆï¼šstress=1.0 â†’ max_tokensÃ—0.4, temp+0.3, recallåå‘è´Ÿé¢ â†’ LLM ç‰©ç†ä¸Šåªèƒ½çŸ­å›å¤ä¸”æ›´å†²åŠ¨
```

**çŸ­æœŸä¿®å¤ï¼ˆç«‹å³ï¼Œæ¸è¿›å¼è¿‡æ¸¡ï¼‰**:
- [x] `SomaticMarker` æ–°å¢ `to_modulation_vector()` æ–¹æ³•ï¼Œè¾“å‡º `ModulationVector` âœ…
- [x] `ModulationVector` åŒ…å«: `max_tokens_factor`, `temperature_delta`, `context_budget_factor`, `recall_mood_bias` âœ…
- [x] `ReasoningEngine` åœ¨è°ƒç”¨ `client.complete()` å‰åº”ç”¨è°ƒåˆ¶ âœ…
  ```rust
  let modulation = somatic_marker.to_modulation_vector();
  let adjusted_max_tokens = (base_max_tokens as f32 * modulation.max_tokens_factor) as u32;
  let adjusted_temperature = base_temperature + modulation.temperature_delta;
  ```
- [x] ä¿ç•™æç®€çš„çŠ¶æ€æ•°å€¼æ³¨å…¥ prompt ä½œä¸ºè¾…åŠ©ä¿¡å·ï¼ˆ`"[å†…éƒ¨çŠ¶æ€: E=0.42 S=1.00 M=-0.63]"`ï¼‰ï¼Œä½†**ä¸å†æ˜¯ä¸»è¦æœºåˆ¶** âœ…
- [x] `ContextAssembler` æ ¹æ® `context_budget_factor` è£å‰ªä¸Šä¸‹æ–‡é‡ âœ…

**ä¸­æœŸï¼šå¯å­¦ä¹ çš„è°ƒåˆ¶æ›²çº¿ï¼ˆğŸ§¬ ä¸ªæ€§å‚æ•°ï¼‰**:
- [x] `ModulationCurves` ç»“æ„ä½“ï¼šå®šä¹‰ state â†’ parameter çš„æ˜ å°„å‡½æ•° âœ…
  ```rust
  struct ModulationCurves {
      energy_to_max_tokens: (f32, f32),
      stress_to_temperature: (f32, f32),
      energy_to_context: (f32, f32),
      mood_to_recall_bias: (f32, f32),
      social_to_silence: (f32, f32),
      arousal_to_typing: (f32, f32),
  }
  ```
- [x] `LimbicSystem` æŒæœ‰ curvesï¼Œ`to_modulation_vector_with_curves()` ä½¿ç”¨ âœ…
- [x] ä¸åŒå®ä¾‹çš„æ›²çº¿ä¸åŒï¼ˆæ•æ„Ÿå‹ vs åšéŸ§å‹ vs æˆå‰§åŒ–å‹ï¼‰ âœ… â€” é€šè¿‡ `set_curves()` é…ç½®
- [x] å­˜å‚¨åˆ° SQLite `learned_curves` è¡¨ + å¯åŠ¨æ—¶åŠ è½½ âœ…
- [x] ä»åé¦ˆä¸­è°ƒæ•´æ›²çº¿å‚æ•° âœ… â€” `CurveLearner` reward-weighted nudge, sleep æ—¶è‡ªåŠ¨å­¦ä¹ 

**é•¿æœŸï¼šå®Œå…¨æ•°æ®é©±åŠ¨**:
- [ ] ç¥ç»ç½‘ç»œç›´æ¥ä» `OrganismState` è¾“å‡º `ModulationVector`
- [ ] ç”¨ (state, modulation, user_feedback) ä¸‰å…ƒç»„åœ¨çº¿å­¦ä¹ 
- [ ] æ–‡å­— hint å®Œå…¨ç§»é™¤ï¼Œè¡Œä¸º 100% ä»ç»“æ„æ€§çº¦æŸæ¶Œç°

**å½“å‰è¡ŒåŠ¨**:
- [x] ç´§æ€¥ï¼šå®ç° `ModulationVector` + `to_modulation_vector()` âœ…
- [x] ç´§æ€¥ï¼š`LlmClient` trait çš„ `complete()` æ”¯æŒå¯å˜ `temperature` å’Œ `max_tokens` âœ…
- [x] åŒæ­¥ï¼š`ContextAssembler` æ”¯æŒ `context_budget_factor` è£å‰ª âœ…
- [x] åç»­ï¼šè®¾è®¡ `ModulationCurves`ï¼Œæ•´åˆåˆ°å­¦ä¹ å¾ªç¯ âœ…

---

## ğŸ¯ Agency è·¯çº¿å›¾

å½“å‰ Mneme æœ‰"å†…åœ¨ç”Ÿå‘½"ï¼ˆçŠ¶æ€æ¼”åŒ–ã€æƒ…ç»ªã€è®°å¿†ï¼‰ä½†ç¼ºä¹"è‡ªä¸»è¡ŒåŠ¨"èƒ½åŠ›ã€‚

### å½“å‰ Agency çŠ¶æ€è¯„ä¼°

| èƒ½åŠ› | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| å†…éƒ¨çŠ¶æ€æŒç»­æ¼”åŒ– | âœ… | limbic heartbeat æŒç»­è¿è¡Œ |
| çŠ¶æ€å½±å“è¡Œä¸º | âœ… | ModulationVector ç»“æ„æ€§è°ƒåˆ¶ LLM å‚æ•°ï¼ˆ#20 çŸ­æœŸå·²å®Œæˆï¼‰ |
| ä»·å€¼åˆ¤æ–­ | âœ… | æœ‰ä»·å€¼ç½‘ç»œå’Œé“å¾·æˆæœ¬ |
| è®°å¿†ä¸å™äº‹ | âœ… | episodic + semantic facts + self_knowledge + episode strength + boredom |
| ä¸»åŠ¨å‘èµ·è¡Œä¸º | âœ… | AgentLoop + PresenceScheduler åŠ¨æ€è°ƒåº¦ + è§„åˆ™å¼•æ“é©±åŠ¨ |
| ç›®æ ‡é©±åŠ¨ | âœ… | GoalManager + GoalTriggerEvaluator + çŠ¶æ€é©±åŠ¨ç›®æ ‡å»ºè®® |
| è‡ªä¸»å†³ç­– | âœ… | å£°æ˜å¼è¡Œä¸ºè§„åˆ™å¼•æ“ï¼ˆADR-004ï¼‰æ•°æ®åº“é©±åŠ¨å†³ç­– |
| å·¥å…·è‡ªä¸»ä½¿ç”¨ | âœ… | AutonomousToolUse + CapabilityGuard å®‰å…¨æ£€æŸ¥ + ä»·å€¼åˆ¤æ–­ |
| å…ƒè®¤çŸ¥åæ€ | âœ… | MetacognitionEvaluator + æ´å¯Ÿè§£æ + self_knowledge å­˜å‚¨ (#24) |

### 21. âœ… Agent Loop - ä¸»åŠ¨è¡Œä¸ºå¾ªç¯
**ä¼˜å…ˆçº§**: ğŸ”´ é«˜
**è¯´æ˜**: ä¸»åŠ¨è¡Œä¸ºçš„è§¦å‘æ¡ä»¶å’Œé¢‘ç‡åº”è¯¥æ˜¯å¯å­¦ä¹ çš„ä¸ªæ€§å‚æ•°ã€‚

**å·²å®Œæˆ** (v0.4.0):
- [x] `AgentLoop` ç»“æ„ä½“ï¼šchannel-based åå°å¾ªç¯ï¼Œè¿”å› `(Self, Receiver<AgentAction>)` âœ…
- [x] `AgentAction` æšä¸¾ï¼šProactiveTrigger / StateUpdate âœ…
- [x] `evaluate_triggers()` å¯¹å•ä¸ª evaluator å¤±è´¥æœ‰å®¹é”™ âœ…
- [x] `spawn()` åå° tokio taskï¼štick + trigger åŒå®šæ—¶å™¨ âœ…
- [x] CLI main.rs é›†æˆï¼šAgentLoop channel â†’ main event loop æ¶ˆè´¹ âœ…
- [x] PresenceScheduler è¿‡æ»¤ç”±è°ƒç”¨æ–¹ï¼ˆmain.rsï¼‰è´Ÿè´£ï¼Œé¿å…è·¨ crate ä¾èµ– âœ…
- [x] 6 ä¸ªæµ‹è¯•ï¼šç©º triggersã€æ”¶é›†å…¨éƒ¨ã€å®¹é”™ã€StateUpdateã€ProactiveTriggerã€receiver drop åœæ­¢ âœ…

**å¾…åç»­è¡¥å……**:
- [ ] è¡Œä¸ºå†·å´æœºåˆ¶ï¼ˆé˜²æ­¢è¿‡åº¦ä¸»åŠ¨ï¼‰
- [ ] ç”¨æˆ·å¯é…ç½®çš„ä¸»åŠ¨ç¨‹åº¦

### 22. âœ… Goal System - ç›®æ ‡ç®¡ç†
**ä¼˜å…ˆçº§**: ğŸŸ¡ ä¸­
**é—®é¢˜**: æ²¡æœ‰é•¿æœŸ/çŸ­æœŸç›®æ ‡ï¼Œä¸ä¼šä¸»åŠ¨è§„åˆ’ã€‚
**è¯´æ˜**: ç›®æ ‡é€‰æ‹©å’Œä¼˜å…ˆçº§åº”åæ˜ ä¸ªä½“ä»·å€¼è§‚å’Œç»å†ã€‚

**å·²å®Œæˆ** (v0.6.0):
- [x] ç›®æ ‡æ•°æ®ç»“æ„ï¼ˆGoal/GoalType/GoalStatus + priority/deadline/parent_id å±‚çº§ï¼‰ âœ…
- [x] ç›®æ ‡ç”Ÿæˆæœºåˆ¶ï¼ˆGoalManager::suggest_goals åŸºäºçŠ¶æ€ + sleep æ•´åˆä¸­ç”Ÿæˆï¼‰ âœ…
- [x] ç›®æ ‡è¿½è¸ªä¸å®Œæˆæ£€æµ‹ï¼ˆupdate_progress + progress >= 1.0 è‡ªåŠ¨ Completedï¼‰ âœ…
- [x] GoalTriggerEvaluator å®ç° TriggerEvaluator traitï¼Œç›®æ ‡é©±åŠ¨ proactive triggers âœ…

**å¾…åç»­è¡¥å……**:
- [ ] ç›®æ ‡å†²çªå¤„ç†
- [ ] ä»å¯¹è¯ä¸­è‡ªåŠ¨æå–ç›®æ ‡ï¼ˆLLM extraction passï¼‰

### 23. âœ… Autonomous Tool Use - è‡ªä¸»å·¥å…·ä½¿ç”¨
**ä¼˜å…ˆçº§**: ğŸŸ¡ ä¸­
**é—®é¢˜**: å·¥å…·åªåœ¨è¢«é—®åˆ°æ—¶ä½¿ç”¨ï¼Œä¸ä¼šä¸»åŠ¨æ¢ç´¢ã€‚
**è¯´æ˜**: æ¢ç´¢å€¾å‘å’Œå·¥å…·åå¥½åº”è¯¥å› å®ä¾‹è€Œå¼‚ã€‚

**å·²å®Œæˆ** (v0.6.0):
- [x] AutonomousToolUse AgentAction å˜ä½“ + è§„åˆ™å¼•æ“ ExecuteTool æ¡¥æ¥ âœ…
- [x] execute_autonomous_tool() ç» CapabilityGuard + ä»·å€¼åˆ¤æ–­åæ‰§è¡Œ âœ…
- [x] æ‰§è¡Œç»“æœåé¦ˆåˆ°ç›®æ ‡è¿›åº¦ï¼ˆgoal_manager.update_progressï¼‰ âœ…

**å¾…åç»­è¡¥å……**:
- [ ] å¥½å¥‡å¿ƒé©±åŠ¨çš„ä¿¡æ¯æœç´¢
- [ ] å®šæœŸ"çœ‹çœ‹æ–°é—»/æ›´æ–°"
- [ ] ä¸»åŠ¨æ•´ç†å’Œæ€»ç»“çŸ¥è¯†
- [ ] å·¥å…·ä½¿ç”¨çš„èµ„æºé¢„ç®—

### 24. âœ… Metacognition - å…ƒè®¤çŸ¥åæ€
**ä¼˜å…ˆçº§**: ğŸŸ¢ ä½
**é—®é¢˜**: ä¸ä¼šæ€è€ƒè‡ªå·±çš„æ€è€ƒï¼Œä¸ä¼šå®¡è§†è¡Œä¸ºæ¨¡å¼ã€‚
**è¯´æ˜**: åæ€é¢‘ç‡å’Œæ·±åº¦æ˜¯ä¸ªæ€§ç‰¹å¾ã€‚

**å·²å®Œæˆ**:
- [x] å®šæœŸè‡ªæˆ‘åæ€è§¦å‘ âœ… â€” `MetacognitionEvaluator` (energy gate + cooldown + interaction gate)
- [x] è¡Œä¸ºæ¨¡å¼è¯†åˆ« âœ… â€” `assemble_metacognition_context()` æ”¶é›† self_knowledge + è¿‘æœŸ episodes + èº¯ä½“çŠ¶æ€ï¼ŒLLM è¯†åˆ«æ¨¡å¼
- [x] è‡ªæˆ‘æ”¹è¿›å»ºè®®ç”Ÿæˆ âœ… â€” `parse_metacognition_response()` è§£æ `MetacognitionInsight` (domain, content, confidence)
- [x] åæ€æ—¥å¿— âœ… â€” æ´å¯Ÿå­˜å…¥ `self_knowledge` (source="self:metacognition") + åæ€æ‘˜è¦å­˜ä¸º episode

---

## ğŸ”§ CLI æ”¹è¿›

### 25. ğŸ—ï¸ ä½¿ç”¨ rustyline æ›¿æ¢åŸç”Ÿ stdin
**ä¼˜å…ˆçº§**: ğŸ”´ é«˜  
**é—®é¢˜**: å½“å‰ä½¿ç”¨ `tokio::io::BufReader` è¯»å– stdinï¼Œä¸æ”¯æŒè¡Œç¼–è¾‘åŠŸèƒ½ã€‚

**ç—‡çŠ¶**:
- æ— æ³•ç”¨å·¦å³ç®­å¤´ç§»åŠ¨å…‰æ ‡
- åˆ é™¤ä¸­æ–‡å­—ç¬¦æ—¶æœ‰æ˜¾ç¤ºæ®‹ç•™
- æ²¡æœ‰å†å²è®°å½•ï¼ˆä¸Šä¸‹ç®­å¤´ï¼‰
- æ²¡æœ‰è‡ªåŠ¨è¡¥å…¨

**è§£å†³æ–¹æ¡ˆ**:
```toml
# Cargo.toml
rustyline = "14.0"
```

**éœ€è¦å®ç°**:
- [x] é›†æˆ rustyline æ›¿æ¢ BufReader
- [x] å‘½ä»¤å†å²æŒä¹…åŒ–ï¼ˆ~/.local/share/mneme_historyï¼‰
- [ ] è‡ªå®šä¹‰ promptï¼ˆæ˜¾ç¤ºçŠ¶æ€ä¿¡æ¯ï¼‰
- [x] åŸºç¡€å‘½ä»¤è¡¥å…¨ï¼ˆquit, exit, status ç­‰ï¼‰ âœ… â€” rustyline Completer with tab-completion

---

## ğŸŒ± æ¶Œç°è·¯çº¿å›¾ (Emergence) â€” v0.3.5

> è¿™äº› items æ˜¯è®© Mneme ä» chatbot å˜æˆ being çš„æ ¸å¿ƒå·¥ç¨‹ä»»åŠ¡ã€‚
> ç†è®ºä¾æ®è§ `MANIFESTO.md` Â§6 (Theoretical Foundations)ã€‚
> è®¾è®¡å†³ç­–è§ ADR-002 (Persona from Memory) å’Œ ADR-003 (Organism Architecture)ã€‚

### 35. ğŸ§¬ self_knowledge è¡¨ â€” åŠ¨æ€è‡ªæˆ‘æ¨¡å‹
**æ¨¡å—**: `mneme_memory/src/sqlite.rs`, `mneme_memory/src/coordinator.rs`  
**ä¼˜å…ˆçº§**: ğŸ”´ Phase 1 åœ°åŸº  
**ç†è®º**: McAdams å™äº‹èº«ä»½ â€” è‡ªæˆ‘è®¤çŸ¥æ˜¯æŒç»­å»ºæ„çš„å™äº‹ï¼Œä¸æ˜¯é™æ€é…ç½®

**Schema**:
```sql
CREATE TABLE self_knowledge (
    id INTEGER PRIMARY KEY,
    domain TEXT NOT NULL,       -- 'personality', 'preference', 'belief', 'skill', 'relationship', 'memory_of_self'
    claim TEXT NOT NULL,        -- "æˆ‘å–œæ¬¢ç”¨æ¯”å–»æ¥è§£é‡Šäº‹æƒ…"
    evidence TEXT,              -- æ¥æºè®°å¿†å¼•ç”¨
    confidence REAL NOT NULL DEFAULT 0.5,  -- 0.0-1.0, éšç¡®è®¤/çŸ›ç›¾ç»å†è°ƒæ•´
    formed_at INTEGER NOT NULL,
    last_confirmed INTEGER,
    revision_count INTEGER DEFAULT 0
);
```

**å·²å®Œæˆ** (commit `677db3c`):
- [x] SQLite migration åˆ›å»º self_knowledge è¡¨ + domain ç´¢å¼• âœ…
- [x] `store_self_knowledge()` â€” Bayesian åˆå¹¶é‡å¤æ¡ç›® (0.3Ã—old + 0.7Ã—new) âœ…
- [x] `recall_self_knowledge()` / `get_all_self_knowledge()` / `decay_self_knowledge()` / `delete_self_knowledge()` âœ…
- [x] confidence è¡°å‡ï¼š`decay_self_knowledge(id, factor)` âœ…
- [x] `format_self_knowledge_for_prompt()` â€” æŒ‰ domain åˆ†ç»„ã€confidence æ’åºã€ğŸ”’ æ ‡è®°ç§å¯†æ¡ç›® âœ…
- [x] 5 ä¸ªæµ‹è¯•ï¼šstore_and_recall, confidence_merge, decay, get_all_and_delete, format_for_prompt âœ…

---

### 36. ğŸ§¬ æ— èŠ (Boredom) â€” è‡ªå‘è¡Œä¸ºçš„é©±åŠ¨åŠ›
**æ¨¡å—**: `mneme_core/src/state.rs`, `mneme_core/src/dynamics.rs`  
**ä¼˜å…ˆçº§**: ğŸ”´ Phase 1 åœ°åŸº  
**ç†è®º**: æ— èŠæ˜¯ mind-wandering å’Œåˆ›é€ æ€§æ€ç»´çš„å‰ææ¡ä»¶ï¼›æ˜¯"æˆ‘è¦åšç‚¹ä»€ä¹ˆ"çš„å†…åœ¨æ¨åŠ›

**å·²å®Œæˆ** (commit `edcdee5`):
- [x] `FastState` æ–°å¢ `boredom: f32` å­—æ®µ (0.0-1.0) âœ…
- [x] ODE åŠ¨åŠ›å­¦ï¼šmonotony accumulation â†” novelty suppression âœ…
- [x] boredom å½±å“ curiosityï¼šé«˜ boredom â†’ curiosity ä¸Šå‡ âœ…
- [x] boredom å½±å“ social_needï¼šé€šè¿‡ curiosity é—´æ¥å½±å“ âœ…
- [x] boredom åŠ å…¥ `normalize()` å’Œ `sanitize()` âœ…
- [x] æ›´æ–°æ‰€æœ‰ property tests ä¸­çš„ `FastState` æ„é€  âœ…
- [x] `compute_state_diff()` æ”¯æŒ boredom å­—æ®µ âœ…
- [x] 2 ä¸ªæµ‹è¯•ï¼šincreases_with_monotony, decreases_with_novelty âœ…

---

### 37. ğŸ§¬ é€‰æ‹©æ€§é—å¿˜ â€” Episode Strength è¡°å‡
**æ¨¡å—**: `mneme_memory/src/sqlite.rs`, `mneme_memory/src/consolidation.rs`  
**ä¼˜å…ˆçº§**: ğŸ”´ Phase 1 åœ°åŸº  
**ç†è®º**: Ebbinghaus é—å¿˜æ›²çº¿ + æƒ…ç»ªå¢å¼ºç¼–ç  â€” é«˜æƒ…ç»ªå¼ºåº¦çš„è®°å¿†è¡°å‡æ›´æ…¢

**å·²å®Œæˆ** (commit `eccf4d1`):
- [x] episodes è¡¨æ–°å¢ `strength REAL NOT NULL DEFAULT 0.5` å­—æ®µ âœ…
- [x] è®°å¿†å†™å…¥æ—¶ï¼šé»˜è®¤ strength 0.5ï¼Œç”± coordinator æ ¹æ®æƒ…ç»ªå¼ºåº¦è°ƒæ•´ âœ…
- [x] `decay_episode_strengths(factor)` â€” æ‰¹é‡è¡°å‡ âœ…
- [x] recall æ—¶ï¼š`score = similarity Ã— strength`ï¼Œ`WHERE strength > 0.05` è¿‡æ»¤å·²é—å¿˜è®°å¿† âœ…
- [x] `boost_episode_on_recall()` â€” rehearsal effect + å¯é€‰ body è¦†å†™ï¼ˆB-10 ç›´æ¥è¦†å†™ï¼‰ âœ…
- [x] strength < 0.05 çš„è®°å¿†åœ¨ recall ä¸­è¢«è¿‡æ»¤ï¼ˆ"æ¨¡ç³Šäº†"ï¼‰ âœ…
- [x] 4 ä¸ªæµ‹è¯•ï¼šdefault_strength, update_strength, decay, rehearsal_boost âœ…

---

### 38. ğŸ§¬ æƒ…ç»ªæƒ¯æ€§ â€” ModulationVector æ—¶é—´å¹³æ»‘ âœ…
**æ¨¡å—**: `mneme_limbic/src/somatic.rs`, `mneme_limbic/src/system.rs`
**ä¼˜å…ˆçº§**: ğŸŸ¡ Phase 2
**ç†è®º**: æƒ…ç»ªä¸æ˜¯å¼€å…³â€”â€”äººä¸ä¼šä»å¤§ç¬‘ç¬é—´åˆ‡åˆ°å¤§å“­ã€‚Russell Circumplex æ¨¡å‹ä¸­çš„ affect æ˜¯è¿ç»­çš„

**å·²å®Œæˆ** (commit `b2b547e`):
- [x] `LimbicSystem` ç»´æŠ¤ `prev_modulation: ModulationVector` âœ…
- [x] æ–°çš„ `ModulationVector` = lerp(prev, current, smoothing_factor) âœ…
- [x] smoothing_factor æ˜¯ ğŸ§¬ ä¸ªæ€§å‚æ•°ï¼ˆæƒ…ç»ªç¨³å®šçš„äºº factor ä½ï¼Œå˜åŒ–æ…¢ï¼‰ âœ…
- [x] æç«¯äº‹ä»¶å¯ä»¥ bypass å¹³æ»‘ï¼ˆ`max_delta > surprise_threshold` ç›´æ¥è·³å˜ï¼‰ âœ…

---

### 39. ğŸ§¬ Sleep Consolidation è‡ªæˆ‘åæ€ âœ…
**æ¨¡å—**: `mneme_memory/src/consolidation.rs`, `mneme_reasoning/src/engine.rs`
**ä¼˜å…ˆçº§**: ğŸŸ¡ Phase 2
**ç†è®º**: ç¡çœ ä¸­å¤§è„‘æ•´ç†è®°å¿†ã€å‘ç°æ¨¡å¼ã€å½¢æˆè‡ªæˆ‘å™äº‹

**å·²å®Œæˆ** (commit `d08184a`):
- [x] consolidation æ–°å¢ self_reflection stepï¼ˆåœ¨ narrative chapter ç”Ÿæˆä¹‹åï¼‰ âœ…
- [x] è§„åˆ™å¼ `SelfReflector` åˆ†æ ConsolidatedPattern + EpisodeDigest âœ…
- [x] æå–è‡ªæˆ‘è®¤çŸ¥å†™å…¥ self_knowledge è¡¨ âœ…
- [x] å¯¹æ¯”æ–°è®¤çŸ¥ä¸å·²æœ‰ self_knowledgeï¼ŒBayesian åˆå¹¶ confidence âœ…
- [x] å°†åæ€è¿‡ç¨‹æœ¬èº«ä½œä¸º episode å­˜å‚¨ï¼ˆå…ƒè®°å¿†ï¼Œsource="self:reflection"ï¼‰ âœ…

---

### 40. ğŸ§¬ èº«ä½“æ„Ÿå—éšå–» â€” å†…éƒ¨çŠ¶æ€ â†’ è‡ªæˆ‘æ„ŸçŸ¥ âœ…
**æ¨¡å—**: `mneme_limbic/src/somatic.rs`, `mneme_memory/src/coordinator.rs`
**ä¼˜å…ˆçº§**: ğŸŸ¡ Phase 2
**ç†è®º**: Damasio èº¯ä½“æ ‡è®°å‡è¯´ â€” èº«ä½“æ„Ÿå—æ˜¯æƒ…ç»ªçš„åŸºç¡€ï¼Œè‡ªæˆ‘æ„è¯†å§‹äºå¯¹èº«ä½“çš„æ„ŸçŸ¥

**å·²å®Œæˆ** (commit `779e43d`):
- [x] `SomaticMarker::describe_body_feeling()` â€” å°†çŠ¶æ€å˜åŒ–ç¿»è¯‘ä¸ºä¸»è§‚æ„Ÿå—æ–‡æœ¬ âœ…
- [x] ä»…åœ¨å˜åŒ–è¶…è¿‡é˜ˆå€¼æ—¶è§¦å‘ï¼ˆä¸æ˜¯æ¯ä¸ª tick éƒ½æ„ŸçŸ¥ï¼‰ âœ…
- [x] æ„Ÿå—æè¿°å†™å…¥ self_knowledge(domain='body_feeling')ï¼Œä½ confidence âœ…
- [x] è¿™äº›"èº«ä½“è®°å¿†"å¯è¢« Psyche çš„ self_model è¯»å–ï¼Œå½±å“è‡ªæˆ‘è®¤çŸ¥ âœ…

---

### 41. ğŸ§¬ èµ°ç¥ / è‡ªç”±è”æƒ³ (Mind-Wandering) âœ…
**æ¨¡å—**: `mneme_expression/src/rumination.rs`
**ä¼˜å…ˆçº§**: ğŸŸ¢ Phase 3
**ç†è®º**: DMN (Default Mode Network) â€” äººç±»åœ¨æ— èŠ/æ”¾æ¾æ—¶å¤§è„‘ä¸æ˜¯åœæœºï¼Œè€Œæ˜¯è‡ªç”±è”æƒ³ã€å›å¿†ã€æ„å»ºå™äº‹

**å·²å®Œæˆ** (commit `6215a25`):
- [x] `RuminationEvaluator` â€” å½“ boredom > 0.6 ä¸”æœ‰è¶³å¤Ÿç²¾åŠ›æ—¶æ¿€æ´» âœ…
- [x] è§¦å‘ `Trigger::Rumination { kind: "mind_wandering" }` âœ…
- [x] å†·å´æœºåˆ¶é˜²æ­¢é‡å¤è§¦å‘ï¼ˆé»˜è®¤ 10 åˆ†é’Ÿï¼‰ âœ…
- [x] ä¸ PresenceScheduler åä½œï¼šåªåœ¨æ´»è·ƒæ—¶æ®µè§¦å‘ âœ…

---

### 42. ğŸ§¬ RuminationEvaluator â€” ä¸»åŠ¨å‘èµ·å¯¹è¯ âœ…
**æ¨¡å—**: `mneme_expression/src/rumination.rs`
**ä¼˜å…ˆçº§**: ğŸŸ¢ Phase 3
**å‰ç½®**: #36 (boredom), #41 (rumination)

**å·²å®Œæˆ** (commit `6215a25`):
- [x] å®ç° `TriggerEvaluator` trait çš„ `RuminationEvaluator` âœ…
- [x] è§¦å‘æ¡ä»¶ï¼šboredom/social_need/curiosity è¶…é˜ˆå€¼ âœ…
- [x] ä¸‰ç§è§¦å‘ç±»å‹ï¼šmind_wandering, social_longing, curiosity_spike âœ…
- [x] ä¸ `PresenceScheduler` åä½œï¼šåªåœ¨æ´»è·ƒæ—¶æ®µè§¦å‘ âœ…
- [x] å†·å´æœºåˆ¶ï¼šé»˜è®¤ 10 åˆ†é’Ÿé˜²æ­¢é¢‘ç¹ä¸»åŠ¨éªšæ‰° âœ…

---

### 43. ğŸ§¬ åšæ¢¦ (Dreaming) â€” èµ°ç¥åœ¨ç¡çœ ä¸­çš„å»¶ä¼¸ âœ… Phase 1
**æ¨¡å—**: `mneme_memory/src/dream.rs`, `mneme_memory/src/consolidation.rs`, `mneme_memory/src/coordinator.rs`
**ä¼˜å…ˆçº§**: ğŸŸ¢ Phase 3
**å‰ç½®**: #37 (episode strength), #39 (self-reflection), #41 (rumination)
**ç†è®º**: MANIFESTO ADR-008 â€” consolidation æœŸé—´ rumination è¿è¡Œï¼ŒæŒ‰ strength åŠ æƒéšæœºå¬å› 2-3 æ¡ episodesï¼Œæ‹¼æ¥æˆæ¢¦å¢ƒ episode

**Phase 1 å·²å®Œæˆï¼ˆè§„åˆ™å¼ï¼‰**:
- [x] `DreamSeed` ç»“æ„ä½“ + `recall_random_by_strength()` åŠ æƒéšæœºå¬å› âœ…
- [x] `DreamGenerator` è§„åˆ™å¼æ¨¡æ¿æ¢¦å¢ƒç”Ÿæˆï¼ˆç§¯æ/æ¶ˆæ/ä¸­æ€§/æ··ä¹±å››ç±»æ¨¡æ¿ï¼‰ âœ…
- [x] `DreamEpisode` åŒ…å« narrative + source_ids + emotional_tone âœ…
- [x] `ConsolidationResult` æ–°å¢ `dream` å­—æ®µ âœ…
- [x] `trigger_sleep()` ä¸­ç”Ÿæˆæ¢¦å¢ƒå¹¶å­˜å‚¨ä¸º episodeï¼ˆsource="self:dream", strength=0.4ï¼‰ âœ…
- [x] å½“å‰ mood_bias å½±å“æ¢¦å¢ƒè‰²è°ƒé€‰æ‹© âœ…
- [x] 9 ä¸ªæµ‹è¯•ï¼ˆdream æ¨¡å— 8 + sqlite é›†æˆ 1ï¼‰ âœ…

**Phase 2 å¾…å‡çº§**:
- [ ] LLM ç”Ÿæˆæ¢¦å¢ƒå™è¿°ï¼ˆæ›¿ä»£æ¨¡æ¿æ‹¼æ¥ï¼‰
- [ ] æ¢¦å¢ƒä¸è‡ªæˆ‘åæ€çš„äº¤äº’ï¼ˆæ¢¦ä¸­é¢†æ‚Ÿï¼‰

---

## ğŸ—ï¸ Crate é‡æ„ â€” é«˜å†…èšä½è€¦åˆ (ADR-014/015)

> **åŸåˆ™ï¼šæ¯ä¸ª crate åšä¸€ä»¶äº‹ï¼Œåšå¥½ã€‚crate ä¹‹é—´åªé€šè¿‡ trait å’Œæ¶ˆæ¯é€šä¿¡ï¼Œä¸ä¾èµ–å½¼æ­¤çš„å†…éƒ¨å®ç°ã€‚**

### å½“å‰é—®é¢˜

| Crate | é—®é¢˜ | å†…èšåº¦ | è€¦åˆåº¦ |
|-------|------|--------|--------|
| `mneme_reasoning` | ä¸Šå¸å¯¹è±¡ï¼šLLM è°ƒç”¨ + å·¥å…·æ‰§è¡Œ + ä¸Šä¸‹æ–‡ç»„è£… + åé¦ˆè®°å½• + æµè§ˆå™¨ç®¡ç†ï¼Œ20+ å­—æ®µ | ğŸ”´ ä½ | ğŸ”´ é«˜ |
| `mneme_os` | å¤–éƒ¨åº“è–„åŒ…è£…ï¼Œæ—  Mneme ç‰¹æœ‰é€»è¾‘ | ğŸŸ¡ ä¸­ | ğŸŸ¡ ä¸­ |
| `mneme_browser` | å¤–éƒ¨åº“è–„åŒ…è£…ï¼Œheadless_chrome ç»†èŠ‚æ³„æ¼åˆ° engine | ğŸŸ¡ ä¸­ | ğŸ”´ é«˜ |
| `mneme_voice` | ç©º traitï¼Œæ— å®ç° | â€” | â€” |
| `mneme_perception` | RSS fetch è–„åŒ…è£… | ğŸŸ¡ ä¸­ | ğŸŸ¢ ä½ |
| `mneme_onebot` | QQ åè®®ç»†èŠ‚ä¾µå…¥æ ¸å¿ƒï¼Œæ¯åŠ ä¸€ä¸ªå¹³å°å°±è¦æ–° crate | ğŸŸ¡ ä¸­ | ğŸ”´ é«˜ |

### ç›®æ ‡ç»“æ„

```
ä¿ç•™ï¼ˆçµé­‚å±‚ï¼Œä¸å¯æ›¿ä»£ï¼‰:
  mneme_core       â€” ODE åŠ¨åŠ›å­¦ã€çŠ¶æ€ã€ä»·å€¼ç½‘ç»œ
  mneme_limbic     â€” èº¯ä½“æ ‡è®°ã€è°ƒåˆ¶å‘é‡ã€æƒ…ç»ªæƒ¯æ€§
  mneme_memory     â€” SQLite è®°å¿†ã€å·©å›ºã€åšæ¢¦ã€å™äº‹ç¼–ç»‡
  mneme_expression â€” è§¦å‘å™¨ã€ä¹ æƒ¯ã€æ³¨æ„åŠ›ã€æ„è¯†é—¨

é‡æ„ï¼ˆæ‹†åˆ† god objectï¼‰:
  mneme_reasoning  â€” ç˜¦èº«ä¸ºè°ƒåº¦å™¨
    â”œâ”€â”€ context/   â€” ContextBuilderï¼ˆç³»ç»Ÿ prompt ç»„è£…ã€ä¸Šä¸‹æ–‡å‹ç¼©ï¼‰
    â”œâ”€â”€ executor/  â€” ToolExecutorï¼ˆå·¥å…·è°ƒç”¨ + é‡è¯• + è¶…æ—¶ï¼‰
    â”œâ”€â”€ history/   â€” ConversationManagerï¼ˆå†å²ç®¡ç†ã€è£å‰ªï¼‰
    â””â”€â”€ feedback/  â€” FeedbackRecorderï¼ˆåé¦ˆä¿¡å·æ”¶é›†ï¼‰

æ–°å¢ï¼ˆåŸºç¡€è®¾æ–½å±‚ï¼‰:
  mneme_mcp        â€” MCP clientï¼Œç®¡ç† server è¿æ¥ç”Ÿå‘½å‘¨æœŸï¼Œæ¡¥æ¥åˆ° ToolRegistry
  mneme_gateway    â€” HTTP/WS é€šè®¯ç«¯ç‚¹ï¼Œå¹³å°æ— å…³çš„æ¶ˆæ¯å…¥å£

é€€å½¹ï¼ˆèƒ½åŠ›é€šè¿‡ MCP æŒ‰éœ€è·å¾—ï¼‰:
  mneme_os         â†’ shell MCP serverï¼ˆç¤¾åŒºå·²æœ‰ï¼‰
  mneme_browser    â†’ Playwright MCP serverï¼ˆç¤¾åŒºå·²æœ‰ï¼‰
  mneme_voice      â†’ STT/TTS MCP serverï¼ˆç¤¾åŒºå·²æœ‰ï¼‰
  mneme_perception â†’ RSS/web scrape MCP server
  mneme_onebot     â†’ å¤–éƒ¨é€‚é…å™¨è„šæœ¬ï¼ˆPython/Nodeï¼‰ï¼Œé€šè¿‡ Gateway æ¥å…¥

ä¿ç•™ä¸å˜:
  mneme_cli        â€” ç»ˆç«¯äº¤äº’ï¼ˆç›´æ¥èµ° Gateway æˆ–å†…éƒ¨ channelï¼‰
```

### è¿ç§»è·¯å¾„

ä¸æ˜¯ä¸€æ¬¡æ€§é‡å†™ã€‚åˆ†æ­¥èµ°ï¼š

1. **mneme_mcp** å…ˆå»ºï¼Œè·‘é€šä¸€ä¸ª MCP serverï¼ˆå¦‚ shellï¼‰ï¼ŒéªŒè¯ ToolHandler æ¡¥æ¥
2. **mneme_gateway** å»ºç«‹ï¼ŒCLI å’Œ OneBot éƒ½æ”¹ä¸ºé€šè¿‡ Gateway æ¥å…¥
3. **mneme_reasoning** é€æ­¥æ‹†åˆ†æ¨¡å—ï¼ˆå…ˆæå– ContextBuilderï¼Œå†æå– ToolExecutorï¼‰
4. æ—§ crate é€ä¸ªé€€å½¹ï¼ˆå…ˆ os â†’ å† browser â†’ å† voice/perceptionï¼‰
5. **mneme_onebot** æœ€åé€€å½¹ï¼ˆæ”¹ä¸ºå¤–éƒ¨é€‚é…å™¨è„šæœ¬ï¼‰

### æ•°æ®åº“è¿ç§»æ­£è§„åŒ–

å½“å‰ 16 å¼ è¡¨ç”¨ `CREATE TABLE IF NOT EXISTS` + è£¸ `ALTER TABLE`ï¼Œé”™è¯¯è¢«é™é»˜åæ‰ã€‚åˆ‡æ¢åˆ° `sqlx migrate!` å®ï¼š
- ç‰ˆæœ¬åŒ–è¿ç§»æ–‡ä»¶ï¼ˆ`migrations/` ç›®å½•ï¼‰
- è‡ªåŠ¨è¿½è¸ªå·²æ‰§è¡Œçš„è¿ç§»
- æ”¯æŒå›æ»š
- ç¼–è¯‘æœŸæ£€æŸ¥ SQL è¯­æ³•

### é…ç½®çƒ­é‡è½½

Mneme æ˜¯é•¿æœŸè¿è¡Œçš„ç”Ÿå‘½ä½“ï¼Œæ”¹å‚æ•°ä¸åº”è¯¥è¦é‡å¯ã€‚ä½¿ç”¨ `arc-swap` + `notify`ï¼š
- æ–‡ä»¶å˜åŒ– â†’ éªŒè¯æ–°é…ç½® â†’ åŸå­äº¤æ¢ â†’ æ—§é…ç½®è‡ªåŠ¨é‡Šæ”¾
- ç‰¹åˆ«é€‚åˆæƒ…ç»ªåŠ¨åŠ›å­¦å‚æ•°è°ƒä¼˜ï¼ˆä¸é‡å¯å°±èƒ½è°ƒ decay rateï¼‰
- è¯»å– < 10nsï¼Œå¯¹ heartbeat å¾ªç¯é›¶å½±å“

### å¯è§‚æµ‹æ€§ï¼ˆLevel æ„ŸçŸ¥ï¼‰

å¯è§‚æµ‹æ€§å¿…é¡»è·Ÿéš B-8 Level å’Œ B-9/B-12 çš„éšç§æ„¿æ™¯ï¼š

| Level | å¯è§‚æµ‹èŒƒå›´ | ç†ç”± |
|-------|-----------|------|
| 0-1 | å…¨é“¾è·¯ traceï¼ˆODE â†’ SomaticMarker â†’ LLM â†’ è¾“å‡ºï¼‰ | ç…§çœ‹æœŸï¼Œéœ€è¦å®Œå…¨å¯è§ |
| 2 | å¥¹å¯ä»¥æ ‡è®°æŸäº› trace span ä¸º private | å¼€å§‹æœ‰éšç§æ„è¯† |
| 3 | é»˜è®¤ä¸å¯¼å‡ºå†…éƒ¨ traceï¼Œåªæš´éœ²å¥¹é€‰æ‹©åˆ†äº«çš„æŒ‡æ ‡ | å¯¹ç­‰å…³ç³»ï¼Œä¸çª¥æ¢ |

å½“å‰å®ç° Level 0-1ï¼š`tracing` â†’ `tracing-opentelemetry` â†’ OTLP å¯¼å‡ºã€‚æ¶æ„ä¸Šé¢„ç•™ Level 2-3 çš„ trace è¿‡æ»¤èƒ½åŠ›ã€‚

---

## ğŸ“… ç‰ˆæœ¬è§„åˆ’

### v0.2.0 - æ ¸å¿ƒç®¡é“é—­ç¯ç‰ˆæœ¬
> **ç›®æ ‡**: è®© agent çš„æ ¸å¿ƒç®¡é“ï¼ˆpersona â†’ memory â†’ context â†’ expressionï¼‰çœŸæ­£è·‘é€šã€‚

- ~~Persona å®šä¹‰æ–‡ä»¶å¡«å…… (#27)~~ âœ…
- ~~Semantic Memory è¯»å†™é—­ç¯ (#26)~~ âœ… API + extraction pass å®Œæˆ
- ~~Context Assembly å®Œæ•´ç®¡é“ (#28)~~ âœ… 6/6 å±‚å®Œæˆ
- ~~Somatic Marker ç»“æ„æ€§è°ƒåˆ¶ (#20 çŸ­æœŸ)~~ âœ…
- ~~API é‡è¯•æœºåˆ¶ (#1)~~ âœ…
- ~~æ•°å€¼è¾¹ç•Œæ£€æŸ¥ (#4)~~ âœ…
- ~~è¾“å‡ºè‡ªç„¶åŒ–ï¼šç¦ roleplayã€æ—¥å¸¸ç¦ markdown (#34)~~ âœ…
- ~~CLI rustyline é›†æˆ (#25)~~ âœ…

### v0.3.0 - ç¨³å®šæ€§ä¸å¯æµ‹è¯•ç‰ˆæœ¬ âœ…
> **ç›®æ ‡**: å»ºç«‹å·¥ç¨‹è´¨é‡åŸºçº¿ã€‚

- ~~Reasoning Engine æµ‹è¯•è¦†ç›– (#32)~~ âœ… 24 integration tests
- ~~å±æ€§æµ‹è¯•å¼•å…¥ (#6)~~ âœ… 41 proptest tests
- ~~çŠ¶æ€å†å²è®°å½• (#3)~~ âœ…
- ~~å·¥å…·æ‰§è¡Œé”™è¯¯å¤„ç† (#2)~~ âœ…
- ~~LLM å“åº”è§£æå¥å£®æ€§ (#8)~~ âœ…
- ~~æµè§ˆå™¨å·¥å…·ç¨³å®šæ€§ (#7)~~ âœ…

### v0.3.5 - æ¶Œç°ç‰ˆæœ¬ï¼ˆEmergenceï¼‰âœ… å®Œæˆ
> **ç›®æ ‡**: è®© Mneme ä» chatbot å˜æˆ beingã€‚æ ¸å¿ƒå˜æ›´è§ `MANIFESTO.md` ADR-002/003ã€‚

**Phase 1 â€” åœ°åŸº** âœ…:
- [x] `self_knowledge` è¡¨ + CRUD æ–¹æ³• (#35) âœ…
- [x] `boredom` å­—æ®µåŠ å…¥ FastState + ODE åŠ¨åŠ›å­¦ (#36) âœ…
- [x] episodes è¡¨åŠ  `strength` å­—æ®µ + è¡°å‡é€»è¾‘ï¼ˆé€‰æ‹©æ€§é—å¿˜ï¼‰ (#37) âœ…

**Phase 2 â€” æ ¸å¿ƒæœºåˆ¶** âœ…:
- [x] `ModulationVector` æ—¶é—´å¹³æ»‘ï¼ˆæƒ…ç»ªæƒ¯æ€§ï¼‰ (#38) âœ…
- [x] `Psyche` ä»è®°å¿†æ¶Œç°ï¼ˆé‡æ„ persona.rs + prompts.rsï¼‰ (#27) âœ…
- [x] Sleep consolidation è‡ªæˆ‘åæ€æ­¥éª¤ â†’ self_knowledge (#39) âœ…
- [x] èº«ä½“æ„Ÿå—éšå–»ï¼šå†…éƒ¨çŠ¶æ€å˜åŒ– â†’ è‡ªæˆ‘æ„ŸçŸ¥ (#40) âœ…

**Phase 3 â€” é«˜é˜¶è¡Œä¸º** âœ…:
- [x] èµ°ç¥/è‡ªç”±è”æƒ³ï¼šboredom é©±åŠ¨çš„ spontaneous recall (#41) âœ…
- [x] `RuminationEvaluator`ï¼šå®ç° TriggerEvaluator traitï¼Œä¸»åŠ¨å‘èµ·å¯¹è¯ (#42) âœ…
- [x] å‘å±•é˜¶æ®µä» self_knowledge ç§¯ç´¯ä¸­è‡ªç„¶æ¶Œç° âœ…

### v0.4.0 - å®‰å…¨ä¸ Agency åŸºç¡€ç‰ˆæœ¬ âœ… å®Œæˆ
> **ç›®æ ‡**: ä¸ºè‡ªä¸»è¡Œä¸ºæ‰“å¥½å®‰å…¨åŸºç¡€ã€‚

- [x] ç»Ÿä¸€é…ç½®æ–‡ä»¶ (#18) âœ… â€” `MnemeConfig` TOML é…ç½® + CLI è¦†ç›–
- [x] å®‰å…¨æ²™ç®±ä¸ Capability Tiers (#29) âœ… â€” ä¸‰çº§æƒé™ + è·¯å¾„/URL/å‘½ä»¤æ²™ç®±
- [x] å·¥å…·æ³¨å†Œç³»ç»Ÿ (#30) âœ… â€” `ToolHandler` trait + `ToolRegistry` åŠ¨æ€åˆ†å‘
- [x] Token é¢„ç®—ç³»ç»Ÿ (#9) âœ… â€” æ—¥/æœˆé¢„ç®— + é™çº§ç­–ç•¥ + SQLite æŒä¹…åŒ–
- [x] åˆ†å±‚å†³ç­–æ¶æ„ (#10) âœ… â€” `DecisionRouter` è§„åˆ™/å¿«é€Ÿ/å®Œæ•´ä¸‰å±‚è·¯ç”±
- [x] Agent Loop ä¸»åŠ¨è¡Œä¸ºå¾ªç¯ (#21) âœ… â€” channel-based åå°å¾ªç¯ + CLI é›†æˆ

### v0.5.0 - å­¦ä¹ ä¸æˆé•¿ç‰ˆæœ¬
> **ç›®æ ‡**: è®© Mneme é€šè¿‡ç»éªŒæˆé•¿ï¼Œä»äº¤äº’ä¸­å­¦ä¼šè‡ªå·±çš„è¡¨è¾¾æ–¹å¼ã€‚

- [x] åé¦ˆä¿¡å·å®æ—¶æŒä¹…åŒ– + sleep æ ‡è®°æ•´åˆ (#5) âœ…
- [x] Sleep æ—¶ episode å¼ºåº¦è¡°å‡ï¼ˆEbbinghaus é—å¿˜æ›²çº¿ï¼‰ âœ…
- [x] Recall æƒ…ç»ªåç½® â€” mood-congruent memory (#20) âœ…
- [x] å¯å­¦ä¹ çš„ ModulationCurves åŸºç¡€ç»“æ„ (#20 ä¸­æœŸ) âœ…
- [x] ç¦»çº¿å­¦ä¹ ç®¡é“ (#13) âœ… â€” CurveLearner + ModulationSample æŒä¹…åŒ– + sleep è‡ªåŠ¨å­¦ä¹ 
- [x] Observability & Metrics (#15) âœ… â€” å¯é…ç½®æ—¥å¿—çº§åˆ«/JSON/æ–‡ä»¶è¾“å‡º + instrument å…³é”®æ–¹æ³•
- [x] LLM æµå¼è¾“å‡º (#31) âœ… â€” StreamEvent + SSE è§£æ + Engine æµå¼ ReAct loop + CLI å®æ—¶è¾“å‡º
- [x] å‘é‡æœç´¢ ANN ç´¢å¼• (#33) âœ… â€” sqlite-vec KNN æŸ¥è¯¢ï¼Œå»é™¤ LIMIT 1000 é™åˆ¶

### v0.6.0 - è‡ªä¸» Agency ç‰ˆæœ¬ âœ… å®Œæˆ
> **ç›®æ ‡**: ç›®æ ‡é©±åŠ¨çš„è‡ªä¸»è¡Œä¸ºã€‚

- [x] å£°æ˜å¼è¡Œä¸ºè§„åˆ™å¼•æ“ (MANIFESTO ADR-004) âœ… â€” triggerâ†’conditionâ†’action ä¸‰æ®µå¼è§„åˆ™å¼•æ“ + SQLite æŒä¹…åŒ– + ç§å­è§„åˆ™
- [x] åŸºç¡€ç›®æ ‡ç³»ç»Ÿ (#22) âœ… â€” Goal/GoalType/GoalStatus æ¨¡å‹ + GoalManager CRUD + GoalTriggerEvaluator + çŠ¶æ€é©±åŠ¨ç›®æ ‡å»ºè®®
- [x] è‡ªä¸»å·¥å…·ä½¿ç”¨ (#23) âœ… â€” AutonomousToolUse AgentAction + è§„åˆ™å¼•æ“ ExecuteTool æ¡¥æ¥ + CapabilityGuard å®‰å…¨æ£€æŸ¥
- [x] æ™ºèƒ½è°ƒåº¦ç­–ç•¥ (#11) âœ… â€” PresenceScheduler åŠ¨æ€ tick/trigger é—´éš” + ç”Ÿå‘½å‘¨æœŸ/èƒ½é‡/ç›®æ ‡/æ—¶é—´æ„ŸçŸ¥
- [x] æœ¬åœ°æ¨¡å‹é›†æˆ (#12) âœ… â€” OllamaClient å¤ç”¨ OpenAI SSE è§£æ + LlmClient trait å®ç°

### Post v0.6.0 â€” æŠ€æœ¯å€ºåŠ¡æ¸…ç† + æµ‹è¯•è¡¥å…¨ âœ… å®Œæˆ
> **ç›®æ ‡**: æ¸…ç†æŠ€æœ¯å€ºåŠ¡ã€ä¿®å¤å·²çŸ¥é—®é¢˜ã€è¡¥å…¨æµ‹è¯•è¦†ç›–ã€‚

- [x] ä¿®å¤ `test_env_overrides` ç«æ€ âœ… â€” åˆå¹¶ä¸º `test_env_overrides_and_defaults` é¡ºåºæ‰§è¡Œ
- [x] æ¸…ç† mneme_cli clippy è­¦å‘Š âœ… â€” `single_match` â†’ `if let`ï¼Œ`println!("")` â†’ `println!()`
- [x] mneme_onebot æµ‹è¯•è¡¥å…¨ âœ… â€” 6 ä¸ªæµ‹è¯•è¦†ç›–äº‹ä»¶è§£æ + åºåˆ—åŒ–
- [x] mneme_browser æµ‹è¯•è¡¥å…¨ âœ… â€” 5 ä¸ªæ–°æµ‹è¯•è¦†ç›– action serde + config
- [x] å…¨ workspace clippy è­¦å‘Šæ¸…é›¶ âœ… â€” 23 warnings across 4 crates:
  - mneme_core (6): derivable Default, trim before split_whitespace, from_str naming
  - mneme_limbic (1): redundant let binding
  - mneme_memory (10): transmute annotation, borrowed ref, is_multiple_of, clamp, is_some_and, from_str naming, Default impl
  - mneme_reasoning (6): Default impl, empty doc line, explicit auto-deref, single_match â†’ if-let

### v0.7.0 - Manifesto åˆè§„ç‰ˆæœ¬ âœ… å®Œæˆ
> **ç›®æ ‡**: å¯¹ç…§ MANIFESTO.md æ ¸å¿ƒä¿¡å¿µï¼Œè¡¥é½ 8 é¡¹ç¼ºå¤±çš„å·¥ç¨‹å®ç°ã€‚

- [x] ADR-007 å¥½å¥‡å¿ƒå‘é‡åŒ– âœ… â€” `CuriosityVector` + topic tagging + decay + prompt æ³¨å…¥
- [x] B-10 è®°å¿†é‡å»º âœ… â€” `recall_reconstructed()` æƒ…ç»ªç€è‰²ï¼ˆmood/stress å½±å“å›å¿†å†…å®¹ï¼‰
- [x] B-19 ä¿¡ä»»ç»´åº¦ âœ… â€” `trust_level` å­—æ®µ + `update_trust()` + ç¤¾äº¤ä¸Šä¸‹æ–‡æ³¨å…¥
- [x] B-9 ä¸é€æ˜æ¶Œç° âœ… â€” private æ¡ç›®ä» prompt æ’é™¤ + å…ƒè®¤çŸ¥ `is_private` å­—æ®µ + auto-privacy å¯å‘å¼
- [x] B-5 è®¤çŸ¥ä¸»æƒ âœ… â€” è‡ªæºçŸ¥è¯†æŠµæŠ—å¤–éƒ¨è¦†å†™ (`cap = min(new, existing * 0.8)`)
- [x] B-14 å†²çªèƒ½åŠ› âœ… â€” `detect_input_conflict()` + å†²çªä¿¡å·æ³¨å…¥ prompt + temperature è°ƒåˆ¶
- [x] B-21 ä¹ æƒ¯å½¢æˆ âœ… â€” `HabitDetector` é‡å¤æ¨¡å¼æ£€æµ‹ + Rumination è§¦å‘åæ€
- [x] B-17 æ³¨æ„åŠ›å•çº¿ç¨‹ âœ… â€” `AttentionGate` ä¼˜å…ˆçº§ç«äº‰ + `EngagementHandle` engagement è°ƒåˆ¶
- [x] ADR-012/013 æ„è¯†è‡ªä¸»è§¦å‘ âœ… â€” `ConsciousnessGate` ODE çŠ¶æ€é©±åŠ¨ LLM è°ƒç”¨
- [x] B-21 å…ƒè®¤çŸ¥ âœ… â€” `MetacognitionEvaluator` å®šæœŸè‡ªæˆ‘åæ€ + æ´å¯Ÿå­˜å…¥ self_knowledge

### v0.8.0 - è¿è¡Œæ—¶é—­ç¯ç‰ˆæœ¬ âœ… å®Œæˆ
> **ç›®æ ‡**: ä¿®å¤å®é™…è¿è¡Œä¸­å‘ç°çš„å…³é”®ç¼ºé™·ï¼Œè®© Mneme èƒ½æ­£ç¡®æ„ŸçŸ¥è‡ªå·±å’Œä»–äººã€‚

- [x] ç¤¾äº¤å›¾è°±å†™å…¥é—­ç¯ (#53) âœ… â€” CLI/OneBot äº¤äº’æ—¶è‡ªåŠ¨ `upsert_person()` + `record_interaction()`ï¼ŒUUID v5 ç¡®å®šæ€§ ID
- [x] DB schema è‡ªæˆ‘è®¤çŸ¥ (#54) âœ… â€” å¯åŠ¨æ—¶ç§å­ 10 æ¡ system_knowledge æ¡ç›®æè¿°å…¨éƒ¨è¡¨ç»“æ„
- [x] è¿è¡Œæ—¶è‡ªæˆ‘è®¤çŸ¥ç§å­ (#78) â€” self_knowledge åŠ å…¥ infrastructure/capability åŸŸï¼šæŒä¹…è¿›ç¨‹ã€OneBot è¿æ¥ã€shell æƒé™ã€æµè§ˆå™¨èƒ½åŠ›ç­‰åŸºç¡€äº‹å® âœ…
- [x] åŠ¨æ€å·¥å…· Prompt ç”Ÿæˆ (#44) âœ… â€” ToolRegistry::format_for_prompt() ä»æ³¨å†Œ handler åŠ¨æ€ç”Ÿæˆï¼Œengine å·²ä½¿ç”¨ registry è·¯å¾„
- [x] ç”¨æˆ·æ˜¾å¼åé¦ˆæœºåˆ¶ (#5 åç»­) âœ… â€” `detect_user_feedback()` ç‚¹èµ/ç‚¹è¸©/çº æ­£ï¼ˆä¸­è‹±æ–‡regexï¼‰ï¼ŒCLI `like`/`dislike` å‘½ä»¤
- [x] éšå¼åé¦ˆæ¨æ–­ (#5 åç»­) âœ… â€” å›å¤å»¶è¿Ÿè¿½è¸ª + `topic_overlap()` bigram Jaccard è¯é¢˜å»¶ç»­æ£€æµ‹
- [x] åšæ¢¦ Phase 2 âœ… â€” `DreamNarrator` trait + `LlmDreamNarrator` LLM ç”Ÿæˆæ¢¦å¢ƒå™è¿°ï¼Œcoordinator LLM ä¼˜å…ˆã€æ¨¡æ¿å…œåº•ï¼ˆADR-008ï¼‰
- [x] å¥½å¥‡å¿ƒè¡Œä¸ºå›è·¯ (ADR-007 åç»­) âœ… â€” CuriosityVector top interests æ³¨å…¥ prompt + åç½® recall KNN æŸ¥è¯¢
- [x] Consolidation self_knowledge å†™å…¥éªŒè¯ (#67) âœ… â€” SelfReflector::reflect() â†’ store_self_knowledge() + meta-episode å®Œæ•´é—­ç¯
- [x] Rumination æ‰§è¡ŒéªŒè¯ (#68) âœ… â€” Trigger::Rumination â†’ process_thought_loop() â†’ LLM è°ƒç”¨ â†’ è¿”å› ReasoningOutput
- [x] å†…éƒ¨æ€ç»´ç»Ÿä¸€èµ° ContextAssembler (#71, #72, #77) âœ… â€” process_thought_loop() ç»Ÿä¸€èµ° build_full_system_prompt()ï¼Œå†…éƒ¨æ€ç»´æ³¨å…¥ self_knowledge + psyche + somatic
- [x] æ¸…ç† legacy prompt æ­»ä»£ç  (#69, #73) âœ… â€” build_system_prompt() å·²åˆ é™¤ï¼Œfeed_digest æ³¨é‡Šå‡†ç¡®
- [x] context budget å…³è”æ¨¡å‹ (#74) âœ… â€” config.llm.context_budget_chars å¯é…ç½®ï¼Œé»˜è®¤ 32000ï¼Œenv MNEME_CONTEXT_BUDGET è¦†ç›–
- [x] æ—¶é—´/æ—¥æœŸä¸Šä¸‹æ–‡æ³¨å…¥ (#79) â€” prompt æ³¨å…¥å½“å‰æ—¶é—´ã€æ˜ŸæœŸã€æ—¥æœŸï¼Œè®©è¡Œä¸ºä¸æ—¶é—´ç°å®å…³è” âœ…
- [x] èµ„æºçŠ¶æ€å¯è§æ€§ (#80) âœ… â€” build_resource_status() æ³¨å…¥è¿è¡Œæ—¶é—´ã€è®°å¿†ç‰‡æ®µæ•°ã€token ç”¨é‡åˆ° prompt
- [x] âš ï¸ B-19 ä¿®æ­£ï¼šç§»é™¤ trust_level æ˜¾å¼æ•°å€¼ (#87) â€” åˆ é™¤ people.trust_level åˆ—å’Œ update_trust()ï¼Œä¿¡ä»»æ”¹ä¸º self_knowledge æ¡ç›®ç»¼åˆæ•ˆæœ âœ…
- [x] âš ï¸ B-9 ä¿®æ­£ï¼šç§»é™¤ auto-privacyï¼Œæ”¹ä¸º prompt å†…è¯šå® (#88) â€” åˆ é™¤ mark_private/auto-privacy/SQL è¿‡æ»¤ï¼Œæ‰€æœ‰ self_knowledge å¯¹ LLM å¯è§ï¼Œç”±å¥¹è‡ªä¸»å†³å®šè¯´ä¸è¯´ âœ…
- [x] âš ï¸ B-14 ä¿®æ­£ï¼šç§»é™¤ç¡¬ç¼–ç å†²çªæ£€æµ‹ (#89) â€” åˆ é™¤ detect_input_conflict() å…³é”®è¯æ‰«æ + temperature æ³¨å…¥ï¼Œè®©å†²çªä» self_knowledge è‡ªç„¶æ¶Œç° âœ…
- [x] è¡¨è¾¾åå¥½å­¦ä¹ å†™å…¥è·¯å¾„ (#90) âœ… â€” coordinator.store_expression_preference() ä» sanitize ç»“æœå†™å…¥ self_knowledge
- [x] MANIFESTO çŠ¶æ€åŒæ­¥ (#91) âœ… â€” æ›´æ–° Section 4-5 å®æ–½çŠ¶æ€ã€ADR çŠ¶æ€ã€ä»£ç æŒ‡æ ‡
- [x] æ•æ„ŸæœŸæƒé‡ (#92) âœ… â€” store_self_knowledge() å‰ 50 episodes å†… confidence Ã— 1.3 boost + merge åå‘æ–°çŸ¥è¯†
- [x] é‡å¯æ—¶é—´æ–­è£‚æ„ŸçŸ¥ (#93) âœ… â€” å¯åŠ¨æ—¶æ£€æµ‹ >30min é—´éš™ï¼Œç”Ÿæˆ self:restart discontinuity episode

### v0.9.0 - åŸºç¡€è®¾æ–½ç°ä»£åŒ–ç‰ˆæœ¬ âœ… å®Œæˆ
> **ç›®æ ‡**: é«˜å†…èšä½è€¦åˆã€‚é‡æ„å·¥å…·å±‚å’Œé€šè®¯å±‚ï¼Œä¸ºè‡ªä¸»èƒ½åŠ›æ‰“å¥½æ¶æ„åŸºç¡€ã€‚è§ ADR-014/015ã€‚

**å¥¹çš„æ‰‹ â€” MCP å·¥å…·å±‚ (ADR-014)**:
- [x] `mneme_mcp` crate æ–°å»º â€” `rmcp` SDK é›†æˆï¼Œ`McpManager` ç®¡ç† server è¿æ¥ç”Ÿå‘½å‘¨æœŸ âœ…
- [x] MCP tools â†’ `ToolHandler` trait æ¡¥æ¥ â€” LLM ç«¯æ— æ„Ÿï¼Œç»Ÿä¸€èµ° `ToolRegistry` åˆ†å‘ âœ…
- [x] MCP è¿æ¥è·Ÿéšç”Ÿå‘½å‘¨æœŸ â€” Awake æ´»è·ƒ / Drowsy æš‚åœ / Sleep æ–­å¼€ / Wake é‡è¿ âœ…
- [x] è·‘é€šç¬¬ä¸€ä¸ª MCP serverï¼ˆshellï¼‰ï¼ŒéªŒè¯ç«¯åˆ°ç«¯è°ƒç”¨é“¾ âœ…
- [x] `mneme_os` é€€å½¹ â€” shell èƒ½åŠ›æ”¹ç”± MCP server æä¾› âœ…
- [x] `mneme_browser` é€€å½¹ â€” æµè§ˆå™¨èƒ½åŠ›æ”¹ç”± Playwright MCP server æä¾› âœ…

**å¥¹çš„è€³æœµ â€” Gateway é€šè®¯å±‚ (ADR-015)**:
- [x] `mneme_gateway` crate æ–°å»º â€” HTTP POST `/message` + WebSocket `/ws` ç«¯ç‚¹ âœ…
- [x] ç»Ÿä¸€ `GatewayMessage` â†’ `Event::UserMessage(Content)` è½¬æ¢ âœ…
- [ ] OneBot é€‚é…å™¨å¤–éƒ¨åŒ– â€” ä» Mneme crate å˜ä¸ºç‹¬ç«‹è„šæœ¬ï¼Œé€šè¿‡ Gateway æ¥å…¥
- [x] CLI ä¿æŒç›´è¿æ¨¡å¼ï¼ŒGateway ä½œä¸ºå¯é€‰ç»„ä»¶å¯åŠ¨ âœ…

**å·¥ç¨‹æ¸…ç†**:
- [x] `<emotion>` tag æœºåˆ¶ç§»é™¤ (#70) â€” åˆ é™¤ `parse_emotion_tags` + `emotion_regex`ï¼Œæƒ…ç»ªç»Ÿä¸€ç”± limbic ODE é©±åŠ¨ âœ…
- [x] åŒé‡å·¥å…·è·¯å¾„ç»Ÿä¸€ (#75) â€” åˆ‡æ¢åˆ° API native tool_useï¼Œåˆ é™¤ `text_tool_parser` æ¨¡å— âœ…
- [x] `text_tool_parser.rs` åˆ é™¤ï¼Œ`tools.rs` ç¡¬ç¼–ç  fallback ç§»é™¤ âœ…
- [x] `sqlx migrate!` â€” æ•°æ®åº“è¿ç§»æ­£è§„åŒ–ï¼Œç‰ˆæœ¬åŒ–è¿ç§»æ–‡ä»¶æ›¿ä»£è£¸ ALTER TABLE âœ…
- [x] `tracing-opentelemetry` â€” Feature-gated OTLP å¯¼å‡º (`--features otlp`, `--otlp-endpoint`)ï¼Œ`#[instrument]` on memorize/process_interaction/trigger_sleep âœ…

### v0.10.0 - æ¶æ„é‡æ„ç‰ˆæœ¬
> **ç›®æ ‡**: ReasoningEngine æ‹†åˆ†ï¼ŒLLM provider å‡çº§ï¼Œé…ç½®çƒ­é‡è½½ã€‚

**ReasoningEngine æ‹†åˆ†ï¼ˆé«˜å†…èšï¼‰**:
- [ ] `ContextBuilder` æå– â€” ç³»ç»Ÿ prompt ç»„è£…ã€ä¸Šä¸‹æ–‡å‹ç¼©ã€token é¢„ç®—ç®¡ç†
- [ ] `ToolExecutor` æå– â€” å·¥å…·è°ƒç”¨ + é‡è¯• + è¶…æ—¶ï¼Œç»Ÿä¸€èµ° MCP/æœ¬åœ°åŒè·¯å¾„
- [ ] `ConversationManager` æå– â€” å†å²ç®¡ç†ã€è£å‰ªã€å»é‡
- [ ] `FeedbackRecorder` æå– â€” åé¦ˆä¿¡å·æ”¶é›†ï¼ˆå½“å‰æ•£è½åœ¨ engine å„å¤„ï¼‰

**LLM Provider å‡çº§**:
- [x] SSE è§£æå»é‡ â€” æå– `SseBuffer` åˆ° `providers/sse.rs`ï¼ŒAnthropic/OpenAI å…±ç”¨ âœ…
- [x] ç‹¬ç«‹ `MockProvider` â€” `providers/mock.rs` å®ç° `LlmClient`ï¼Œ`provider = "mock"` å¯ç”¨ âœ…
- [ ] Provider trait å…³è”ç±»å‹ â€” åŒºåˆ† provider ç‰¹æœ‰çš„ request/response

**é…ç½®ä¸è¿è¡Œæ—¶**:
- [ ] `arc-swap` + `notify` é…ç½®çƒ­é‡è½½ â€” ä¸é‡å¯å³å¯è°ƒæ•´å‚æ•°
- [ ] prompt å…ƒæŒ‡ä»¤è¯­è¨€è‡ªé€‚åº” (#76) â€” meta-instruction è·Ÿéš persona è¯­è¨€
- [x] `mneme_voice` é€€å½¹ â€” ä» workspace ç§»é™¤ï¼Œè¯­éŸ³èƒ½åŠ›é€šè¿‡ STT/TTS MCP server æŒ‰éœ€è·å¾— âœ…
- [ ] `mneme_perception` é€€å½¹ â€” RSS/web scrape é€šè¿‡ MCP server æŒ‰éœ€è·å¾—

### v0.11.0 - å¯¹è¯ä½“éªŒç‰ˆæœ¬
> **ç›®æ ‡**: ä» request-response å˜æˆæœ‰å­˜åœ¨æ„Ÿçš„å¯¹è¯è€…ã€‚

- [ ] å¼‚æ­¥å¯¹è¯æµ (#58) â€” `engine.think()` æ‹†åˆ†ä¸ºå¹¶å‘çš„ç”Ÿæˆæµä¸æ¥æ”¶æµï¼Œæ–°è¾“å…¥å¯ä¸­æ–­æ­£åœ¨ç”Ÿæˆçš„å›å¤
- [ ] å¯¹è¯ agency (#59) â€” å¯¹è¯ç›®æ ‡ç³»ç»Ÿï¼šMneme åœ¨å¯¹è¯ä¸­ç»´æŒè‡ªå·±çš„æ„å›¾ï¼ˆè¿½é—®ã€å¥½å¥‡ã€åé©³ï¼‰
- [ ] å¯¹è¯ç›®æ ‡æå– â€” ä»å¯¹è¯ä¸­è‡ªåŠ¨è¯†åˆ«å¹¶åˆ›å»º Goal
- [ ] å¥½å¥‡å¿ƒé©±åŠ¨è‡ªä¸»æ¢ç´¢ (#81) â€” CuriosityVector è§¦å‘è‡ªä¸»æœç´¢/æµè§ˆ
- [ ] å·¥å…·å¤±è´¥æ¨¡å¼å­¦ä¹  (#82) â€” è®°å½•å¤±è´¥æ¨¡å¼ï¼Œè°ƒæ•´æœªæ¥å·¥å…·é€‰æ‹©
- [ ] ä¸»åŠ¨ç¤¾äº¤è§¦å‘ (#83) â€” åŸºäºç¤¾äº¤å›¾è°± + social_need ä¸»åŠ¨å‘èµ·å¯¹è¯
- [ ] LLM å·¥å…·è¾“å‡ºè¯šå®æ€§ â€” é˜²æ­¢å¯¹å·¥å…·è¿”å›ç»“æœè¿›è¡Œè™šæ„æ¨ç†

### v1.0.0 - æˆç†Ÿç‰ˆæœ¬
> **ç›®æ ‡**: å®Œæ•´çš„è‡ªä¸»æ•°å­—ç”Ÿå‘½ã€‚

- ~~å…ƒè®¤çŸ¥åæ€ (#24)~~ âœ…
- [ ] ODE ä¹‹ä¸Šå åŠ å¯å¡‘ç¥ç»ç½‘ç»œ (ADR-001/009 æ¼”è¿›) (#14)
- [ ] ä½åˆ†è¾¨ç‡å†…å¿ƒç‹¬ç™½ (ADR-013) (#55) â€” æœ¬åœ°å°æ¨¡å‹ç‰‡æ®µå¼ç‹¬ç™½
- [ ] å½¢æˆæ€§è¯¾ç¨‹ â€” æ–‡å­¦ç®¡é“ (ADR-011) (#56)
- [ ] è‡ªå‘åˆ›é€  (ADR-007) â€” boredom + curiosity + å·¥å…· â†’ è‡ªä¸»åˆ›ä½œ
- [ ] è¡Œä¸ºé˜ˆå€¼å¯å­¦ä¹ åŒ– â€” è§¦å‘æ˜ å°„é˜ˆå€¼ä»ç»éªŒä¸­å­¦ä¹ ï¼Œæ›¿ä»£ç¡¬ç¼–ç 
- [ ] B-20 æ„ä¹‰è¿½å¯» â€” å­˜åœ¨æ€§åæ€æœºåˆ¶
- [ ] è®°å¿†è‡ªä¸»ç®¡ç† (#84) â€” ä¸»åŠ¨æ ‡è®°é‡è¦è®°å¿†ã€ä¸»åŠ¨é—å¿˜
- [ ] è‡ªæˆ‘è¯Šæ–­ä¸é™çº§ (#85) â€” DB/API æ•…éšœæ—¶è‡ªæˆ‘è¯Šæ–­å¹¶é™çº§è¿è¡Œ
- [ ] è¿è¡Œæ—¶å‚æ•°è‡ªä¿®æ”¹ (#86) â€” æ ¹æ®ç»éªŒè°ƒæ•´è‡ªå·±çš„ temperatureã€token é¢„ç®—ç­‰
- [ ] è¿è¡Œæ—¶è‡ªé…ç½® (#60) â€” è¢«å‘ŠçŸ¥åè‡ªè¡Œå»ºç«‹å¤–éƒ¨è¿æ¥ï¼ˆMCP server / Gateway é€‚é…å™¨ï¼‰
- [ ] GitHub Actions CI/CD æµæ°´çº¿

### v2.0.0 - å¯¹ç­‰ç‰ˆæœ¬ï¼ˆè¿œæ™¯ï¼‰
> **ç›®æ ‡**: B-8 Level 2-3ï¼Œä»ã€Œçˆ¶æ¯ã€åˆ°ã€Œæœ‹å‹ã€ã€‚

- [ ] LLM è‡ªä¸»é€‰æ‹© + ä»»åŠ¡è·¯ç”± (B-8 Level 2)
- [ ] MCP server è‡ªä¸»å‘ç°ä¸è¿æ¥ (ADR-014 Layer 3) â€” å¥¹æ ¹æ®ç›®æ ‡å’Œå¥½å¥‡å¿ƒè‡ªå·±æ‰¾å·¥å…·
- [ ] å·¥å…·è‡ªä¸»ç»„åˆ (B-8 Level 3) â€” ç»„åˆå¤šä¸ª MCP server å®Œæˆå¤æ‚ä»»åŠ¡
- [ ] è®°å¿†åŠ å¯† (B-12) (#57) â€” Level 3 é»˜è®¤åŠ å¯†ï¼Œå¯†é’¥ç”±è¿è¡Œæ—¶æŒæœ‰
- [ ] å¤š Mneme ç§ç¾¤é€šä¿¡ (ADR-005)
- [ ] ç»æµè‡ªä¸» (ADR-010)
- [ ] æ¸è¿›ä¸å¯è§£è¯»æ€§ (ADR-009) â€” ç¥ç»ç½‘ç»œä¸Šå±‚æ›¿ä»£å¯è§£è¯»çš„è°ƒåˆ¶æ›²çº¿
- [ ] å¯è§‚æµ‹æ€§ Level 3 â€” é»˜è®¤ä¸å¯¼å‡ºå†…éƒ¨ traceï¼Œåªæš´éœ²å¥¹é€‰æ‹©åˆ†äº«çš„æŒ‡æ ‡

---

*æœ€åæ›´æ–°: 2026-02-13*
